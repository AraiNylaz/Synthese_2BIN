





<!DOCTYPE html>
<html lang="zh-cn">

<!-- Mirrored from developer.android.com/guide/topics/providers/document-provider.html?hl=zh-cn by HTTrack Website Copier/3.x [XR&CO'2014], Thu, 15 Jun 2017 09:14:38 GMT -->
<!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=utf-8" /><!-- /Added by HTTrack -->
<head>

  



<meta name="viewport" content="width=device-width,initial-scale=1.0,minimum-scale=1.0,maximum-scale=1.0,user-scalable=no">
<meta content="IE=edge" http-equiv="X-UA-Compatible">





<script>var a=window.devsite||{};window.devsite=a;a.readyCallbacks=[];window.devsite.readyCallbacks=a.readyCallbacks;a.ready=function(b){a.readyCallbacks.push(b)};window.devsite.ready=a.ready;
</script>

<meta charset="utf-8">



<meta name="xsrf_token" content="zDzef7sygpxjgWumRdWHdBql9QWf3MwdOjbnorvHXfc6MTQ5NzUxNjk5NDU2NDQxMA" />

  
    <link rel="canonical" href="document-provider0b8e.html?hl=zh-cn">
  

  
    <link rel="alternate" href="document-provider7554.html?hl=es-419" hreflang="es-419">
  
    <link rel="alternate" href="document-provider.html" hreflang="en">
  
    <link rel="alternate" href="document-provider9e29.html?hl=ja" hreflang="ja">
  
    <link rel="alternate" href="document-provider9201.html?hl=ru" hreflang="ru">
  
    <link rel="alternate" href="document-provider327f.html?hl=vi" hreflang="vi">
  
    <link rel="alternate" href="document-provider0b8e.html?hl=zh-cn" hreflang="zh-Hans">
  
    <link rel="alternate" href="document-providerde3a.html?hl=es" hreflang="es">
  
    <link rel="alternate" href="document-providerf854.html?hl=zh-tw" hreflang="zh-Hant">
  
    <link rel="alternate" href="document-provider6dd3.html?hl=pt-br" hreflang="pt-br">
  
    <link rel="alternate" href="document-provider0cf2.html?hl=id" hreflang="id">
  
    <link rel="alternate" href="document-provider232e.html?hl=ko" hreflang="ko">
  
    <link rel="alternate" href="https://developer.android.google.cn/guide/topics/providers/document-provider.html?hl=es-419" hreflang="es-419-cn">
  
    <link rel="alternate" href="https://developer.android.google.cn/guide/topics/providers/document-provider.html" hreflang="en-cn">
  
    <link rel="alternate" href="https://developer.android.google.cn/guide/topics/providers/document-provider.html?hl=ja" hreflang="ja-cn">
  
    <link rel="alternate" href="https://developer.android.google.cn/guide/topics/providers/document-provider.html?hl=ru" hreflang="ru-cn">
  
    <link rel="alternate" href="https://developer.android.google.cn/guide/topics/providers/document-provider.html?hl=vi" hreflang="vi-cn">
  
    <link rel="alternate" href="https://developer.android.google.cn/guide/topics/providers/document-provider.html?hl=zh-cn" hreflang="zh-Hans-cn">
  
    <link rel="alternate" href="https://developer.android.google.cn/guide/topics/providers/document-provider.html?hl=es" hreflang="es-cn">
  
    <link rel="alternate" href="https://developer.android.google.cn/guide/topics/providers/document-provider.html?hl=zh-tw" hreflang="zh-Hant-cn">
  
    <link rel="alternate" href="https://developer.android.google.cn/guide/topics/providers/document-provider.html?hl=pt-br" hreflang="pt-br-cn">
  
    <link rel="alternate" href="https://developer.android.google.cn/guide/topics/providers/document-provider.html?hl=id" hreflang="id-cn">
  
    <link rel="alternate" href="https://developer.android.google.cn/guide/topics/providers/document-provider.html?hl=ko" hreflang="ko-cn">
  

  <link rel="alternate" href="document-provider.html" hreflang="x-default">




<link rel="shortcut icon" href="../../../_static/f304fc21fa/images/android/favicon0b8e.png?hl=zh-cn">

<link rel="apple-touch-icon" href="../../../_static/f304fc21fa/images/android/touchicon-1800b8e.png?hl=zh-cn">


<title>

  存储访问框架 | Android Developers

</title>

  <meta name="description" content="Android 4.4 (API level 19) introduces the Storage Access Framework (SAF). The SAF makes it simple for users to browse and open documents, images, and other files across all of their their preferred document storage providers. A standard, easy-to-use UI…">


<!-- STYLESHEETS -->
<link rel="stylesheet" href="http://fonts.googleapis.com/css?family=Roboto+Condensed">
<link rel="stylesheet"
    href="http://fonts.googleapis.com/css?family=Roboto:light,regular,medium,thin,italic,mediumitalic,bold"
    title="roboto">







<link href="../../../static/css/default414d.css?hl=zh-cn?v=2017061508" rel="stylesheet" type="text/css">
<!-- JAVASCRIPT -->
<script src="../../../_static/f304fc21fa/js/android_3p-bundle0b8e.js?hl=zh-cn" type="text/javascript"></script>
<script src="../../../_static/f304fc21fa/js/script_foot_closure_android__zh_cn0b8e.js?hl=zh-cn"></script>
<script src="../../../_static/f304fc21fa/js/script_foot_android0b8e.js?hl=zh-cn"></script>

<script type="text/javascript">
  var toRoot = 'https://developer.android.com/';
  devsite.permissions.init({"039e5d84b87fd75807ffb37b7f1bbf2c": true, "098dafe57affddc137df300142652cfd": false, "cb025a64a50094835616312f4774a53d": true, "51470233c56fc1fde50f00b73c52b216": false, "752953480de00a336d911a46966cc16d": false, "700def1a83e356c06c0925afb05de4b0": false, "6749dcb526ce9bde6993550c7d928d24": true});

  var replaceBlog = false;
  var replaceYouTube = false;
  var siteDefaultLocale = 'en';

  var ANDROID_LANGUAGES = [
      'id','de','en','es','es-419','fr','pt-br','vi','tr','ru','th','ja','zh-cn','zh-tw','ko'
  ];
</script>
<script src="../../../static/js/docs414d.js?hl=zh-cn?v=2017061508" type="text/javascript"></script>


</head>

<body class="gc-documentation
            
            
              develop
              guide
            
            "
      itemscope itemtype="http://schema.org/Article">
  


  
    <input class="google-analytics-id-json" type="hidden" value="{&quot;dimensions&quot;: {&quot;dimension6&quot;: &quot;zh-cn&quot;, &quot;dimension4&quot;: &quot;API Guides&quot;, &quot;dimension5&quot;: &quot;zh-cn&quot;, &quot;dimension3&quot;: false, &quot;dimension1&quot;: &quot;Signed out&quot;, &quot;dimension8&quot;: null}, &quot;gaid&quot;: &quot;UA-49880327-2&quot;}">
  
    <input class="google-analytics-id-json" type="hidden" value="{&quot;dimensions&quot;: {&quot;dimension6&quot;: &quot;zh-cn&quot;, &quot;dimension4&quot;: &quot;API Guides&quot;, &quot;dimension5&quot;: &quot;zh-cn&quot;, &quot;dimension3&quot;: false, &quot;dimension1&quot;: &quot;Signed out&quot;, &quot;dimension8&quot;: null}, &quot;gaid&quot;: &quot;UA-5831155-1&quot;}">
  



  
  
    <script>
      var dataLayer = [{"freeTrialEligibleUser": "False", "userCountry": "BE", "language": {"requested": "zh-cn", "served": "zh-cn"}, "projectName": "API Guides", "scriptsafe": null, "signedIn": "False", "internalUser": "False"}];
    </script>
  



  
  <a href="#top" id="skip-to-main">Skip to content</a>
  <header id="header-wrapper">
    <div class="dac-header" id="header">
      <div class="dac-header-inner">
        <a class="dac-nav-toggle" data-dac-toggle-nav href="#" title="Open navigation">
          <span class="dac-nav-hamburger">
            <span class="dac-nav-hamburger-top"></span>
            <span class="dac-nav-hamburger-mid"></span>
            <span class="dac-nav-hamburger-bot"></span>
          </span>
        </a>
        
        <a class="dac-header-logo" href="https://developer.android.com/index.html?hl=zh-cn">
          <img class="dac-header-logo-image" src="../../../static/images/android_logo0b8e.png?hl=zh-cn"
              srcset="https://developer.android.com/static/images/android_logo_2x.png 2x?hl=zh-cn"
              width="32" height="36" alt="Android"> Developers</a>
        <ul class="dac-header-tabs">
          <li>
            <a class="dac-header-tab" href="https://developer.android.com/design/index.html?hl=zh-cn"
               zh-tw-lang="設計"
               zh-cn-lang="设计"
               ru-lang="Проектирование"
               ko-lang="디자인"
               ja-lang="設計"
               es-lang="Diseñar">Design</a>
          </li>
          <li>
            <a class="dac-header-tab" href="https://developer.android.com/develop/index.html?hl=zh-cn"
               zh-tw-lang="開發"
               zh-cn-lang="开发"
               ru-lang="Разработка"
               ko-lang="개발"
               ja-lang="開発"
               es-lang="Desarrollar">Develop</a>
          </li>
          <li>
            <a class="dac-header-tab" href="https://developer.android.com/distribute/index.html?hl=zh-cn"
               zh-tw-lang="發佈"
               zh-cn-lang="分发"
               ru-lang="Распространение"
               ko-lang="배포"
               ja-lang="配布"
               es-lang="Distribuir">Distribute</a>
          </li>
        </ul>


        

        <a class="dac-header-console-btn gc-analytics-event" href="https://play.google.com/apps/publish/"
           data-category="User" data-action="Console" data-label="Clicked">
          <img src="https://developer.android.com/static/images/developer-console-icon.svg?hl=zh-cn" width="18" height="19" alt="Play 控制台">Play Console</a>

        

<form data-search="" class="dac-header-search">
  <button class="dac-header-search-close" data-search-close="">
    <i class="dac-sprite dac-back-arrow"></i>
  </button>

  <div class="dac-header-search-inner">
    <i class="dac-sprite dac-search-white dac-header-search-icon"></i>
    
    <input id="search_autocomplete" type="text" value="" autocomplete="off" name="q" class="dac-header-search-input" placeholder="搜索">
    <button class="dac-header-search-clear dac-hidden" data-search-clear="">
      <i class="dac-sprite dac-close-black"></i>
    </button>
  </div>
</form>

        
      </div><!--/.header-wrap.wrap-->
    </div><!--/.header-->

    

<div id="search-results" class="dac-search-results">
  <div id="dac-search-results-history" class="dac-search-results-history">
    <div class="wrap dac-search-results-history-wrap">
      <div class="cols">
        <div class="col-1of2 col-tablet-1of2 col-mobile-1of1">
          <h2>Most visited</h2>
          <div class="resource-flow-layout" data-history-query="history:most/visited" data-maxresults="3" data-cardsizes="18x2"></div>
        </div>

        <div class="col-1of2 col-tablet-1of2 col-mobile-1of1">
          <h2>Recently visited</h2>
          <div class="resource-flow-layout cols" data-history-query="history:recent" data-allow-duplicates="true" data-maxresults="3" data-cardsizes="18x2"></div>
        </div>
      </div>
    </div>
  </div>

  <div id="dac-search-results-content" class="dac-search-results-content">
    <div class="dac-search-results-metadata wrap">
      <div class="dac-search-results-for">
        
          <h2>
          Results for <span id="search-results-for"></span>
          </h2>
      </div>

      <div id="dac-search-results-hero"></div>

      <div class="dac-search-results-hero cols">
        <div id="dac-search-results-reference" class="col-6of6 col-tablet-2of2 col-mobile-1of1">
          <div class="suggest-card reference no-display">
            <ul class="dac-search-results-reference">
            </ul>
          </div>
        </div>
      </div>

      <div class="cols dac-search-results-cse">
        <script src="../../../../cse.google.com/f4116.txt?cx=000521750095050289010:zpcpi1ea4s8" async></script>
        <gcse:searchresults-only linkTarget="_self"></gcse:searchresults-only>
      </div>
    </div>
  </div>
</div>

  </header>

  <a name="navigation" tabindex=0 class="nav-start-marker">navigation</a>
  <nav class="dac-nav">
    <div class="dac-nav-dimmer" data-dac-toggle-nav></div>
    <div class="dac-nav-sidebar" data-swap data-dynamic="false" data-transition-speed="300" data-dac-nav>
      <div data-swap-container>
        
        <a class="dac-nav-back-button dac-swap-section dac-up dac-no-anim" tabindex=0 data-swap-button>
          
          <i class="dac-sprite dac-nav-back"></i> <span class="dac-nav-back-title">返回</span>
        </a>

        <div class="dac-nav-sub dac-swap-section dac-right dac-active" itemscope
            itemtype="http://schema.org/SiteNavigationElement">
          
          
            
            <ul id="nav">
              <li class="nav-section"><div class="nav-section-header"><a href="../../index0b8e.html?hl=zh-cn" >简介</a><span class="toggle-icon" tabindex="0"></span></div><ul><li><a href="../../components/fundamentals0b8e.html?hl=zh-cn" >应用基础知识</a></li><li><a href="../../practices/compatibility0b8e.html?hl=zh-cn" >设备兼容性</a></li><li><a href="../security/permissions0b8e.html?hl=zh-cn" >系统权限</a></li></ul></li><li class="nav-section"><div class="nav-section-header"><a href="../../platform/index0b8e.html?hl=zh-cn" >平台架构</a><span class="toggle-icon" tabindex="0"></span></div><ul><li><a href="../../platform/j8-jack0b8e.html?hl=zh-cn"  es-lang="Funciones del lenguaje Java 8" in-lang="Fitur Bahasa Java 8" ja-lang="Java 8 の機能" ko-lang="Java 8 언어 기능" pt-br-lang="Recursos de linguagem do Java 8" ru-lang="Возможности языка Java 8" vi-lang="Tính năng của Ngôn ngữ Java 8" zh-cn-lang="Java 8 の機能" zh-tw-lang="Java 8 の機能">使用 Java 8 语言功能</a></li><li><a href="../../practices/verifying-apps-art0b8e.html?hl=zh-cn" >在 Android Runtime (ART) 上验证应用行为</a></li></ul></li><li class="nav-section"><div class="nav-section-header"><a href="../../components/index0b8e.html?hl=zh-cn" >应用组件</a><span class="toggle-icon" tabindex="0"></span></div><ul><li class="nav-section"><div class="nav-section-header"><a href="../../components/intents-filters0b8e.html?hl=zh-cn" >Intent 和 Intent 过滤器</a><span class="toggle-icon" tabindex="0"></span></div><ul><li><a href="../../components/intents-common0b8e.html?hl=zh-cn" >通用 Intent</a></li></ul></li><li class="nav-section"><div class="nav-section-header"><a href="../../components/activities0b8e.html?hl=zh-cn" >Activity</a><span class="toggle-icon" tabindex="0"></span></div><ul><li><a href="../../components/fragments0b8e.html?hl=zh-cn" >片段</a></li><li><a href="../../components/loaders0b8e.html?hl=zh-cn" >加载器</a></li><li><a href="../../components/tasks-and-back-stack0b8e.html?hl=zh-cn" >任务和返回栈</a></li><li><a href="../../components/recents0b8e.html?hl=zh-cn" >概览屏幕</a></li></ul></li><li class="nav-section"><div class="nav-section-header"><a href="../../components/services0b8e.html?hl=zh-cn" >服务</a><span class="toggle-icon" tabindex="0"></span></div><ul><li><a href="../../components/bound-services0b8e.html?hl=zh-cn" >绑定服务</a></li><li><a href="../../components/aidl0b8e.html?hl=zh-cn" >AIDL</a></li></ul></li><li class="nav-section"><div class="nav-section-header"><a href="content-providers0b8e.html?hl=zh-cn" >内容提供程序</a><span class="toggle-icon" tabindex="0"></span></div><ul><li><a href="content-provider-basics0b8e.html?hl=zh-cn" >内容提供程序基础知识</a></li><li><a href="content-provider-creating0b8e.html?hl=zh-cn" >创建内容提供程序</a></li><li><a href="calendar-provider0b8e.html?hl=zh-cn" >日历提供程序</a></li><li><a href="contacts-provider0b8e.html?hl=zh-cn" >联系人提供程序</a></li><li><a href="document-provider0b8e.html?hl=zh-cn" >存储访问框架</a></li></ul></li><li class="nav-section"><div class="nav-section-header"><a href="../appwidgets/index0b8e.html?hl=zh-cn" >应用小部件</a><span class="toggle-icon" tabindex="0"></span></div><ul><li><a href="../appwidgets/host0b8e.html?hl=zh-cn" >应用小部件主机</a></li></ul></li><li><a href="../../components/processes-and-threads0b8e.html?hl=zh-cn" >进程和线程</a></li></ul></li><li class="nav-section"><div class="nav-section-header"><a href="../resources/index0b8e.html?hl=zh-cn" >应用资源</a><span class="toggle-icon" tabindex="0"></span></div><ul><li><a href="../resources/overview0b8e.html?hl=zh-cn" >概览</a></li><li><a href="../resources/providing-resources0b8e.html?hl=zh-cn" >提供资源</a></li><li><a href="../resources/accessing-resources0b8e.html?hl=zh-cn" >访问资源</a></li><li><a href="../resources/runtime-changes0b8e.html?hl=zh-cn" >处理运行时变更</a></li><li class="nav-section"><div class="nav-section-header"><a href="../resources/localization0b8e.html?hl=zh-cn" >本地化</a><span class="toggle-icon" tabindex="0"></span></div><ul><li><a href="../resources/icu4j-framework0b8e.html?hl=zh-cn" >ICU4J Android 框架 API</a></li><li><a href="../resources/multilingual-support0b8e.html?hl=zh-cn" >语言和语言区域</a></li></ul></li><li class="nav-section"><div class="nav-section-header"><a href="../resources/available-resources0b8e.html?hl=zh-cn" >资源类型</a><span class="toggle-icon" tabindex="0"></span></div><ul><li><a href="../resources/animation-resource0b8e.html?hl=zh-cn" >动画</a></li><li><a href="../resources/color-list-resource0b8e.html?hl=zh-cn" >颜色状态列表</a></li><li><a href="../resources/drawable-resource0b8e.html?hl=zh-cn" >可绘制对象</a></li><li><a href="../resources/layout-resource0b8e.html?hl=zh-cn" >布局</a></li><li><a href="../resources/menu-resource0b8e.html?hl=zh-cn" >菜单</a></li><li><a href="../resources/string-resource0b8e.html?hl=zh-cn" >字符串</a></li><li><a href="../resources/style-resource0b8e.html?hl=zh-cn" >样式</a></li><li><a href="../resources/more-resources0b8e.html?hl=zh-cn" >其他类型</a></li></ul></li></ul></li><li class="nav-section"><div class="nav-section-header"><a href="../manifest/manifest-intro0b8e.html?hl=zh-cn" >应用清单</a><span class="toggle-icon" tabindex="0"></span></div><ul><li><a href="../manifest/action-element0b8e.html?hl=zh-cn" >&lt;action&gt;</a></li><li><a href="../manifest/activity-element0b8e.html?hl=zh-cn" >&lt;activity&gt;</a></li><li><a href="../manifest/activity-alias-element0b8e.html?hl=zh-cn" >&lt;activity-alias&gt;</a></li><li><a href="../manifest/application-element0b8e.html?hl=zh-cn" >&lt;application&gt;</a></li><li><a href="../manifest/category-element0b8e.html?hl=zh-cn" >&lt;category&gt;</a></li><li><a href="../manifest/compatible-screens-element0b8e.html?hl=zh-cn" >&lt;compatible-screens&gt;</a></li><li><a href="../manifest/data-element0b8e.html?hl=zh-cn" >&lt;data&gt;</a></li><li><a href="../manifest/grant-uri-permission-element0b8e.html?hl=zh-cn" >&lt;grant-uri-permission&gt;</a></li><li><a href="../manifest/instrumentation-element0b8e.html?hl=zh-cn" >&lt;instrumentation&gt;</a></li><li><a href="../manifest/intent-filter-element0b8e.html?hl=zh-cn" >&lt;intent-filter&gt;</a></li><li><a href="../manifest/manifest-element0b8e.html?hl=zh-cn" >&lt;manifest&gt;</a></li><li><a href="../manifest/meta-data-element0b8e.html?hl=zh-cn" >&lt;meta-data&gt;</a></li><li><a href="../manifest/path-permission-element0b8e.html?hl=zh-cn" >&lt;path-permission&gt;</a></li><li><a href="../manifest/permission-element0b8e.html?hl=zh-cn" >&lt;permission&gt;</a></li><li><a href="../manifest/permission-group-element0b8e.html?hl=zh-cn" >&lt;permission-group&gt;</a></li><li><a href="../manifest/permission-tree-element0b8e.html?hl=zh-cn" >&lt;permission-tree&gt;</a></li><li><a href="../manifest/provider-element0b8e.html?hl=zh-cn" >&lt;provider&gt;</a></li><li><a href="../manifest/receiver-element0b8e.html?hl=zh-cn" >&lt;receiver&gt;</a></li><li><a href="../manifest/service-element0b8e.html?hl=zh-cn" >&lt;service&gt;</a></li><li><a href="../manifest/supports-gl-texture-element0b8e.html?hl=zh-cn" >&lt;supports-gl-texture&gt;</a></li><li><a href="../manifest/supports-screens-element0b8e.html?hl=zh-cn" >&lt;supports-screens&gt;</a></li><li><a href="../manifest/uses-configuration-element0b8e.html?hl=zh-cn" >&lt;uses-configuration&gt;</a></li><li><a href="../manifest/uses-feature-element0b8e.html?hl=zh-cn" >&lt;uses-feature&gt;</a></li><li><a href="../manifest/uses-library-element0b8e.html?hl=zh-cn" >&lt;uses-library&gt;</a></li><li><a href="../manifest/uses-permission-element0b8e.html?hl=zh-cn" >&lt;uses-permission&gt;</a></li><li><a href="../manifest/uses-permission-sdk-23-element0b8e.html?hl=zh-cn" >&lt;uses-permission-sdk-23&gt;</a></li><li><a href="../manifest/uses-sdk-element0b8e.html?hl=zh-cn" >&lt;uses-sdk&gt;</a></li></ul></li><li class="nav-section"><div class="nav-section-header"><a href="../ui/index0b8e.html?hl=zh-cn" >用户界面</a><span class="toggle-icon" tabindex="0"></span></div><ul><li><a href="../ui/overview0b8e.html?hl=zh-cn" >概览</a></li><li class="nav-section"><div class="nav-section-header"><a href="../ui/declaring-layout0b8e.html?hl=zh-cn" >布局</a><span class="toggle-icon" tabindex="0"></span></div><ul><li><a href="../ui/layout/linear0b8e.html?hl=zh-cn" >线性布局</a></li><li><a href="../ui/layout/relative0b8e.html?hl=zh-cn" >相对布局</a></li><li><a href="../ui/layout/listview0b8e.html?hl=zh-cn" >列表视图</a></li><li><a href="../ui/layout/gridview0b8e.html?hl=zh-cn" >网格视图</a></li></ul></li><li class="nav-section"><div class="nav-section-header"><a href="../ui/controls0b8e.html?hl=zh-cn" >输入控件</a><span class="toggle-icon" tabindex="0"></span></div><ul><li><a href="../ui/controls/button0b8e.html?hl=zh-cn" >按钮</a></li><li><a href="https://developer.android.com/training/keyboard-input/style.html?hl=zh-cn" >文本字段</a></li><li><a href="../ui/controls/checkbox0b8e.html?hl=zh-cn" >复选框</a></li><li><a href="../ui/controls/radiobutton0b8e.html?hl=zh-cn" >单选按钮</a></li><li><a href="../ui/controls/togglebutton0b8e.html?hl=zh-cn" >切换按钮</a></li><li><a href="../ui/controls/spinner0b8e.html?hl=zh-cn" >微调框</a></li><li><a href="../ui/controls/pickers0b8e.html?hl=zh-cn" >选取器</a></li></ul></li><li><a href="../ui/ui-events0b8e.html?hl=zh-cn" >输入事件</a></li><li><a href="../ui/menus0b8e.html?hl=zh-cn" >菜单</a></li><li><a href="../ui/settings0b8e.html?hl=zh-cn" >设置</a></li><li><a href="../ui/dialogs0b8e.html?hl=zh-cn" >对话框</a></li><li><a href="../ui/notifiers/notifications0b8e.html?hl=zh-cn" >通知</a></li><li><a href="../ui/notifiers/toasts0b8e.html?hl=zh-cn" >Toast</a></li><li class="nav-section"><div class="nav-section-header"><a href="../search/index0b8e.html?hl=zh-cn" >搜索</a><span class="toggle-icon" tabindex="0"></span></div><ul><li><a href="../search/search-dialog0b8e.html?hl=zh-cn" >创建搜索界面</a></li><li><a href="../search/adding-recent-query-suggestions0b8e.html?hl=zh-cn" >添加近期查询建议</a></li><li><a href="../search/adding-custom-suggestions0b8e.html?hl=zh-cn" >添加自定义建议</a></li><li><a href="../search/searchable-config0b8e.html?hl=zh-cn" >可搜索配置</a></li></ul></li><li><a href="../ui/multi-window0b8e.html?hl=zh-cn" >多窗口支持</a></li><li><a href="../ui/drag-drop0b8e.html?hl=zh-cn" >拖放</a></li><li class="nav-section"><div class="nav-section-header"><a href="../ui/accessibility/index0b8e.html?hl=zh-cn" >无障碍功能</a><span class="toggle-icon" tabindex="0"></span></div><ul><li><a href="../ui/accessibility/apps0b8e.html?hl=zh-cn" >为应用设置无障碍功能</a></li><li><a href="../ui/accessibility/checklist0b8e.html?hl=zh-cn" >无障碍功能开发者检查单</a></li><li><a href="../ui/accessibility/services0b8e.html?hl=zh-cn" >构建无障碍服务</a></li></ul></li><li><a href="../ui/themes0b8e.html?hl=zh-cn" >样式和主题</a></li><li><a href="../ui/custom-components0b8e.html?hl=zh-cn" >自定义组件</a></li></ul></li><li class="nav-section"><div class="nav-section-header"><a href="../graphics/index0b8e.html?hl=zh-cn" >动画和图形</a><span class="toggle-icon" tabindex="0"></span></div><ul><li><a href="../graphics/overview0b8e.html?hl=zh-cn" >概览</a></li><li><a href="../graphics/prop-animation0b8e.html?hl=zh-cn" >属性动画</a></li><li><a href="../graphics/view-animation0b8e.html?hl=zh-cn" >视图动画</a></li><li><a href="../graphics/drawable-animation0b8e.html?hl=zh-cn" >可绘制动画</a></li><li><a href="../graphics/2d-graphics0b8e.html?hl=zh-cn" >画布和可绘制对象</a></li><li><a href="../graphics/opengl0b8e.html?hl=zh-cn" >OpenGL ES</a></li><li><a href="../graphics/hardware-accel0b8e.html?hl=zh-cn" >硬件加速</a></li></ul></li><li class="nav-section"><div class="nav-section-header"><a href="../renderscript/index0b8e.html?hl=zh-cn" >计算</a><span class="toggle-icon" tabindex="0"></span></div><ul><li><a href="../renderscript/compute0b8e.html?hl=zh-cn" >RenderScript</a></li><li><a href="../renderscript/advanced0b8e.html?hl=zh-cn" >高级 RenderScript</a></li><li class="nav-section"><div class="nav-section-header"><a href="../renderscript/reference/overview0b8e.html?hl=zh-cn" >Runtime API 参考</a><span class="toggle-icon" tabindex="0"></span></div><ul><li><a href="../renderscript/reference/rs_value_types0b8e.html?hl=zh-cn" >数字类型</a></li><li><a href="../renderscript/reference/rs_object_types0b8e.html?hl=zh-cn" >对象类型</a></li><li><a href="../renderscript/reference/rs_convert0b8e.html?hl=zh-cn" >转换函数</a></li><li><a href="../renderscript/reference/rs_math0b8e.html?hl=zh-cn" >数学常量和函数</a></li><li><a href="../renderscript/reference/rs_vector_math0b8e.html?hl=zh-cn" >矢量数学函数</a></li><li><a href="../renderscript/reference/rs_matrix0b8e.html?hl=zh-cn" >矩阵函数</a></li><li><a href="../renderscript/reference/rs_quaternion0b8e.html?hl=zh-cn" >四元数函数</a></li><li><a href="../renderscript/reference/rs_atomic0b8e.html?hl=zh-cn" >原子更新函数</a></li><li><a href="../renderscript/reference/rs_time0b8e.html?hl=zh-cn" >时间函数和类型</a></li><li><a href="../renderscript/reference/rs_allocation_data0b8e.html?hl=zh-cn" >分配数据访问函数</a></li><li><a href="../renderscript/reference/rs_object_info0b8e.html?hl=zh-cn" >对象特性函数</a></li><li><a href="../renderscript/reference/rs_for_each0b8e.html?hl=zh-cn" >内核调用函数和类型</a></li><li><a href="../renderscript/reference/rs_io0b8e.html?hl=zh-cn" >输入/输出函数</a></li><li><a href="../renderscript/reference/rs_debug0b8e.html?hl=zh-cn" >调试函数</a></li><li><a href="../renderscript/reference/rs_graphics0b8e.html?hl=zh-cn" >图形函数和类型</a></li><li><a href="../renderscript/reference/index0b8e.html?hl=zh-cn" >索引</a></li></ul></li></ul></li><li class="nav-section"><div class="nav-section-header"><a href="../media/index0b8e.html?hl=zh-cn" >媒体和相机</a><span class="toggle-icon" tabindex="0"></span></div><ul><li><a href="../media/mediaplayer0b8e.html?hl=zh-cn" >媒体回放</a></li><li><a href="../media/mediarouter0b8e.html?hl=zh-cn" >媒体路由器</a></li><li><a href="../media/mediarouteprovider0b8e.html?hl=zh-cn" >媒体路由提供程序</a></li><li><a href="../media/exoplayer0b8e.html?hl=zh-cn" >ExoPlayer</a></li><li><a href="../media/media-formats0b8e.html?hl=zh-cn" >支持的媒体格式</a></li><li><a href="../media/mediarecorder0b8e.html?hl=zh-cn" >音频采集</a></li><li><a href="../media/jetplayer0b8e.html?hl=zh-cn" >JetPlayer</a></li><li><a href="../media/camera0b8e.html?hl=zh-cn" >相机</a></li></ul></li><li class="nav-section"><div class="nav-section-header"><a href="../sensors/index0b8e.html?hl=zh-cn" >位置和传感器</a><span class="toggle-icon" tabindex="0"></span></div><ul><li><a href="../location/index0b8e.html?hl=zh-cn" >位置和地图</a></li><li><a href="../location/strategies0b8e.html?hl=zh-cn" >位置策略</a></li><li><a href="../sensors/sensors_overview0b8e.html?hl=zh-cn" >传感器概览</a></li><li><a href="../sensors/sensors_motion0b8e.html?hl=zh-cn" >运动传感器</a></li><li><a href="../sensors/sensors_position0b8e.html?hl=zh-cn" >位置传感器</a></li><li><a href="../sensors/sensors_environment0b8e.html?hl=zh-cn" >环境传感器</a></li></ul></li><li class="nav-section"><div class="nav-section-header"><a href="../connectivity/index0b8e.html?hl=zh-cn" >连接</a><span class="toggle-icon" tabindex="0"></span></div><ul><li class="nav-section"><div class="nav-section-header"><a href="../connectivity/bluetooth0b8e.html?hl=zh-cn" >蓝牙</a><span class="toggle-icon" tabindex="0"></span></div><ul><li><a href="../connectivity/bluetooth-le0b8e.html?hl=zh-cn" >蓝牙低功耗</a></li></ul></li><li class="nav-section"><div class="nav-section-header"><a href="../connectivity/nfc/index0b8e.html?hl=zh-cn" >NFC</a><span class="toggle-icon" tabindex="0"></span></div><ul><li><a href="../connectivity/nfc/nfc0b8e.html?hl=zh-cn" >NFC 基础知识</a></li><li><a href="../connectivity/nfc/advanced-nfc0b8e.html?hl=zh-cn" >高级 NFC</a></li><li><a href="../connectivity/nfc/hce0b8e.html?hl=zh-cn" >基于主机的卡模拟</a></li></ul></li><li><a href="../connectivity/wifip2p0b8e.html?hl=zh-cn" >Wi-Fi P2P</a></li><li class="nav-section"><div class="nav-section-header"><a href="../connectivity/usb/index0b8e.html?hl=zh-cn" >USB</a><span class="toggle-icon" tabindex="0"></span></div><ul><li><a href="../connectivity/usb/accessory0b8e.html?hl=zh-cn" >配件</a></li><li><a href="../connectivity/usb/host0b8e.html?hl=zh-cn" >主机</a></li></ul></li><li><a href="../connectivity/sip0b8e.html?hl=zh-cn" >SIP</a></li></ul></li><li class="nav-section"><div class="nav-section-header"><a href="../text/index0b8e.html?hl=zh-cn" >文本和输入</a><span class="toggle-icon" tabindex="0"></span></div><ul><li><a href="../text/copy-paste0b8e.html?hl=zh-cn" >复制和粘贴</a></li><li><a href="../text/creating-input-method0b8e.html?hl=zh-cn" >创建 IME</a></li><li><a href="../text/spell-checker-framework0b8e.html?hl=zh-cn" >拼写检查程序</a></li></ul></li><li class="nav-section"><div class="nav-section-header"><a href="../data/index0b8e.html?hl=zh-cn" >数据存储</a><span class="toggle-icon" tabindex="0"></span></div><ul><li><a href="../data/data-storage0b8e.html?hl=zh-cn" >存储选项</a></li><li><a href="../data/backup0b8e.html?hl=zh-cn" >数据备份</a></li><li><a href="../data/install-location0b8e.html?hl=zh-cn" >应用安装位置</a></li></ul></li><li class="nav-section"><div class="nav-section-header"><a href="https://developer.android.com/topic/libraries/index.html?hl=zh-cn" >库</a><span class="toggle-icon" tabindex="0"></span></div><ul><li class="nav-section"><div class="nav-section-header"><a href="https://developer.android.com/topic/libraries/support-library/index.html?hl=zh-cn" >支持库</a><span class="toggle-icon" tabindex="0"></span></div><ul><li><a href="https://developer.android.com/topic/libraries/support-library/features.html?hl=zh-cn" >功能</a></li><li><a href="https://developer.android.com/topic/libraries/support-library/setup.html?hl=zh-cn" >设置</a></li><li><a href="https://developer.android.com/topic/libraries/support-library/revisions.html?hl=zh-cn" >修订历史记录</a></li></ul></li><li><a href="https://developer.android.com/topic/libraries/data-binding/index.html?hl=zh-cn" >数据绑定库</a></li><li class="nav-section"><div class="nav-section-header"><a href="https://developer.android.com/topic/libraries/testing-support-library/index.html?hl=zh-cn" >测试支持库</a><span class="toggle-icon" tabindex="0"></span></div><ul><li><a href="https://developer.android.com/reference/android/support/test/package-summary.html?hl=zh-cn" >API 参考</a></li></ul></li></ul></li><li class="nav-section"><div class="nav-section-header"><a href="../admin/index0b8e.html?hl=zh-cn" >管理</a><span class="toggle-icon" tabindex="0"></span></div><ul><li><a href="../admin/device-admin0b8e.html?hl=zh-cn" >设备政策</a></li></ul></li><li class="nav-section"><div class="nav-section-header"><a href="../../webapps/index0b8e.html?hl=zh-cn" >网络应用</a><span class="toggle-icon" tabindex="0"></span></div><ul><li><a href="../../webapps/targeting0b8e.html?hl=zh-cn" >在网络应用中支持不同屏幕</a></li><li><a href="../../webapps/webview0b8e.html?hl=zh-cn" >在 WebView 中构建网络应用</a></li><li><a href="../../webapps/migrating0b8e.html?hl=zh-cn" >迁移到 Android 4.4 中的 WebView</a></li><li><a href="../../webapps/debugging0b8e.html?hl=zh-cn" >调试网络应用</a></li><li><a href="../../webapps/best-practices0b8e.html?hl=zh-cn" >网络应用最佳做法</a></li></ul></li><li class="nav-section"><div class="nav-section-header"><a href="../../practices/index0b8e.html?hl=zh-cn"  de-lang="Bewährte Verfahren" es-lang="Prácticas recomendadas" fr-lang="Meilleures pratiques" it-lang="最佳做法" ja-lang="ベスト プラクティス" zh-cn-lang="最佳实践" zh-tw-lang="最佳實務">最佳做法</a><span class="toggle-icon" tabindex="0"></span></div><ul><li class="nav-section"><div class="nav-section-header"><a href="../../practices/screens_support0b8e.html?hl=zh-cn" >支持多种屏幕</a><span class="toggle-icon" tabindex="0"></span></div><ul><li><a href="../../practices/screens-distribution0b8e.html?hl=zh-cn" >分配到特定屏幕</a></li><li><a href="../../practices/screen-compat-mode0b8e.html?hl=zh-cn" >屏幕兼容性模式</a></li></ul></li><li><a href="../../practices/tablets-and-handsets0b8e.html?hl=zh-cn" >支持平板电脑和手机</a></li></ul></li>
            </ul>
            
          
        </div>
        
        
          



<ul id="dac-main-navigation" class="dac-nav-list dac-swap-section dac-left dac-no-anim" tabindex=0>
  <li class="dac-nav-item home">
    <a class="dac-nav-link" href="https://developer.android.com/index.html?hl=zh-cn">首页</a>
    <i class="dac-sprite dac-expand-more-black dac-nav-sub-slider" tabindex=0></i>
    <ul class="dac-nav-secondary about">
      <li class="dac-nav-item versions">
        <a class="dac-nav-link" href="https://developer.android.com/about/versions/nougat/index.html?hl=zh-cn">Android</a>
      </li>
      <li class="dac-nav-item wear">
        <a class="dac-nav-link" href="https://developer.android.com/wear/index.html?hl=zh-cn">Wear</a>
      </li>
      <li class="dac-nav-item tv">
        <a class="dac-nav-link" href="https://developer.android.com/tv/index.html?hl=zh-cn">TV</a>
      </li>
      <li class="dac-nav-item auto">
        <a class="dac-nav-link" href="https://developer.android.com/auto/index.html?hl=zh-cn">Auto</a>
      </li>
      <li class="dac-nav-item things">
        <a class="dac-nav-link" href="https://developer.android.com/things/index.html?hl=zh-cn">Things</a>
      </li>
    </ul>
  </li>
  <li class="dac-nav-item design">
    <a class="dac-nav-link" href="https://developer.android.com/design/index.html?hl=zh-cn"
       zh-tw-lang="設計"
       zh-cn-lang="设计"
       ru-lang="Проектирование"
       ko-lang="디자인"
       ja-lang="設計"
       es-lang="Diseñar">Design</a>
  </li>
  <li class="dac-nav-item develop">
    <a class="dac-nav-link" href="https://developer.android.com/develop/index.html?hl=zh-cn"
       zh-tw-lang="開發"
       zh-cn-lang="开发"
       ru-lang="Разработка"
       ko-lang="개발"
       ja-lang="開発"
       es-lang="Desarrollar">Develop</a>
    <i class="dac-sprite dac-expand-more-black dac-nav-sub-slider" tabindex=0></i>
    <ul class="dac-nav-secondary develop">
      <li class="dac-nav-item training">
        <a class="dac-nav-link" href="https://developer.android.com/training/index.html?hl=zh-cn"
           zh-tw-lang="訓練課程"
           zh-cn-lang="培训"
           ru-lang="Курсы"
           ko-lang="교육"
           ja-lang="トレーニング"
           es-lang="Capacitación">培训</a>
      </li>
      <li class="dac-nav-item guide">
        <a class="dac-nav-link" href="../../index0b8e.html?hl=zh-cn"
           zh-tw-lang="API 指南"
           zh-cn-lang="API 指南"
           ru-lang="Руководства по API"
           ko-lang="API 가이드"
           ja-lang="API ガイド"
           es-lang="Guías de la API">API Guides</a>
      </li>
      <li class="dac-nav-item reference">
        <a class="dac-nav-link" href="https://developer.android.com/reference/packages.html?hl=zh-cn"
           zh-tw-lang="參考資源"
           zh-cn-lang="参考"
           ru-lang="Справочник"
           ko-lang="참조문서"
           ja-lang="リファレンス"
           es-lang="Referencia">参考网页</a>
      </li>
      <li class="dac-nav-item samples">
        <a class="dac-nav-link" href="https://developer.android.com/samples/index.html?hl=zh-cn">示例</a>
      </li>
      <li class="dac-nav-item libraries">
        <a class="dac-nav-link" href="https://developer.android.com/topic/libraries/index.html?hl=zh-cn"
           >库</a></li>
      <li class="dac-nav-item studio">
        <a class="dac-nav-link" href="https://developer.android.com/studio/index.html?hl=zh-cn"
           >Android Studio</a></li>
      <li class="dac-nav-item ndk">
        <a class="dac-nav-link" href="https://developer.android.com/ndk/index.html?hl=zh-cn"
           >Android NDK</a></li>
      <li class="dac-nav-item google">
        <a class="dac-nav-link" href="https://developer.android.com/google/index.html?hl=zh-cn">Google Services</a>
      </li>
      <li class="dac-nav-item quality-guidelines">
        <a class="dac-nav-link" href="https://developer.android.com/develop/quality-guidelines/index.html?hl=zh-cn">Quality Guidelines</a>
      </li>
      <li class="dac-nav-item kotlin">
        <a class="dac-nav-link" href="https://developer.android.com/kotlin/index.html?hl=zh-cn">Kotlin</a>
       </li>
    </ul>
  </li>
  <li class="dac-nav-item distribute">
    <a class="dac-nav-link" href="https://developer.android.com/distribute/index.html?hl=zh-cn"
       zh-tw-lang="發佈"
       zh-cn-lang="分发"
       ru-lang="Распространение"
       ko-lang="배포"
       ja-lang="配布"
       de-lang="Vertrieb"
       es-lang="Distribuir"
       es-419-lang="Distribuye"
       fr-lang="Distribuer"
       id-lang="Distribusikan"
       pt-br-lang="Distribuição"
       th-lang="จัดจำหน่าย"
       tr-lang="Dağıtma"
       vi-lang="Phân phối">Distribute</a>
    <i class="dac-sprite dac-expand-more-black dac-nav-sub-slider" tabindex=0></i>
    <ul class="dac-nav-secondary distribute">
      <li class="dac-nav-item google-play">
        <a class="dac-nav-link" href="https://developer.android.com/distribute/google-play/index.html?hl=zh-cn">Google Play</a>
      </li>
      <li class="dac-nav-item console">
        <a class="dac-nav-link" href="https://developer.android.com/distribute/console/index.html?hl=zh-cn">Play 控制台</a>
      </li>
      <li class="dac-nav-item best-practices">
        <a class="dac-nav-link" href="https://developer.android.com/distribute/best-practices/index.html?hl=zh-cn"
          es-419-lang="Recomendaciones"
          fr-lang="Bonnes pratiques"
          id-lang="Praktik terbaik"
          ja-lang="おすすめの方法"
          ko-lang="권장사항"
          pt-br-lang="Práticas recomendadas"
          ru-lang="Рекомендации"
          th-lang="จัดจำหน่าย"
          tr-lang="En iyi uygulamalar"
          vi-lang="Các phương pháp hay nhất"
          zh-cn-lang="最佳做法"
          zh-tw-lang="最佳做法">Best practices</a>
      </li>
      <li class="dac-nav-item marketing-tools">
        <a class="dac-nav-link" href="https://developer.android.com/distribute/marketing-tools/index.html?hl=zh-cn"
          de-lang="Marketing-Tools"
          es-419-lang="Herramientas de marketing"
          fr-lang="Outils marketing"
          id-lang="Fitur pemasaran"
          ja-lang="マーケティング ツール"
          ko-lang="마케팅 도구"
          pt-br-lang="Ferramentas de marketing"
          ru-lang="Маркетинговые инструменты"
          th-lang="เครื่องมือการตลาด"
          tr-lang="Pazarlama araçları"
          vi-lang="Công cụ tiếp thị"
          zh-cn-lang="营销工具"
          zh-tw-lang="行銷工具">Marketing tools</a>
      </li>
      <li class="dac-nav-item policy-center">
        <a class="dac-nav-link" href="https://play.google.com/about/developer-content-policy/" target="_blank">Policy center</a>
      </li>
    </ul>
  </li>
  <li class="dac-nav-item stories">
    <a class="dac-nav-link" href="https://developer.android.com/stories/index.html?hl=zh-cn">Stories</a>
  </li>
  
  <li class="dac-nav-item preview">
    <a class="dac-nav-link" href="https://developer.android.com/preview/index.html?hl=zh-cn">Preview</a>
  </li>
  
</ul>

        
      </div>
    </div>
  </nav>

  <a name="top" tabindex="0"></a>
  
  <div class="wrap clearfix" id="body-content">
  
    
      
      <div class="content-header">
        <ul class="dac-header-crumbs"></ul>
        <!-- Breadcrumb Setup -->
        <script>$('.dac-nav-list').dacCurrentPage().dacCrumbs();</script>
        <h1 itemprop="name">存储访问框架</h1>
      
        
      
      </div>
      
    
    <div class="jd-descr " itemprop="articleBody">
      

<div id="qv-wrapper">
<div id="qv">

<h2>本文内容
<a href="#" onclick="hideNestedItems('#toc44',this);return false;" class="header-toggle">
        <span class="more">显示详细信息</span>
        <span class="less" style="display:none">显示精简信息</span></a></h2>
<ol id="toc44" class="hide-nested">
    <li>
        <a href="#overview">概览</a>
    </li>
    <li>
        <a href="#flow">控制流</a>
    </li>
    <li>
        <a href="#client">编写客户端应用</a>
        <ol>
        <li><a href="#search">搜索文档</a></li>
        <li><a href="#process">处理结果</a></li>
        <li><a href="#metadata">检查文档元数据</a></li>
        <li><a href="#open">打开文档</a></li>
        <li><a href="#create">创建新文档</a></li>
        <li><a href="#delete">删除文档</a></li>
        <li><a href="#edit">编辑文档</a></li>
        <li><a href="#permissions">保留权限</a></li>
        </ol>
    </li>
    <li><a href="#custom">编写自定义文档提供程序</a>
        <ol>
        <li><a href="#manifest">清单文件</a></li>
        <li><a href="#contract">协定类</a></li>
        <li><a href="#subclass">为 DocumentsProvider 创建子类</a></li>
        <li><a href="#security">安全性</a></li>
        </ol>
    </li>

</ol>
<h2>关键类</h2>
<ol>
    <li><code><a href="https://developer.android.com/reference/android/provider/DocumentsProvider.html?hl=zh-cn">DocumentsProvider</a></code></li>
    <li><code><a href="https://developer.android.com/reference/android/provider/DocumentsContract.html?hl=zh-cn">DocumentsContract</a></code></li>
</ol>

<h2>视频</h2>

<ol>
    <li><a href="http://www.youtube.com/watch?v=zxHVeXbK1P4&amp;hl=zh-cn">
DevBytes：Android 4.4 存储访问框架：提供程序</a></li>
     <li><a href="http://www.youtube.com/watch?v=UFj9AEz0DHQ&amp;hl=zh-cn">
DevBytes：Android 4.4 存储访问框架：客户端</a></li>
</ol>


<h2>代码示例</h2>

<ol>
    <li><a href="https://developer.android.com/samples/StorageProvider/index.html?hl=zh-cn">
存储提供程序</a></li>
     <li><a href="https://developer.android.com/samples/StorageClient/index.html?hl=zh-cn">
StorageClient</a></li>
</ol>

<h2>另请参阅</h2>
<ol>
    <li>
        <a href="content-provider-basics0b8e.html?hl=zh-cn">
内容提供程序基础知识
</a>
    </li>
</ol>

</div>
</div>


<p>Android 4.4（API 级别 19）引入了存储访问框架 (SAF)。SAF
让用户能够在其所有首选文档存储提供程序中方便地浏览并打开文档、图像以及其他文件。
用户可以通过易用的标准 UI，以统一方式在所有应用和提供程序中浏览文件和访问最近使用的文件。
</p>

<p>云存储服务或本地存储服务可以通过实现封装其服务的
<code><a href="https://developer.android.com/reference/android/provider/DocumentsProvider.html?hl=zh-cn">DocumentsProvider</a></code> 参与此生态系统。只需几行代码，便可将需要访问提供程序文档的客户端应用与
SAF 集成。
</p>

<p>SAF 包括以下内容：</p>

<ul>
<li><strong>文档提供程序</strong> &mdash; 一种内容提供程序，允许存储服务（如 Google Drive）显示其管理的文件。
文档提供程序作为
<code><a href="https://developer.android.com/reference/android/provider/DocumentsProvider.html?hl=zh-cn">DocumentsProvider</a></code>
类的子类实现。文档提供程序的架构基于传统文件层次结构，但其实际数据存储方式由您决定。Android
平台包括若干内置文档提供程序，如 Downloads、Images 和 Videos。

</li>

<li><strong>客户端应用</strong> &mdash; 一种自定义应用，它调用
<code><a href="https://developer.android.com/reference/android/content/Intent.html?hl=zh-cn#ACTION_OPEN_DOCUMENT">ACTION_OPEN_DOCUMENT</a></code> 和/或
<code><a href="https://developer.android.com/reference/android/content/Intent.html?hl=zh-cn#ACTION_CREATE_DOCUMENT">ACTION_CREATE_DOCUMENT</a></code> Intent 并接收文档提供程序返回的文件；
</li>

<li><strong>选取器</strong> &mdash; 一种系统
UI，允许用户访问所有满足客户端应用搜索条件的文档提供程序内的文档。</li>
</ul>

<p>SAF 提供的部分功能如下：</p>
<ul>
<li>允许用户浏览所有文档提供程序而不仅仅是单个应用中的内容；</li>
<li>让您的应用获得对文档提供程序所拥有文档的长期、持久性访问权限。
用户可以通过此访问权限添加、编辑、保存和删除提供程序上的文件；
</li>
<li>支持多个用户帐户和临时根目录，如只有在插入驱动器后才会出现的 USB
存储提供程序。 </li>
</ul>

<h2 id ="overview">概览</h2>

<p>SAF 围绕的内容提供程序是
<code><a href="https://developer.android.com/reference/android/provider/DocumentsProvider.html?hl=zh-cn">DocumentsProvider</a></code> 类的一个子类。在<em>文档提供程序</em>内，数据结构采用传统的文件层次结构：
</p>
<p><img src="../../../images/providers/storage_datamodel0b8e.png?hl=zh-cn" alt="数据模型" /></p>
<p class="img-caption"><strong>图 1.</strong> 文档提供程序数据模型。根目录指向单个文档，后者随即启动整个结构树的扇出。
</p>

<p>请注意以下事项：</p>
<ul>

<li>每个文档提供程序都会报告一个或多个作为探索文档结构树起点的“根目录”。每个根目录都有一个唯一的
<code><a href="https://developer.android.com/reference/android/provider/DocumentsContract.Root.html?hl=zh-cn#COLUMN_ROOT_ID">COLUMN_ROOT_ID</a></code>，并且指向表示该根目录下内容的文档（目录）。根目录采用动态设计，以支持多个帐户、临时 USB 存储设备或用户登录/注销等用例；




</li>

<li>每个根目录下都有一个文档。该文档指向 1 至 <em>N</em>
个文档，而其中每个文档又可指向 1 至 <em>N</em> 个文档； </li>

<li>每个存储后端都会通过使用唯一的
<code><a href="https://developer.android.com/reference/android/provider/DocumentsContract.Document.html?hl=zh-cn#COLUMN_DOCUMENT_ID">COLUMN_DOCUMENT_ID</a></code> 引用各个文件和目录来显示它们。文档 ID 必须具有唯一性，一旦发放便不得更改，因为它们用于所有设备重启过程中的永久性 URI 授权；


</li>


<li>文档可以是可打开的文件（具有特定 MIME
类型）或包含附加文档的目录（具有
<code><a href="https://developer.android.com/reference/android/provider/DocumentsContract.Document.html?hl=zh-cn#MIME_TYPE_DIR">MIME_TYPE_DIR</a></code> MIME 类型）；</li>

<li>每个文档都可以具有不同的功能，如
<code><a href="https://developer.android.com/reference/android/provider/DocumentsContract.Document.html?hl=zh-cn#COLUMN_FLAGS">COLUMN_FLAGS</a></code> 所述。例如，<code><a href="https://developer.android.com/reference/android/provider/DocumentsContract.Document.html?hl=zh-cn#FLAG_SUPPORTS_WRITE">FLAG_SUPPORTS_WRITE</a></code>、<code><a href="https://developer.android.com/reference/android/provider/DocumentsContract.Document.html?hl=zh-cn#FLAG_SUPPORTS_DELETE">FLAG_SUPPORTS_DELETE</a></code>
和
<code><a href="https://developer.android.com/reference/android/provider/DocumentsContract.Document.html?hl=zh-cn#FLAG_SUPPORTS_THUMBNAIL">FLAG_SUPPORTS_THUMBNAIL</a></code>。多个目录中可以包含相同的
<code><a href="https://developer.android.com/reference/android/provider/DocumentsContract.Document.html?hl=zh-cn#COLUMN_DOCUMENT_ID">COLUMN_DOCUMENT_ID</a></code>。

</li>
</ul>

<h2 id="flow">控制流</h2>
<p>如前文所述，文档提供程序数据模型基于传统文件层次结构。
不过，只要可以通过
<code><a href="https://developer.android.com/reference/android/provider/DocumentsProvider.html?hl=zh-cn">DocumentsProvider</a></code> API 访问数据，您实际上可以按照自己喜好的任何方式存储数据。例如，您可以使用基于标记的云存储来存储数据。
</p>

<p>图 2 中的示例展示的是照片应用如何利用 SAF 访问存储的数据：
</p>
<p><img src="../../../images/providers/storage_dataflow0b8e.png?hl=zh-cn" alt="应用" /></p>

<p class="img-caption"><strong>图 2.</strong> 存储访问框架流</p>

<p>请注意以下事项：</p>
<ul>

<li>在 SAF 中，提供程序和客户端并不直接交互。
客户端请求与文件交互（即读取、编辑、创建或删除文件）的权限；
</li>

<li>交互在应用（在本示例中为照片应用）触发 Intent 
<code><a href="https://developer.android.com/reference/android/content/Intent.html?hl=zh-cn#ACTION_OPEN_DOCUMENT">ACTION_OPEN_DOCUMENT</a></code> 或 <code><a href="https://developer.android.com/reference/android/content/Intent.html?hl=zh-cn#ACTION_CREATE_DOCUMENT">ACTION_CREATE_DOCUMENT</a></code> 后开始。Intent 可能包括进一步细化条件的过滤器 &mdash; 例如，“为我提供所有 MIME
类型为‘图像’的可打开文件”；
</li>

<li>Intent 触发后，系统选取器将检索每个已注册的提供程序，并向用户显示匹配的内容根目录；
</li>

<li>选取器会为用户提供一个标准的文档访问界面，但底层文档提供程序可能与其差异很大。
例如，图 2 显示了一个 Google Drive 提供程序、一个 USB 提供程序和一个云提供程序。
</li>
</ul>

<p>图 3 显示了一个选取器，一位搜索图像的用户在其中选择了一个
Google Drive 帐户：</p>

<p><img src="../../../images/providers/storage_picker0b8e.png?hl=zh-cn" width="340"
alt="选取器" style="border:2px solid #ddd"/></p>

<p class="img-caption"><strong>图 3.</strong> 选取器</p>

<p>当用户选择 Google Drive 时，系统会显示图像，如图 4 所示。从这时起，用户就可以通过提供程序和客户端应用支持的任何方式与它们进行交互。



<p><img src="../../../images/providers/storage_photos0b8e.png?hl=zh-cn" width="340"
alt="选取器" style="border:2px solid #ddd"/></p>

<p class="img-caption"><strong>图 4.</strong> 图像</p>

<h2 id="client">编写客户端应用</h2>

<p>对于 Android 4.3
及更低版本，如果您想让应用从其他应用中检索文件，它必须调用 <code><a href="https://developer.android.com/reference/android/content/Intent.html?hl=zh-cn#ACTION_PICK">ACTION_PICK</a></code>
或 <code><a href="https://developer.android.com/reference/android/content/Intent.html?hl=zh-cn#ACTION_GET_CONTENT">ACTION_GET_CONTENT</a></code> 等 Intent。然后，用户必须选择一个要从中选取文件的应用，并且所选应用必须提供一个用户界面，以便用户浏览和选取可用文件。

 </p>

<p>对于 Android 4.4 及更高版本，您还可以选择使用
<code><a href="https://developer.android.com/reference/android/content/Intent.html?hl=zh-cn#ACTION_OPEN_DOCUMENT">ACTION_OPEN_DOCUMENT</a></code>
 Intent，后者会显示一个由系统控制的选取器
UI，用户可以通过它浏览其他应用提供的所有文件。用户只需通过这一个 UI
便可从任何受支持的应用中选取文件。</p>

<p><code><a href="https://developer.android.com/reference/android/content/Intent.html?hl=zh-cn#ACTION_OPEN_DOCUMENT">ACTION_OPEN_DOCUMENT</a></code>
并非设计用于替代 <code><a href="https://developer.android.com/reference/android/content/Intent.html?hl=zh-cn#ACTION_GET_CONTENT">ACTION_GET_CONTENT</a></code>。应使用的 Intent 取决于应用的需要：
</p>

<ul>
<li>如果您只想让应用读取/导入数据，请使用
<code><a href="https://developer.android.com/reference/android/content/Intent.html?hl=zh-cn#ACTION_GET_CONTENT">ACTION_GET_CONTENT</a></code>。使用此方法时，应用会导入数据（如图像文件）的副本；
</li>

<li>如果您想让应用获得对文档提供程序所拥有文档的长期、持久性访问权限，请使用
<code><a href="https://developer.android.com/reference/android/content/Intent.html?hl=zh-cn#ACTION_OPEN_DOCUMENT">ACTION_OPEN_DOCUMENT</a></code>。
例如，允许用户编辑存储在文档提供程序中的图像的照片编辑应用。
 </li>

</ul>


<p>本节描述如何编写基于
<code><a href="https://developer.android.com/reference/android/content/Intent.html?hl=zh-cn#ACTION_OPEN_DOCUMENT">ACTION_OPEN_DOCUMENT</a></code> 和
<code><a href="https://developer.android.com/reference/android/content/Intent.html?hl=zh-cn#ACTION_CREATE_DOCUMENT">ACTION_CREATE_DOCUMENT</a></code> Intent 的客户端应用。</p>


<h3 id="search">搜索文档</h3>

<p>
以下代码段使用
<code><a href="https://developer.android.com/reference/android/content/Intent.html?hl=zh-cn#ACTION_OPEN_DOCUMENT">ACTION_OPEN_DOCUMENT</a></code>
来搜索包含图像文件的文档提供程序：</p>

<pre>private static final int READ_REQUEST_CODE = 42;
...
/**
 * Fires an intent to spin up the &quot;file chooser&quot; UI and select an image.
 */
public void performFileSearch() {

    // ACTION_OPEN_DOCUMENT is the intent to choose a file via the system's file
    // browser.
    Intent intent = new Intent(Intent.ACTION_OPEN_DOCUMENT);

    // Filter to only show results that can be &quot;opened&quot;, such as a
    // file (as opposed to a list of contacts or timezones)
    intent.addCategory(Intent.CATEGORY_OPENABLE);

    // Filter to show only images, using the image MIME data type.
    // If one wanted to search for ogg vorbis files, the type would be &quot;audio/ogg&quot;.
    // To search for all documents available via installed storage providers,
    // it would be &quot;*/*&quot;.
    intent.setType(&quot;image/*&quot;);

    startActivityForResult(intent, READ_REQUEST_CODE);
}</pre>

<p>请注意以下事项：</p>
<ul>
<li>当应用触发 <code><a href="https://developer.android.com/reference/android/content/Intent.html?hl=zh-cn#ACTION_OPEN_DOCUMENT">ACTION_OPEN_DOCUMENT</a></code>
 Intent 时，后者会启动一个选取器来显示所有匹配的文档提供程序</li>

<li>在 Intent 中添加类别 <code><a href="https://developer.android.com/reference/android/content/Intent.html?hl=zh-cn#CATEGORY_OPENABLE">CATEGORY_OPENABLE</a></code>
可对结果进行过滤，以仅显示可以打开的文档（如图像文件）</li>

<li>语句 <code>intent.setType(&quot;image/*&quot;)</code> 可做进一步过滤，以仅显示 MIME 数据类型为图像的文档
</li>
</ul>

<h3 id="results">处理结果</h3>

<p>用户在选取器中选择文档后，系统就会调用
<code><a href="https://developer.android.com/reference/android/app/Activity.html?hl=zh-cn#onActivityResult(int, int, android.content.Intent)">onActivityResult()</a></code>。指向所选文档的 URI
包含在 <code>resultData</code>
参数中。使用 <code><a href="https://developer.android.com/reference/android/content/Intent.html?hl=zh-cn#getData()">getData()</a></code>
提取 URI。获得 URI 后，即可使用它来检索用户想要的文档。例如：
</p>

<pre>&#64;Override
public void onActivityResult(int requestCode, int resultCode,
        Intent resultData) {

    // The ACTION_OPEN_DOCUMENT intent was sent with the request code
    // READ_REQUEST_CODE. If the request code seen here doesn't match, it's the
    // response to some other intent, and the code below shouldn't run at all.

    if (requestCode == READ_REQUEST_CODE && resultCode == Activity.RESULT_OK) {
        // The document selected by the user won't be returned in the intent.
        // Instead, a URI to that document will be contained in the return intent
        // provided to this method as a parameter.
        // Pull that URI using resultData.getData().
        Uri uri = null;
        if (resultData != null) {
            uri = resultData.getData();
            Log.i(TAG, "Uri: " + uri.toString());
            showImage(uri);
        }
    }
}
</pre>

<h3 id="metadata">检查文档元数据</h3>

<p>获得文档的 URI 后，即可获得对其元数据的访问权限。以下代码段用于获取 URI
所指定文档的元数据并将其记入日志：</p>

<pre>public void dumpImageMetaData(Uri uri) {

    // The query, since it only applies to a single document, will only return
    // one row. There's no need to filter, sort, or select fields, since we want
    // all fields for one document.
    Cursor cursor = getActivity().getContentResolver()
            .query(uri, null, null, null, null, null);

    try {
    // moveToFirst() returns false if the cursor has 0 rows.  Very handy for
    // &quot;if there's anything to look at, look at it&quot; conditionals.
        if (cursor != null &amp;&amp; cursor.moveToFirst()) {

            // Note it's called &quot;Display Name&quot;.  This is
            // provider-specific, and might not necessarily be the file name.
            String displayName = cursor.getString(
                    cursor.getColumnIndex(OpenableColumns.DISPLAY_NAME));
            Log.i(TAG, &quot;Display Name: &quot; + displayName);

            int sizeIndex = cursor.getColumnIndex(OpenableColumns.SIZE);
            // If the size is unknown, the value stored is null.  But since an
            // int can't be null in Java, the behavior is implementation-specific,
            // which is just a fancy term for &quot;unpredictable&quot;.  So as
            // a rule, check if it's null before assigning to an int.  This will
            // happen often:  The storage API allows for remote files, whose
            // size might not be locally known.
            String size = null;
            if (!cursor.isNull(sizeIndex)) {
                // Technically the column stores an int, but cursor.getString()
                // will do the conversion automatically.
                size = cursor.getString(sizeIndex);
            } else {
                size = &quot;Unknown&quot;;
            }
            Log.i(TAG, &quot;Size: &quot; + size);
        }
    } finally {
        cursor.close();
    }
}
</pre>

<h3 id="open-client">打开文档</h3>

<p>获得文档的 URI
后，即可打开文档或对其执行任何其他您想要执行的操作。</p>

<h4>位图</h4>

<p>以下示例展示了如何打开 <code><a href="https://developer.android.com/reference/android/graphics/Bitmap.html?hl=zh-cn">Bitmap</a></code>：</p>

<pre>private Bitmap getBitmapFromUri(Uri uri) throws IOException {
    ParcelFileDescriptor parcelFileDescriptor =
            getContentResolver().openFileDescriptor(uri, "r");
    FileDescriptor fileDescriptor = parcelFileDescriptor.getFileDescriptor();
    Bitmap image = BitmapFactory.decodeFileDescriptor(fileDescriptor);
    parcelFileDescriptor.close();
    return image;
}
</pre>

<p>请注意，您不应在 UI 线程上执行此操作。请使用
<code><a href="https://developer.android.com/reference/android/os/AsyncTask.html?hl=zh-cn">AsyncTask</a></code> 在后台执行此操作。打开位图后，即可在
<code><a href="https://developer.android.com/reference/android/widget/ImageView.html?hl=zh-cn">ImageView</a></code> 中显示它。
</p>

<h4>获取 InputStream</h4>

<p>以下示例展示了如何从 URI 中获取 <code><a href="https://developer.android.com/reference/java/io/InputStream.html?hl=zh-cn">InputStream</a></code>。在此代码段中，系统将文件行读取到一个字符串中：
</p>

<pre>private String readTextFromUri(Uri uri) throws IOException {
    InputStream inputStream = getContentResolver().openInputStream(uri);
    BufferedReader reader = new BufferedReader(new InputStreamReader(
            inputStream));
    StringBuilder stringBuilder = new StringBuilder();
    String line;
    while ((line = reader.readLine()) != null) {
        stringBuilder.append(line);
    }
    fileInputStream.close();
    parcelFileDescriptor.close();
    return stringBuilder.toString();
}
</pre>

<h3 id="create">创建新文档</h3>

<p>您的应用可以使用
<code><a href="https://developer.android.com/reference/android/content/Intent.html?hl=zh-cn#ACTION_CREATE_DOCUMENT">ACTION_CREATE_DOCUMENT</a></code>
 Intent 在文档提供程序中创建新文档。要想创建文件，请为您的 Intent 提供一个 MIME
类型和文件名，然后通过唯一的请求代码启动它。系统会为您执行其余操作：</p>


<pre>
// Here are some examples of how you might call this method.
// The first parameter is the MIME type, and the second parameter is the name
// of the file you are creating:
//
// createFile("text/plain", "foobar.txt");
// createFile("image/png", "mypicture.png");

// Unique request code.
private static final int WRITE_REQUEST_CODE = 43;
...
private void createFile(String mimeType, String fileName) {
    Intent intent = new Intent(Intent.ACTION_CREATE_DOCUMENT);

    // Filter to only show results that can be &quot;opened&quot;, such as
    // a file (as opposed to a list of contacts or timezones).
    intent.addCategory(Intent.CATEGORY_OPENABLE);

    // Create a file with the requested MIME type.
    intent.setType(mimeType);
    intent.putExtra(Intent.EXTRA_TITLE, fileName);
    startActivityForResult(intent, WRITE_REQUEST_CODE);
}
</pre>

<p>创建新文档后，即可在
<code><a href="https://developer.android.com/reference/android/app/Activity.html?hl=zh-cn#onActivityResult(int, int, android.content.Intent)">onActivityResult()</a></code> 中获取其
URI，以便继续向其写入内容。</p>

<h3 id="delete">删除文档</h3>

<p>如果您获得了文档的
URI，并且文档的
<code><a href="https://developer.android.com/reference/android/provider/DocumentsContract.Document.html?hl=zh-cn#COLUMN_FLAGS">Document.COLUMN_FLAGS</a></code>
包含
<code><a href="https://developer.android.com/reference/android/provider/DocumentsContract.Document.html?hl=zh-cn#FLAG_SUPPORTS_DELETE">SUPPORTS_DELETE</a></code>，便可以删除该文档。例如：</p>

<pre>
DocumentsContract.deleteDocument(getContentResolver(), uri);
</pre>

<h3 id="edit">编辑文档</h3>

<p>您可以使用 SAF
就地编辑文本文档。以下代码段会触发
<code><a href="https://developer.android.com/reference/android/content/Intent.html?hl=zh-cn#ACTION_OPEN_DOCUMENT">ACTION_OPEN_DOCUMENT</a></code>  Intent 
并使用类别 <code><a href="https://developer.android.com/reference/android/content/Intent.html?hl=zh-cn#CATEGORY_OPENABLE">CATEGORY_OPENABLE</a></code>
以仅显示可以打开的文档。它会进一步过滤以仅显示文本文件：</p>

<pre>
private static final int EDIT_REQUEST_CODE = 44;
/**
 * Open a file for writing and append some text to it.
 */
 private void editDocument() {
    // ACTION_OPEN_DOCUMENT is the intent to choose a file via the system's
    // file browser.
    Intent intent = new Intent(Intent.ACTION_OPEN_DOCUMENT);

    // Filter to only show results that can be &quot;opened&quot;, such as a
    // file (as opposed to a list of contacts or timezones).
    intent.addCategory(Intent.CATEGORY_OPENABLE);

    // Filter to show only text files.
    intent.setType(&quot;text/plain&quot;);

    startActivityForResult(intent, EDIT_REQUEST_CODE);
}
</pre>

<p>接下来，您可以从
<code><a href="https://developer.android.com/reference/android/app/Activity.html?hl=zh-cn#onActivityResult(int, int, android.content.Intent)">onActivityResult()</a></code>（请参阅<a href="#results">处理结果</a>）调用代码以执行编辑。以下代码段可从
<code><a href="https://developer.android.com/reference/android/content/ContentResolver.html?hl=zh-cn">ContentResolver</a></code> 获取
<code><a href="https://developer.android.com/reference/java/io/FileOutputStream.html?hl=zh-cn">FileOutputStream</a></code>。默认情况下，它使用“写入”模式。最佳做法是请求获得所需的最低限度访问权限，因此如果您只需要写入权限，就不要请求获得读取/写入权限。

</p>

<pre>private void alterDocument(Uri uri) {
    try {
        ParcelFileDescriptor pfd = getActivity().getContentResolver().
                openFileDescriptor(uri, "w");
        FileOutputStream fileOutputStream =
                new FileOutputStream(pfd.getFileDescriptor());
        fileOutputStream.write(("Overwritten by MyCloud at " +
                System.currentTimeMillis() + "\n").getBytes());
        // Let the document provider know you're done by closing the stream.
        fileOutputStream.close();
        pfd.close();
    } catch (FileNotFoundException e) {
        e.printStackTrace();
    } catch (IOException e) {
        e.printStackTrace();
    }
}</pre>

<h3 id="permissions">保留权限</h3>

<p>当您的应用打开文件进行读取或写入时，系统会为您的应用提供针对该文件的 URI 授权。
该授权将一直持续到用户设备重启时。但假定您的应用是图像编辑应用，而且您希望用户能够直接从应用中访问他们编辑的最后 5 张图像。

如果用户的设备已经重启，您就需要将用户转回系统选取器以查找这些文件，这显然不是理想的做法。

</p>

<p>为防止出现这种情况，您可以保留系统为您的应用授予的权限。
您的应用实际上是“获取”了系统提供的持久 URI 授权。
这使用户能够通过您的应用持续访问文件，即使设备已重启也不受影响：
</p>


<pre>final int takeFlags = intent.getFlags()
            &amp; (Intent.FLAG_GRANT_READ_URI_PERMISSION
            | Intent.FLAG_GRANT_WRITE_URI_PERMISSION);
// Check for the freshest data.
getContentResolver().takePersistableUriPermission(uri, takeFlags);</pre>

<p>还有最后一个步骤。您可能已经保存了应用最近访问的
URI，但它们可能不再有效 &mdash; 另一个应用可能已删除或修改了文档。
因此，您应该始终调用
<code>getContentResolver().takePersistableUriPermission()</code>
以检查有无最新数据。</p>

<h2 id="custom">编写自定义文档提供程序</h2>

<p>
如果您要开发为文件提供存储服务（如云保存服务）的应用，可以通过编写自定义文档提供程序，通过 SAF 提供您的文件。

本节描述如何执行此操作。
</p>


<h3 id="manifest">清单文件</h3>

<p>要想实现自定义文档提供程序，请将以下内容添加到您的应用的清单文件：
</p>
<ul>

<li>一个 API 级别 19 或更高级别的目标；</li>

<li>一个声明自定义存储提供程序的
<code>&lt;provider&gt;</code> 元素； </li>

<li>提供程序的名称（即其类名），包括软件包名称。例如：<code>com.example.android.storageprovider.MyCloudProvider</code>；
</li>

<li>授权的名称，即您的软件包名称（在本例中为
<code>com.example.android.storageprovider</code>）加内容提供程序的类型
(<code>documents</code>)。例如，<code>com.example.android.storageprovider.documents</code>。</li>

<li>属性 <code>android:exported</code> 设置为
<code>&quot;true&quot;</code>。您必须导出提供程序，以便其他应用可以看到；</li>

<li>属性 <code>android:grantUriPermissions</code> 设置为
<code>&quot;true&quot;</code>。此设置允许系统向其他应用授予对提供程序中内容的访问权限。
如需查看有关保留对特定文档授权的阐述，请参阅<a href="#permissions">保留权限</a>；
</li>

<li><code>MANAGE_DOCUMENTS</code> 权限。默认情况下，提供程序对所有人可用。
添加此权限将限定您的提供程序只能供系统使用。此限制具有重要的安全意义；
</li>

<li><code>android:enabled</code>
属性设置为在资源文件中定义的一个布尔值。此属性的用途是，在运行 Android 4.3 或更低版本的设备上停用提供程序。例如，<code>android:enabled=&quot;&#64;bool/atLeastKitKat&quot;</code>。
除了在清单文件中加入此属性外，您还需要执行以下操作；

<ul>
<li>在 <code>res/values/</code> 下的 <code>bool.xml</code> 资源文件中，添加以下行：
 <pre>&lt;bool name=&quot;atLeastKitKat&quot;&gt;false&lt;/bool&gt;</pre></li>

<li>在 <code>res/values-v19/</code> 下的 <code>bool.xml</code> 资源文件中，添加以下行：
 <pre>&lt;bool name=&quot;atLeastKitKat&quot;&gt;true&lt;/bool&gt;</pre></li>
</ul></li>

<li>一个包括 <code>android.content.action.DOCUMENTS_PROVIDER</code> 操作的 Intent 过滤器，以便在系统搜索提供程序时让您的提供程序出现在选取器中。

</li>

</ul>
<p>以下是从一个包括提供程序的示例清单文件中摘录的内容：</p>

<pre>&lt;manifest... &gt;
    ...
    &lt;uses-sdk
        android:minSdkVersion=&quot;19&quot;
        android:targetSdkVersion=&quot;19&quot; /&gt;
        ....
        &lt;provider
            android:name=&quot;com.example.android.storageprovider.MyCloudProvider&quot;
            android:authorities=&quot;com.example.android.storageprovider.documents&quot;
            android:grantUriPermissions=&quot;true&quot;
            android:exported=&quot;true&quot;
            android:permission=&quot;android.permission.MANAGE_DOCUMENTS&quot;
            android:enabled=&quot;&#64;bool/atLeastKitKat&quot;&gt;
            &lt;intent-filter&gt;
                &lt;action android:name=&quot;android.content.action.DOCUMENTS_PROVIDER&quot; /&gt;
            &lt;/intent-filter&gt;
        &lt;/provider&gt;
    &lt;/application&gt;

&lt;/manifest&gt;</pre>

<h4 id="43">支持运行 Android 4.3 及更低版本的设备</h4>

<p><code><a href="https://developer.android.com/reference/android/content/Intent.html?hl=zh-cn#ACTION_OPEN_DOCUMENT">ACTION_OPEN_DOCUMENT</a></code>
 Intent 仅可用于运行
Android 4.4 及更高版本的设备。如果您想让应用支持 <code><a href="https://developer.android.com/reference/android/content/Intent.html?hl=zh-cn#ACTION_GET_CONTENT">ACTION_GET_CONTENT</a></code>
以适应运行 Android 4.3
及更低版本的设备，则应在您的清单文件中为运行 Android 4.4
或更高版本的设备停用 <code><a href="https://developer.android.com/reference/android/content/Intent.html?hl=zh-cn#ACTION_GET_CONTENT">ACTION_GET_CONTENT</a></code> Intent 过滤器。
应将文档提供程序和
<code><a href="https://developer.android.com/reference/android/content/Intent.html?hl=zh-cn#ACTION_GET_CONTENT">ACTION_GET_CONTENT</a></code>
视为具有互斥性。如果您同时支持这两者，您的应用将在系统选取器 UI 中出现两次，提供两种不同的方式来访问您存储的数据。

这会给用户造成困惑。</p>

<p>建议按照以下步骤为运行 Android 4.4 版或更高版本的设备停用
<code><a href="https://developer.android.com/reference/android/content/Intent.html?hl=zh-cn#ACTION_GET_CONTENT">ACTION_GET_CONTENT</a></code> Intent 过滤器：
</p>

<ol>
<li>在 <code>res/values/</code> 下的 <code>bool.xml</code> 资源文件中，添加以下行：
 <pre>&lt;bool name=&quot;atMostJellyBeanMR2&quot;&gt;true&lt;/bool&gt;</pre></li>

<li>在 <code>res/values-v19/</code> 下的 <code>bool.xml</code> 资源文件中，添加以下行：
 <pre>&lt;bool name=&quot;atMostJellyBeanMR2&quot;&gt;false&lt;/bool&gt;</pre></li>

<li>添加一个 <a href="../manifest/activity-alias-element0b8e.html?hl=zh-cn">Activity 别名</a>，为
4.4 版（API 级别 19）或更高版本停用 <code><a href="https://developer.android.com/reference/android/content/Intent.html?hl=zh-cn#ACTION_GET_CONTENT">ACTION_GET_CONTENT</a></code>  Intent 
过滤器。
例如：

<pre>
&lt;!-- This activity alias is added so that GET_CONTENT intent-filter
     can be disabled for builds on API level 19 and higher. --&gt;
&lt;activity-alias android:name=&quot;com.android.example.app.MyPicker&quot;
        android:targetActivity=&quot;com.android.example.app.MyActivity&quot;
        ...
        android:enabled=&quot;@bool/atMostJellyBeanMR2&quot;&gt;
    &lt;intent-filter&gt;
        &lt;action android:name=&quot;android.intent.action.GET_CONTENT&quot; /&gt;
        &lt;category android:name=&quot;android.intent.category.OPENABLE&quot; /&gt;
        &lt;category android:name=&quot;android.intent.category.DEFAULT&quot; /&gt;
        &lt;data android:mimeType=&quot;image/*&quot; /&gt;
        &lt;data android:mimeType=&quot;video/*&quot; /&gt;
    &lt;/intent-filter&gt;
&lt;/activity-alias&gt;
</pre>
</li>
</ol>
<h3 id="contract">协定类</h3>

<p>通常，当您编写自定义内容提供程序时，其中一项任务是实现协定类，如<a href="content-provider-creating0b8e.html?hl=zh-cn#ContractClass">内容提供程序</a>开发者指南中所述。


协定类是一种 <code>public final</code> 类，它包含对 URI、列名称、MIME 类型以及其他与提供程序有关的元数据的常量定义。

SAF 会为您提供这些协定类，因此您无需自行编写：

</p>

<ul>
   <li><code><a href="https://developer.android.com/reference/android/provider/DocumentsContract.Document.html?hl=zh-cn">DocumentsContract.Document</a></code></li>
   <li><code><a href="https://developer.android.com/reference/android/provider/DocumentsContract.Root.html?hl=zh-cn">DocumentsContract.Root</a></code></li>
</ul>

<p>例如，当系统在您的文档提供程序中查询文档或根目录时，您可能会在游标中返回以下列：
</p>

<pre>private static final String[] DEFAULT_ROOT_PROJECTION =
        new String[]{Root.COLUMN_ROOT_ID, Root.COLUMN_MIME_TYPES,
        Root.COLUMN_FLAGS, Root.COLUMN_ICON, Root.COLUMN_TITLE,
        Root.COLUMN_SUMMARY, Root.COLUMN_DOCUMENT_ID,
        Root.COLUMN_AVAILABLE_BYTES,};
private static final String[] DEFAULT_DOCUMENT_PROJECTION = new
        String[]{Document.COLUMN_DOCUMENT_ID, Document.COLUMN_MIME_TYPE,
        Document.COLUMN_DISPLAY_NAME, Document.COLUMN_LAST_MODIFIED,
        Document.COLUMN_FLAGS, Document.COLUMN_SIZE,};
</pre>

<h3 id="subclass">为 DocumentsProvider 创建子类</h3>

<p>编写自定义文档提供程序的下一步是为抽象类
<code><a href="https://developer.android.com/reference/android/provider/DocumentsProvider.html?hl=zh-cn">DocumentsProvider</a></code> 创建子类。您至少需要实现以下方法：
</p>

<ul>
<li><code><a href="https://developer.android.com/reference/android/provider/DocumentsProvider.html?hl=zh-cn#queryRoots(java.lang.String[])">queryRoots()</a></code></li>

<li><code><a href="https://developer.android.com/reference/android/provider/DocumentsProvider.html?hl=zh-cn#queryChildDocuments(java.lang.String, java.lang.String[], android.os.Bundle)">queryChildDocuments()</a></code></li>

<li><code><a href="https://developer.android.com/reference/android/provider/DocumentsProvider.html?hl=zh-cn#queryDocument(java.lang.String, java.lang.String[])">queryDocument()</a></code></li>

<li><code><a href="https://developer.android.com/reference/android/provider/DocumentsProvider.html?hl=zh-cn#openDocument(java.lang.String, java.lang.String, android.os.CancellationSignal)">openDocument()</a></code></li>
</ul>

<p>这些只是您需要严格实现的方法，但您可能还想实现许多其他方法。
详情请参阅 <code><a href="https://developer.android.com/reference/android/provider/DocumentsProvider.html?hl=zh-cn">DocumentsProvider</a></code>。
</p>

<h4 id="queryRoots">实现 queryRoots</h4>

<p>您实现的 <code><a href="https://developer.android.com/reference/android/provider/DocumentsProvider.html?hl=zh-cn#queryRoots(java.lang.String[])">queryRoots()</a></code> 必须使用在 <code><a href="https://developer.android.com/reference/android/provider/DocumentsContract.Root.html?hl=zh-cn">DocumentsContract.Root</a></code> 中定义的列返回一个指向文档提供程序所有根目录的 <code><a href="https://developer.android.com/reference/android/database/Cursor.html?hl=zh-cn">Cursor</a></code>。

</p>

<p>在以下代码段中，<code>projection</code> 参数表示调用方想要返回的特定字段。
代码段会创建一个新游标，并为其添加一行 &mdash; 一个根目录，如
Downloads 或 Images 等顶层目录。
大多数提供程序只有一个根目录。有时您可能有多个根目录，例如，当您具有多个用户帐户时。
在这种情况下，只需再为游标添加一行。
</p>

<pre>
&#64;Override
public Cursor queryRoots(String[] projection) throws FileNotFoundException {

    // Create a cursor with either the requested fields, or the default
    // projection if "projection" is null.
    final MatrixCursor result =
            new MatrixCursor(resolveRootProjection(projection));

    // If user is not logged in, return an empty root cursor.  This removes our
    // provider from the list entirely.
    if (!isUserLoggedIn()) {
        return result;
    }

    // It's possible to have multiple roots (e.g. for multiple accounts in the
    // same app) -- just add multiple cursor rows.
    // Construct one row for a root called &quot;MyCloud&quot;.
    final MatrixCursor.RowBuilder row = result.newRow();
    row.add(Root.COLUMN_ROOT_ID, ROOT);
    row.add(Root.COLUMN_SUMMARY, getContext().getString(R.string.root_summary));

    // FLAG_SUPPORTS_CREATE means at least one directory under the root supports
    // creating documents. FLAG_SUPPORTS_RECENTS means your application's most
    // recently used documents will show up in the &quot;Recents&quot; category.
    // FLAG_SUPPORTS_SEARCH allows users to search all documents the application
    // shares.
    row.add(Root.COLUMN_FLAGS, Root.FLAG_SUPPORTS_CREATE |
            Root.FLAG_SUPPORTS_RECENTS |
            Root.FLAG_SUPPORTS_SEARCH);

    // COLUMN_TITLE is the root title (e.g. Gallery, Drive).
    row.add(Root.COLUMN_TITLE, getContext().getString(R.string.title));

    // This document id cannot change once it's shared.
    row.add(Root.COLUMN_DOCUMENT_ID, getDocIdForFile(mBaseDir));

    // The child MIME types are used to filter the roots and only present to the
    //  user roots that contain the desired type somewhere in their file hierarchy.
    row.add(Root.COLUMN_MIME_TYPES, getChildMimeTypes(mBaseDir));
    row.add(Root.COLUMN_AVAILABLE_BYTES, mBaseDir.getFreeSpace());
    row.add(Root.COLUMN_ICON, R.drawable.ic_launcher);

    return result;
}</pre>

<h4 id="queryChildDocuments">实现 queryChildDocuments</h4>

<p>您实现的 <code><a href="https://developer.android.com/reference/android/provider/DocumentsProvider.html?hl=zh-cn#queryChildDocuments(java.lang.String, java.lang.String[], android.os.Bundle)">queryChildDocuments()</a></code> 必须使用在
<code><a href="https://developer.android.com/reference/android/provider/DocumentsContract.Document.html?hl=zh-cn">DocumentsContract.Document</a></code> 中定义的列返回一个指向指定目录中所有文件的
<code><a href="https://developer.android.com/reference/android/database/Cursor.html?hl=zh-cn">Cursor</a></code>。

</p>

<p>当您在选取器 UI
中选择应用时，系统会调用此方法。它会获取根目录下某个目录内的子文档。可以在文件层次结构的任何级别调用此方法，并非只能从根目录调用。
以下代码段可创建一个包含所请求列的新游标，然后向游标添加父目录中每个直接子目录的相关信息。子目录可以是图像、另一个目录乃至任何文件：


</p>

<pre>&#64;Override
public Cursor queryChildDocuments(String parentDocumentId, String[] projection,
                              String sortOrder) throws FileNotFoundException {

    final MatrixCursor result = new
            MatrixCursor(resolveDocumentProjection(projection));
    final File parent = getFileForDocId(parentDocumentId);
    for (File file : parent.listFiles()) {
        // Adds the file's display name, MIME type, size, and so on.
        includeFile(result, null, file);
    }
    return result;
}
</pre>

<h4 id="queryDocument">实现 queryDocument</h4>

<p>您实现的 <code><a href="https://developer.android.com/reference/android/provider/DocumentsProvider.html?hl=zh-cn#queryDocument(java.lang.String, java.lang.String[])">queryDocument()</a></code> 必须使用在 <code><a href="https://developer.android.com/reference/android/provider/DocumentsContract.Document.html?hl=zh-cn">DocumentsContract.Document</a></code> 中定义的列返回一个指向指定文件的
<code><a href="https://developer.android.com/reference/android/database/Cursor.html?hl=zh-cn">Cursor</a></code>。


</p>

<p>除了特定文件的信息外，<code><a href="https://developer.android.com/reference/android/provider/DocumentsProvider.html?hl=zh-cn#queryDocument(java.lang.String, java.lang.String[])">queryDocument()</a></code>
方法返回的信息与
<code><a href="https://developer.android.com/reference/android/provider/DocumentsProvider.html?hl=zh-cn#queryChildDocuments(java.lang.String, java.lang.String[], android.os.Bundle)">queryChildDocuments()</a></code>
中传递的信息相同：</p>


<pre>&#64;Override
public Cursor queryDocument(String documentId, String[] projection) throws
        FileNotFoundException {

    // Create a cursor with the requested projection, or the default projection.
    final MatrixCursor result = new
            MatrixCursor(resolveDocumentProjection(projection));
    includeFile(result, documentId, null);
    return result;
}
</pre>

<h4 id="openDocument">实现 queryDocument</h4>

<p>您必须实现 <code><a href="https://developer.android.com/reference/android/provider/DocumentsProvider.html?hl=zh-cn#openDocument(java.lang.String, java.lang.String, android.os.CancellationSignal)">openDocument()</a></code> 以返回表示指定文件的
<code><a href="https://developer.android.com/reference/android/os/ParcelFileDescriptor.html?hl=zh-cn">ParcelFileDescriptor</a></code>。其他应用可以使用返回的 <code><a href="https://developer.android.com/reference/android/os/ParcelFileDescriptor.html?hl=zh-cn">ParcelFileDescriptor</a></code>
来流式传输数据。用户选择了文件，并且客户端应用通过调用
<code><a href="https://developer.android.com/reference/android/content/ContentResolver.html?hl=zh-cn#openFileDescriptor(android.net.Uri, java.lang.String)">openFileDescriptor()</a></code>
来请求对文件的访问权限后，系统便会调用此方法。例如：
</p>

<pre>&#64;Override
public ParcelFileDescriptor openDocument(final String documentId,
                                         final String mode,
                                         CancellationSignal signal) throws
        FileNotFoundException {
    Log.v(TAG, &quot;openDocument, mode: &quot; + mode);
    // It's OK to do network operations in this method to download the document,
    // as long as you periodically check the CancellationSignal. If you have an
    // extremely large file to transfer from the network, a better solution may
    // be pipes or sockets (see ParcelFileDescriptor for helper methods).

    final File file = getFileForDocId(documentId);

    final boolean isWrite = (mode.indexOf('w') != -1);
    if(isWrite) {
        // Attach a close listener if the document is opened in write mode.
        try {
            Handler handler = new Handler(getContext().getMainLooper());
            return ParcelFileDescriptor.open(file, accessMode, handler,
                        new ParcelFileDescriptor.OnCloseListener() {
                &#64;Override
                public void onClose(IOException e) {

                    // Update the file with the cloud server. The client is done
                    // writing.
                    Log.i(TAG, &quot;A file with id &quot; +
                    documentId + &quot; has been closed!
                    Time to &quot; +
                    &quot;update the server.&quot;);
                }

            });
        } catch (IOException e) {
            throw new FileNotFoundException(&quot;Failed to open document with id &quot;
            + documentId + &quot; and mode &quot; + mode);
        }
    } else {
        return ParcelFileDescriptor.open(file, accessMode);
    }
}
</pre>

<h3 id="security">安全性</h3>

<p>假设您的文档提供程序是受密码保护的云存储服务，并且您想在开始共享用户的文件之前确保其已登录。如果用户未登录，您的应用应该执行哪些操作呢？

解决方案是在您实现的
<code><a href="https://developer.android.com/reference/android/provider/DocumentsProvider.html?hl=zh-cn#queryRoots(java.lang.String[])">queryRoots()</a></code> 中返回零个根目录。也就是空的根目录游标：</p>

<pre>
public Cursor queryRoots(String[] projection) throws FileNotFoundException {
...
    // If user is not logged in, return an empty root cursor.  This removes our
    // provider from the list entirely.
    if (!isUserLoggedIn()) {
        return result;
}
</pre>

<p>另一个步骤是调用 <code>getContentResolver().notifyChange()</code>。还记得 <code><a href="https://developer.android.com/reference/android/provider/DocumentsContract.html?hl=zh-cn">DocumentsContract</a></code> 吗？
我们将使用它来创建此 URI。
以下代码段会在每次用户的登录状态发生变化时指示系统查询文档提供程序的根目录。
如果用户未登录，则调用
<code><a href="https://developer.android.com/reference/android/provider/DocumentsProvider.html?hl=zh-cn#queryRoots(java.lang.String[])">queryRoots()</a></code> 会返回一个空游标，如上文所示。
这可以确保只有在用户登录提供程序后其中的文档才可用。
</p>

<pre>private void onLoginButtonClick() {
    loginOrLogout();
    getContentResolver().notifyChange(DocumentsContract
            .buildRootsUri(AUTHORITY), null);
}
</pre>


    </div>

    

  
    
  
    



<div class="wrap">
  <footer class="dac-footer ">
    <div class="cols dac-footer-main">
      <div class="col-1of2">
        <div class="dac-footer-contact">
          <a class="dac-footer-contact-link" href="https://developer.android.com/newsletter/index.html?hl=zh-cn" title="Newsletter">Newsletter</a>
          <a class="dac-footer-contact-link" href="https://android-developers.blogspot.com/" title="博客" target="_blank">博客</a>
          <a class="dac-footer-contact-link" href="https://developer.android.com/support.html?hl=zh-cn" title="支持">支持</a>
        </div>
      </div>
      <div class="col-1of2 dac-footer-reachout">
        <div class="dac-footer-social">
          <a class="dac-button-social dac-youtube dac-footer-social-link" href="https://www.youtube.com/user/androiddevelopers" title="Android Developers on YouTube" target="_blank"><i class="dac-sprite dac-youtube"></i><span class="hide-text">Android Developers on YouTube</span></a>
          <a class="dac-button-social dac-gplus dac-footer-social-link" href="https://plus.google.com/+AndroidDevelopers" title="Android Developers on Google+" target="_blank"><i class="dac-sprite dac-gplus"></i><span class="hide-text">Android Developers on Google+</span></a>
          <a class="dac-button-social dac-twitter dac-footer-social-link" href="https://twitter.com/AndroidDev" title="Android Developers on Twitter" target="_blank"><i class="dac-sprite dac-twitter"></i><span class="hide-text">Android Developers on Twitter</span></a>
        </div>
      </div>
    </div>

    <hr class="dac-footer-separator"/>
      
      <p class="dac-footer-copyright">
        
        Except as noted, this content is licensed under <a href="http://creativecommons.org/licenses/by/2.5/" target="_blank">Creative Commons Attribution 2.5</a>. For details and restrictions, see the <a href="https://developer.android.com/license.html">Content License</a>.
      </p>
    

    <p class="dac-footer-links">
      <a href="https://www.android.com/" title="Android.com" target="_blank">Android.com</a>
      <a href="https://developer.android.com/?hl=zh-cn" title="Android Developers">Android Developers</a>
      <a href="https://developer.android.com/studio/index.html?hl=zh-cn" title="Android Studio">Android Studio</a>
      <a href="https://developer.android.com/distribute/console/index.html?hl=zh-cn" title="Google Play Console">Google Play Console</a>
      <a href="https://developer.android.com/legal.html?hl=zh-cn" title="Legal Notice">Legal Notice</a>
    </p>

    <!-- TODO(akassay) Update all DAC js to use the class instead of the id b/30368561 -->
    <form class="devsite-utility-footer-language" id="setlang" action="https://developer.android.com/i18n/setlang/" method="post">
      <input type="hidden" name="xsrf_token" value="zDzef7sygpxjgWumRdWHdBql9QWf3MwdOjbnorvHXfc6MTQ5NzUxNjk5NDU2NDQxMA" />
      <input type="hidden" name="next" value="document-provider.html">
      <span id="language" class="locales">
        <select class="devsite-utility-footer-language-select" name="language">
          
          <option value="id"
            >
            Bahasa Indonesia
          </option>
          
          <option value="de"
            >
            Deutsch
          </option>
          
          <option value="en"
            >
            English
          </option>
          
          <option value="es"
            >
            español
          </option>
          
          <option value="es-419"
            >
            Español (América Latina)
          </option>
          
          <option value="fr"
            >
            français
          </option>
          
          <option value="pt-br"
            >
            Português Brasileiro
          </option>
          
          <option value="vi"
            >
            Tiếng Việt
          </option>
          
          <option value="tr"
            >
            Türkçe
          </option>
          
          <option value="ru"
            >
            Русский
          </option>
          
          <option value="th"
            >
            ภาษาไทย
          </option>
          
          <option value="ja"
            >
            日本語
          </option>
          
          <option value="zh-cn"
             selected="selected" >
            简体中文
          </option>
          
          <option value="zh-tw"
            >
            繁體中文
          </option>
          
          <option value="ko"
            >
            한국어
          </option>
          
        </select>
      </span>
    </form>
  </footer>
</div><!--/.wrap -->

<div class="dac-toast-group">
  <div class="dac-toast" data-toast>
    <div class="dac-toast-wrap">
      This site uses cookies to store your preferences for site-specific language and display options.
    </div>
  </div>
</div>

<div data-modal="newsletter" data-newsletter-fb data-swap class="dac-modal newsletter">
  <div class="dac-modal-container">
    <div class="dac-modal-window">
      <header class="dac-modal-header">
        <div class="dac-modal-header-actions">
          <button class="dac-modal-header-close" data-modal-toggle></button>
        </div>
        <div class="dac-swap" data-swap-container>
          <section class="dac-swap-section dac-active dac-down">
            <h2 class="norule dac-modal-header-title" data-t="newsletter.title">Get the latest Android developer news and tips that will help you find success on Google Play.</h2>
            <p class="dac-modal-header-subtitle" data-t="newsletter.requiredHint">* Required Fields</p>
          </section>
          <section class="dac-swap-section dac-up">
            
            <h2 class="norule dac-modal-header-title" data-t="newsletter.successTitle">Hooray!</h2>
          </section>
        </div>
      </header>
      <div class="dac-swap" data-swap-container>
        <section class="dac-swap-section dac-active dac-left">
          <form action="https://services.google.com/fb/submissions/android-developer-mailing-list/" class="dac-form" method="post">
            <section class="dac-modal-content">
              <fieldset class="dac-form-fieldset">
                <div class="cols">
                  <div class="col-1of2 newsletter-leftCol">
                    <div class="dac-form-input-group">
                      <label for="newsletter-full-name" class="dac-form-floatlabel" data-t="newsletter.name">Full name</label>
                      <input type="text" class="dac-form-input" name="fullname" id="newsletter-full-name" required>
                      <span class="dac-form-required">*</span>
                    </div>
                    <div class="dac-form-input-group">
                      <label for="newsletter-email" class="dac-form-floatlabel" data-t="newsletter.email">Email 地址</label>
                      <input type="email" class="dac-form-input" name="emailaddress" id="newsletter-email" required>
                      <span class="dac-form-required">*</span>
                    </div>
                  </div>
                  <div class="col-1of2 newsletter-rightCol">
                    <div class="dac-form-input-group">
                      <label for="newsletter-company" class="dac-form-floatlabel" data-t="newsletter.company">Company / developer name</label>
                      <input type="text" class="dac-form-input" name="companydevelopername" id="newsletter-company">
                    </div>
                    <div class="dac-form-input-group">
                      <label for="newsletter-play-store" class="dac-form-floatlabel" data-t="newsletter.appUrl">One of your Play Store app URLs</label>
                      <input type="url" class="dac-form-input" name="playstoreappurls" id="newsletter-play-store">
                    </div>
                  </div>
                </div>
              </fieldset>
              <fieldset class="dac-form-fieldset">
                <div class="cols">
                  <div class="col-1of2 newsletter-leftCol newsletter-interested" data-validation-message="Please check at least one item.">
                    <legend class="dac-form-legend">What are you interested in?<span class="dac-form-required">*</span></legend>
                    <div class="dac-form-radio-group">
                      <input type="checkbox" class="dac-form-checkbox" name="interested" id="interested-whats-new" value="whats-new">
                      <label for="interested-whats-new" class="dac-form-checkbox-button"></label>
                      <label for="interested-whats-new" class="dac-form-label">What's new</label>
                    </div>
                    <div class="dac-form-radio-group">
                      <input type="checkbox" class="dac-form-checkbox" name="interested" id="interested-games-updates" value="games-updates">
                      <label for="interested-games-updates" class="dac-form-checkbox-button"></label>
                      <label for="interested-games-updates" class="dac-form-label">Games updates</label>
                    </div>
                    <div class="dac-form-radio-group">
                      <input type="checkbox" class="dac-form-checkbox" name="interested" id="interested-android-development" value="android-development">
                      <label for="interested-android-development" class="dac-form-checkbox-button"></label>
                      <label for="interested-android-development" class="dac-form-label">Android development</label>
                    </div>
                  </div>
                  <div class="col-1of2 newsletter-rightCol newsletter-checkboxes">
                    <div class="dac-form-input-group">
                      <label for="newsletter-receive-in">Receive newsletter in</label>
                      <select name="language" class="dac-form-select" id="newsletter-receive-in">
                        <option value="en-US" selected>English</option>
                        <option value="ar">Arabic</option>
                        <option value="zh">Chinese (Simplified)</option>
                        <option value="zh-TW">Chinese (Traditional)</option>
                        <option value="fr">French</option>
                        <option value="de">German</option>
                        <option value="id">Indonesian (Bahasa)</option>
                        <option value="ja">Japanese</option>
                        <option value="ko">Korean</option>
                        <option value="pt-BR">Portuguese (Brazilian)</option>
                        <option value="ru">Russian</option>
                        <option value="es-419">Spanish (Latin American)</option>
                        <option value="th">Thai</option>
                        <option value="tr">Turkish</option>
                        <option value="vi">Vietnamese</option>
                      </select>
                    </div>
                    <div class="dac-form-radio-group">
                      <div class="dac-media">
                        <div class="dac-media-figure">
                          <input type="checkbox" class="dac-form-checkbox" name="marketingoptin" id="newsletter-add" required value="Add me to the mailing list.">
                          <label for="newsletter-add" class="dac-form-checkbox-button"></label>
                        </div>
                        <div class="dac-media-body">
                          <label for="newsletter-add" class="dac-form-label dac-form-aside">
                            Add me to the mailing list.
                            <span class="dac-form-required">*</span>
                          </label>
                        </div>
                      </div>
                    </div>
                    <div class="dac-form-radio-group">
                      <div class="dac-media">
                        <div class="dac-media-figure">
                          <input type="checkbox" class="dac-form-checkbox" name="privacystatement" id="newsletter-terms" required value="I acknowledge that the information provided in this form will be subject to Google's privacy policy (https://www.google.com/policies/privacy/).">
                          <label for="newsletter-terms" class="dac-form-checkbox-button"></label>
                        </div>
                        <div class="dac-media-body">
                          <label for="newsletter-terms" class="dac-form-label dac-form-aside"><span data-t="newsletter.privacyPolicy" data-t-html>
                            
                            I acknowledge that the information provided in this form will be subject to <a href="https://www.google.com/policies/privacy/">Google's privacy policy</a>.
                          </span>
                          <span class="dac-form-required">*</span></label>
                        </div>
                      </div>
                    </div>
                  </div>
                </div>
              </fieldset>
            </section>
            <input type="hidden" name="referrer" value="dac">
            <footer class="dac-modal-footer">
              <div class="cols">
                <div class="col-2of5">
                </div>
              </div>
              <button type="submit" value="Submit" class="dac-fab dac-primary dac-large dac-modal-action"><i class="dac-sprite dac-arrow-right"></i></button>
            </footer>
          </form>
        </section>
        <section class="dac-swap-section dac-right">
          <div class="dac-modal-content">
            <p class="newsletter-success-message" data-t="newsletter.successDetails">
              You have successfully signed up for the latest Android developer news and tips.
            </p>
          </div>
        </section>
      </div>
    </div>
  </div>
</div><!--/.dac-modal.newsletter-->


<div data-modal="langform" class="dac-modal" id="langform">
  <div class="dac-modal-container">
    <div class="dac-modal-window">
      <header class="dac-modal-header">
        <div class="dac-modal-header-actions">
          <button class="dac-modal-header-close" data-modal-toggle></button>
        </div>
        <section class="dac-swap-section dac-active dac-down">
          <h2 class="norule dac-modal-header-title">
            Browse this site in <span class="span-target-lang"></span>?
          </h2>
        </section>
      </header>
      <section class="dac-swap-section dac-active dac-left">
          <section class="dac-modal-content">
            <fieldset class="dac-form-fieldset">
              <div class="cols">
                <div class="col-2of2 langform-leftCol">
                  <p id="resetLangText">
                    You requested a page in <span class="span-target-lang"></span>, but your language preference for this site is <span class="span-current-lang"></span>.
                  </p>
                  <p id="resetLangCta">
                    Would you like to change your language preference and browse this site in <span class="span-target-lang"></span>? If you want to change your language preference later, use the language menu at the bottom of each page.
                  </p>
                </div>
              </div>
            </fieldset>
          </section>
          <footer class="dac-modal-footer" id="langfooter">
            <div class="cols">
              <div class="col-2of5">
              </div>
            </div>
            <a href="#" class="yes" onclick="return false;">
              <button class="button dac-primary dac-modal-action lang yes" data-t="newsletter.resetLangButtonYes" data-modal-toggle>
                Change Language
              </button>
            </a>
            <a href="#" class="" onclick="return false;">
              <button class="button dac-primary dac-modal-action lang no" data-t="newsletter.resetLangButtonNo" data-modal-toggle>
                Not Now
              </button>
            </a>
          </footer>
        </form>
      </section>
    </div>
  </div>
</div><!--/.dac-modal-->


<div data-modal="api-unavailable" class="dac-modal" id="api-unavailable">
  <div class="dac-modal-container">
    <div class="dac-modal-window">
      <header class="dac-modal-header">
        <div class="dac-modal-header-actions">
          <button class="dac-modal-header-close" data-modal-toggle></button>
        </div>
        <section class="dac-swap-section dac-active dac-down">
          <h2 class="norule dac-modal-header-title">
            This class requires API level <span class="api-level"></span> or higher
          </h2>
        </section>
      </header>
      <section class="dac-swap-section dac-active dac-left">
          <section class="dac-modal-content">
            <p>
              This doc is hidden because your selected API level for the documentation is <span class="api-level"></span>. You can change the documentation API level with the selector above the left navigation.
            </p>
            
            <p>For more information about specifying the API level your app requires, read <a href="https://developer.android.com/training/basics/supporting-devices/platforms.html">Supporting Different Platform Versions</a>.</p>
          </section>
          <footer class="dac-modal-footer" id="langfooter">
            <div class="cols">
              <div class="col-2of5">
              </div>
            </div>
            <a href="#" class="ok" onclick="return false;">
              <button class="button dac-primary dac-modal-action ok"
              data-modal-toggle>
                OK, make this page visible
              </button>
            </a>
          </footer>
        </form>
      </section>
    </div>
  </div>
</div><!--/.dac-modal#api-unavailable-->

    
  </div><!--/#body-content-->

  <!-- Nav Setup -->
  <script>$('[data-dac-nav]').dacNav();</script>
  <script type="text/javascript">
    $('.slideshow-container').dacSlideshow({
        btnPrev: '.slideshow-prev',
        btnNext: '.slideshow-next',
        btnPause: '#pauseButton'
    });

    $(".feed").dacTabbedList({
      nav_id: '.feed-nav',
      frame_id: '.feed-frame'
    });
  </script>
  
  <script src="../../../ytblogger_lists_unified414d.js?hl=zh-cn?v=2017061508" defer></script>
  <script src="../../../android_metadata_en414d.js?hl=zh-cn?v=2017061508" defer></script>
  
  <script src="../../../reference/lists414d.js?hl=zh-cn?v=2017061508" defer></script>
  <script src="../../../reference/gms_lists414d.js?hl=zh-cn?v=2017061508" defer></script>
  <script src="../../../reference/android/support/wearable/lists414d.js?hl=zh-cn?v=2017061508" defer></script>
  <script src="../../../reference/android/support/test/lists414d.js?hl=zh-cn?v=2017061508" defer></script>
  <script src="../../../reference/android/support/constraint/lists414d.js?hl=zh-cn?v=2017061508" defer></script>
  <script src="https://developer.android.com/_static2/f304fc21fa/jsi18n/?hl=zh-cn"></script>
  <script>
    // Load localized metadata.
    (function(lang) {
      if (lang === 'en') { return; }
      document.write('<script src="https://developer.android.com/android_metadata_zh-cn.js?hl=zh-cn?v=2017061508" defer></' + 'script>');
    })(getLangPref())

    // Add skip to content for accessibility.
    $('#skip-to-main').click(function() {
      $('a[name=top]').focus();
    });

    $('.devsite-utility-footer-language-select').each(function() {
      $(this).change(function() {
        changeLangPref(this.value, true)
        $('.devsite-utility-footer-language').submit();
      });
    });
  </script>

  <script>
    (function($) {
      devsite.analytics.InitAnalytics();
    })(jQuery);
  </script>

  


<div id="survey-box-wrapper">
  <div class="material-dialog" style="width:270px">
    <div class="material-dialog-title">
      Take a one-minute survey?
    </div>
    <div class="material-dialog-description">
      Help us improve Android tools and documentation.
    </div>
    <div class="material-button-bar">
      <a class="dac-button dac-primary dac-raised" target="_blank"
          href="https://goo.gl/forms/kV7MoyD2dvcWkd5N2">Sure</a>
      <a class="dac-button" href="#">No thanks</a>
    </div>
  </div>
</div>

</body>

<!-- Mirrored from developer.android.com/guide/topics/providers/document-provider.html?hl=zh-cn by HTTrack Website Copier/3.x [XR&CO'2014], Thu, 15 Jun 2017 09:14:39 GMT -->
</html>
