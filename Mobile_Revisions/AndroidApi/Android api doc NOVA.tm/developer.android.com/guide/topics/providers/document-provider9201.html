





<!DOCTYPE html>
<html lang="ru">

<!-- Mirrored from developer.android.com/guide/topics/providers/document-provider.html?hl=ru by HTTrack Website Copier/3.x [XR&CO'2014], Thu, 15 Jun 2017 09:06:46 GMT -->
<!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=utf-8" /><!-- /Added by HTTrack -->
<head>

  



<meta name="viewport" content="width=device-width,initial-scale=1.0,minimum-scale=1.0,maximum-scale=1.0,user-scalable=no">
<meta content="IE=edge" http-equiv="X-UA-Compatible">





<script>var a=window.devsite||{};window.devsite=a;a.readyCallbacks=[];window.devsite.readyCallbacks=a.readyCallbacks;a.ready=function(b){a.readyCallbacks.push(b)};window.devsite.ready=a.ready;
</script>

<meta charset="utf-8">



<meta name="xsrf_token" content="vshpW1OWsiGiMJjoSsiIbiN8XSQyC_9eecikNrm38eA6MTQ5NzUxNjM0NTkyOTEyMA" />

  
    <link rel="canonical" href="document-provider9201.html?hl=ru">
  

  
    <link rel="alternate" href="document-provider7554.html?hl=es-419" hreflang="es-419">
  
    <link rel="alternate" href="document-provider.html" hreflang="en">
  
    <link rel="alternate" href="document-provider9e29.html?hl=ja" hreflang="ja">
  
    <link rel="alternate" href="document-provider9201.html?hl=ru" hreflang="ru">
  
    <link rel="alternate" href="document-provider327f.html?hl=vi" hreflang="vi">
  
    <link rel="alternate" href="document-provider0b8e.html?hl=zh-cn" hreflang="zh-Hans">
  
    <link rel="alternate" href="document-providerde3a.html?hl=es" hreflang="es">
  
    <link rel="alternate" href="document-providerf854.html?hl=zh-tw" hreflang="zh-Hant">
  
    <link rel="alternate" href="document-provider6dd3.html?hl=pt-br" hreflang="pt-br">
  
    <link rel="alternate" href="document-provider0cf2.html?hl=id" hreflang="id">
  
    <link rel="alternate" href="document-provider232e.html?hl=ko" hreflang="ko">
  
    <link rel="alternate" href="https://developer.android.google.cn/guide/topics/providers/document-provider.html?hl=es-419" hreflang="es-419-cn">
  
    <link rel="alternate" href="https://developer.android.google.cn/guide/topics/providers/document-provider.html" hreflang="en-cn">
  
    <link rel="alternate" href="https://developer.android.google.cn/guide/topics/providers/document-provider.html?hl=ja" hreflang="ja-cn">
  
    <link rel="alternate" href="https://developer.android.google.cn/guide/topics/providers/document-provider.html?hl=ru" hreflang="ru-cn">
  
    <link rel="alternate" href="https://developer.android.google.cn/guide/topics/providers/document-provider.html?hl=vi" hreflang="vi-cn">
  
    <link rel="alternate" href="https://developer.android.google.cn/guide/topics/providers/document-provider.html?hl=zh-cn" hreflang="zh-Hans-cn">
  
    <link rel="alternate" href="https://developer.android.google.cn/guide/topics/providers/document-provider.html?hl=es" hreflang="es-cn">
  
    <link rel="alternate" href="https://developer.android.google.cn/guide/topics/providers/document-provider.html?hl=zh-tw" hreflang="zh-Hant-cn">
  
    <link rel="alternate" href="https://developer.android.google.cn/guide/topics/providers/document-provider.html?hl=pt-br" hreflang="pt-br-cn">
  
    <link rel="alternate" href="https://developer.android.google.cn/guide/topics/providers/document-provider.html?hl=id" hreflang="id-cn">
  
    <link rel="alternate" href="https://developer.android.google.cn/guide/topics/providers/document-provider.html?hl=ko" hreflang="ko-cn">
  

  <link rel="alternate" href="document-provider.html" hreflang="x-default">




<link rel="shortcut icon" href="../../../_static/f304fc21fa/images/android/favicon9201.png?hl=ru">

<link rel="apple-touch-icon" href="../../../_static/f304fc21fa/images/android/touchicon-1809201.png?hl=ru">


<title>

  Платформа доступа к хранилищу (Storage Access Framework) | Android Developers

</title>

  <meta name="description" content="Платформа доступа к хранилищу (Storage Access Framework, SAF) впервые появилась в Android версии 4.4 (API уровня 19). Платформа SAF облегчает пользователям поиск и открытие документов, изображений и других файлов в хранилищах всех поставщиков, с которыми…">


<!-- STYLESHEETS -->
<link rel="stylesheet" href="http://fonts.googleapis.com/css?family=Roboto+Condensed">
<link rel="stylesheet"
    href="http://fonts.googleapis.com/css?family=Roboto:light,regular,medium,thin,italic,mediumitalic,bold"
    title="roboto">







<link href="../../../static/css/default05ec.css?hl=ru?v=2017061508" rel="stylesheet" type="text/css">
<!-- JAVASCRIPT -->
<script src="../../../_static/f304fc21fa/js/android_3p-bundle9201.js?hl=ru" type="text/javascript"></script>
<script src="../../../_static/f304fc21fa/js/script_foot_closure_android__ru9201.js?hl=ru"></script>
<script src="../../../_static/f304fc21fa/js/script_foot_android9201.js?hl=ru"></script>

<script type="text/javascript">
  var toRoot = 'https://developer.android.com/';
  devsite.permissions.init({"039e5d84b87fd75807ffb37b7f1bbf2c": true, "098dafe57affddc137df300142652cfd": false, "cb025a64a50094835616312f4774a53d": true, "51470233c56fc1fde50f00b73c52b216": false, "752953480de00a336d911a46966cc16d": false, "700def1a83e356c06c0925afb05de4b0": false, "6749dcb526ce9bde6993550c7d928d24": true});

  var replaceBlog = false;
  var replaceYouTube = false;
  var siteDefaultLocale = 'en';

  var ANDROID_LANGUAGES = [
      'id','de','en','es','es-419','fr','pt-br','vi','tr','ru','th','ja','zh-cn','zh-tw','ko'
  ];
</script>
<script src="../../../static/js/docs05ec.js?hl=ru?v=2017061508" type="text/javascript"></script>


</head>

<body class="gc-documentation
            
            
              develop
              guide
            
            "
      itemscope itemtype="http://schema.org/Article">
  


  
    <input class="google-analytics-id-json" type="hidden" value="{&quot;dimensions&quot;: {&quot;dimension6&quot;: &quot;ru&quot;, &quot;dimension4&quot;: &quot;API Guides&quot;, &quot;dimension5&quot;: &quot;ru&quot;, &quot;dimension3&quot;: false, &quot;dimension1&quot;: &quot;Signed out&quot;, &quot;dimension8&quot;: null}, &quot;gaid&quot;: &quot;UA-49880327-2&quot;}">
  
    <input class="google-analytics-id-json" type="hidden" value="{&quot;dimensions&quot;: {&quot;dimension6&quot;: &quot;ru&quot;, &quot;dimension4&quot;: &quot;API Guides&quot;, &quot;dimension5&quot;: &quot;ru&quot;, &quot;dimension3&quot;: false, &quot;dimension1&quot;: &quot;Signed out&quot;, &quot;dimension8&quot;: null}, &quot;gaid&quot;: &quot;UA-5831155-1&quot;}">
  



  
  
    <script>
      var dataLayer = [{"freeTrialEligibleUser": "False", "userCountry": "BE", "language": {"requested": "ru", "served": "ru"}, "projectName": "API Guides", "scriptsafe": null, "signedIn": "False", "internalUser": "False"}];
    </script>
  



  
  <a href="#top" id="skip-to-main">Skip to content</a>
  <header id="header-wrapper">
    <div class="dac-header" id="header">
      <div class="dac-header-inner">
        <a class="dac-nav-toggle" data-dac-toggle-nav href="#" title="Open navigation">
          <span class="dac-nav-hamburger">
            <span class="dac-nav-hamburger-top"></span>
            <span class="dac-nav-hamburger-mid"></span>
            <span class="dac-nav-hamburger-bot"></span>
          </span>
        </a>
        
        <a class="dac-header-logo" href="https://developer.android.com/index.html?hl=ru">
          <img class="dac-header-logo-image" src="../../../static/images/android_logo9201.png?hl=ru"
              srcset="https://developer.android.com/static/images/android_logo_2x.png 2x?hl=ru"
              width="32" height="36" alt="Android"> Developers</a>
        <ul class="dac-header-tabs">
          <li>
            <a class="dac-header-tab" href="https://developer.android.com/design/index.html?hl=ru"
               zh-tw-lang="設計"
               zh-cn-lang="设计"
               ru-lang="Проектирование"
               ko-lang="디자인"
               ja-lang="設計"
               es-lang="Diseñar">Design</a>
          </li>
          <li>
            <a class="dac-header-tab" href="https://developer.android.com/develop/index.html?hl=ru"
               zh-tw-lang="開發"
               zh-cn-lang="开发"
               ru-lang="Разработка"
               ko-lang="개발"
               ja-lang="開発"
               es-lang="Desarrollar">Develop</a>
          </li>
          <li>
            <a class="dac-header-tab" href="https://developer.android.com/distribute/index.html?hl=ru"
               zh-tw-lang="發佈"
               zh-cn-lang="分发"
               ru-lang="Распространение"
               ko-lang="배포"
               ja-lang="配布"
               es-lang="Distribuir">Distribute</a>
          </li>
        </ul>


        

        <a class="dac-header-console-btn gc-analytics-event" href="https://play.google.com/apps/publish/"
           data-category="User" data-action="Console" data-label="Clicked">
          <img src="https://developer.android.com/static/images/developer-console-icon.svg?hl=ru" width="18" height="19" alt="Play Console">Play Console</a>

        

<form data-search="" class="dac-header-search">
  <button class="dac-header-search-close" data-search-close="">
    <i class="dac-sprite dac-back-arrow"></i>
  </button>

  <div class="dac-header-search-inner">
    <i class="dac-sprite dac-search-white dac-header-search-icon"></i>
    
    <input id="search_autocomplete" type="text" value="" autocomplete="off" name="q" class="dac-header-search-input" placeholder="Поиск">
    <button class="dac-header-search-clear dac-hidden" data-search-clear="">
      <i class="dac-sprite dac-close-black"></i>
    </button>
  </div>
</form>

        
      </div><!--/.header-wrap.wrap-->
    </div><!--/.header-->

    

<div id="search-results" class="dac-search-results">
  <div id="dac-search-results-history" class="dac-search-results-history">
    <div class="wrap dac-search-results-history-wrap">
      <div class="cols">
        <div class="col-1of2 col-tablet-1of2 col-mobile-1of1">
          <h2>Most visited</h2>
          <div class="resource-flow-layout" data-history-query="history:most/visited" data-maxresults="3" data-cardsizes="18x2"></div>
        </div>

        <div class="col-1of2 col-tablet-1of2 col-mobile-1of1">
          <h2>Recently visited</h2>
          <div class="resource-flow-layout cols" data-history-query="history:recent" data-allow-duplicates="true" data-maxresults="3" data-cardsizes="18x2"></div>
        </div>
      </div>
    </div>
  </div>

  <div id="dac-search-results-content" class="dac-search-results-content">
    <div class="dac-search-results-metadata wrap">
      <div class="dac-search-results-for">
        
          <h2>
          Results for <span id="search-results-for"></span>
          </h2>
      </div>

      <div id="dac-search-results-hero"></div>

      <div class="dac-search-results-hero cols">
        <div id="dac-search-results-reference" class="col-6of6 col-tablet-2of2 col-mobile-1of1">
          <div class="suggest-card reference no-display">
            <ul class="dac-search-results-reference">
            </ul>
          </div>
        </div>
      </div>

      <div class="cols dac-search-results-cse">
        <script src="../../../../cse.google.com/f4116.txt?cx=000521750095050289010:zpcpi1ea4s8" async></script>
        <gcse:searchresults-only linkTarget="_self"></gcse:searchresults-only>
      </div>
    </div>
  </div>
</div>

  </header>

  <a name="navigation" tabindex=0 class="nav-start-marker">navigation</a>
  <nav class="dac-nav">
    <div class="dac-nav-dimmer" data-dac-toggle-nav></div>
    <div class="dac-nav-sidebar" data-swap data-dynamic="false" data-transition-speed="300" data-dac-nav>
      <div data-swap-container>
        
        <a class="dac-nav-back-button dac-swap-section dac-up dac-no-anim" tabindex=0 data-swap-button>
          
          <i class="dac-sprite dac-nav-back"></i> <span class="dac-nav-back-title">Назад</span>
        </a>

        <div class="dac-nav-sub dac-swap-section dac-right dac-active" itemscope
            itemtype="http://schema.org/SiteNavigationElement">
          
          
            
            <ul id="nav">
              <li class="nav-section"><div class="nav-section-header"><a href="../../index9201.html?hl=ru" >Introduction</a><span class="toggle-icon" tabindex="0"></span></div><ul><li><a href="../../components/fundamentals9201.html?hl=ru" >App Fundamentals</a></li><li><a href="../../practices/compatibility9201.html?hl=ru" >Device Compatibility</a></li><li class="nav-section"><div class="nav-section-header"><a href="../permissions/index9201.html?hl=ru" >System Permissions</a><span class="toggle-icon" tabindex="0"></span></div><ul><li><a href="../permissions/requesting9201.html?hl=ru" >Requesting Permissions</a></li><li><a href="../permissions/defining9201.html?hl=ru" >Defining Permissions</a></li></ul></li></ul></li><li class="nav-section"><div class="nav-section-header"><a href="../../platform/index9201.html?hl=ru" >Platform Architecture</a><span class="toggle-icon" tabindex="0"></span></div><ul><li><a href="../../platform/j8-jack9201.html?hl=ru"  es-lang="Funciones del lenguaje Java 8" in-lang="Fitur Bahasa Java 8" ja-lang="Java 8 の機能" ko-lang="Java 8 언어 기능" pt-br-lang="Recursos de linguagem do Java 8" ru-lang="Возможности языка Java 8" vi-lang="Tính năng của Ngôn ngữ Java 8" zh-cn-lang="Java 8 语言功能" zh-tw-lang="Java 8 語言功能">Use Java 8 Language Features</a></li><li><a href="../../practices/verifying-apps-art9201.html?hl=ru" >Verifying App Behavior on the Android Runtime (ART)</a></li></ul></li><li class="nav-section"><div class="nav-section-header"><a href="../../components/index9201.html?hl=ru" >App Components</a><span class="toggle-icon" tabindex="0"></span></div><ul><li class="nav-section"><div class="nav-section-header"><a href="../../components/intents-filters9201.html?hl=ru" >Intents and Intent Filters</a><span class="toggle-icon" tabindex="0"></span></div><ul><li><a href="../../components/intents-common9201.html?hl=ru" >Common Intents</a></li></ul></li><li class="nav-section"><div class="nav-section-header"><a href="../../components/activities/index9201.html?hl=ru" >Activities</a><span class="toggle-icon" tabindex="0"></span></div><ul><li><a href="../../components/activities/intro-activities9201.html?hl=ru" >Introduction to Activities</a></li><li><a href="../../components/activities/activity-lifecycle9201.html?hl=ru" >The Activity Lifecycle</a></li><li><a href="../../components/activities/state-changes9201.html?hl=ru" >Activity State Changes</a></li><li><a href="../../components/activities/tasks-and-back-stack9201.html?hl=ru" >Tasks and Back Stack</a></li><li><a href="../../components/activities/process-lifecycle9201.html?hl=ru" >Processes and Application Lifecycle</a></li><li><a href="../../components/activities/parcelables-and-bundles9201.html?hl=ru" >Parcelables and Bundles</a></li><li><a href="../../components/activities/recents9201.html?hl=ru" >Recents Screen</a></li></ul></li><li><a href="../../components/fragments9201.html?hl=ru" >Fragments</a></li><li><a href="../../components/loaders9201.html?hl=ru" >Loaders</a></li><li class="nav-section"><div class="nav-section-header"><a href="../../components/services9201.html?hl=ru" >Services</a><span class="toggle-icon" tabindex="0"></span></div><ul><li><a href="../../components/bound-services9201.html?hl=ru" >Bound Services</a></li><li><a href="../../components/aidl9201.html?hl=ru" >AIDL</a></li></ul></li><li class="nav-section"><div class="nav-section-header"><a href="content-providers9201.html?hl=ru" >Content Providers</a><span class="toggle-icon" tabindex="0"></span></div><ul><li><a href="content-provider-basics9201.html?hl=ru" >Content Provider Basics</a></li><li><a href="content-provider-creating9201.html?hl=ru" >Creating a Content Provider</a></li><li><a href="calendar-provider9201.html?hl=ru" >Calendar Provider</a></li><li><a href="contacts-provider9201.html?hl=ru" >Contacts Provider</a></li><li><a href="document-provider9201.html?hl=ru" >Open files using Storage Access Framework</a></li><li><a href="create-document-provider9201.html?hl=ru" >Create a Custom Document Provider</a></li></ul></li><li><a href="../../components/broadcasts9201.html?hl=ru" >Broadcasts</a></li><li class="nav-section"><div class="nav-section-header"><a href="../appwidgets/index9201.html?hl=ru" >App Widgets</a><span class="toggle-icon" tabindex="0"></span></div><ul><li><a href="../appwidgets/host9201.html?hl=ru" >App Widget Host</a></li></ul></li><li><a href="../../components/processes-and-threads9201.html?hl=ru" >Processes and Threads</a></li></ul></li><li class="nav-section"><div class="nav-section-header"><a href="../resources/index9201.html?hl=ru" >App Resources</a><span class="toggle-icon" tabindex="0"></span></div><ul><li><a href="../resources/overview9201.html?hl=ru" >Overview</a></li><li><a href="../resources/providing-resources9201.html?hl=ru" >Providing Resources</a></li><li><a href="../resources/accessing-resources9201.html?hl=ru" >Accessing Resources</a></li><li><a href="../resources/runtime-changes9201.html?hl=ru" >Handling Runtime Changes</a></li><li class="nav-section"><div class="nav-section-header"><a href="../resources/localization9201.html?hl=ru" >Localization</a><span class="toggle-icon" tabindex="0"></span></div><ul><li><a href="../resources/icu4j-framework9201.html?hl=ru" >ICU4J Android Framework APIs</a></li><li><a href="../resources/multilingual-support9201.html?hl=ru" >Language and Locale</a></li></ul></li><li><a href="../resources/complex-xml-resources9201.html?hl=ru" >Complex XML Resources</a></li><li class="nav-section"><div class="nav-section-header"><a href="../resources/available-resources9201.html?hl=ru" >Resource Types</a><span class="toggle-icon" tabindex="0"></span></div><ul><li><a href="../resources/animation-resource9201.html?hl=ru" >Animation</a></li><li><a href="../resources/color-list-resource9201.html?hl=ru" >Color State List</a></li><li><a href="../resources/drawable-resource9201.html?hl=ru" >Drawable</a></li><li><a href="../resources/layout-resource9201.html?hl=ru" >Layout</a></li><li><a href="../resources/menu-resource9201.html?hl=ru" >Menu</a></li><li><a href="../resources/string-resource9201.html?hl=ru" >String</a></li><li><a href="../resources/style-resource9201.html?hl=ru" >Style</a></li><li><a href="../resources/more-resources9201.html?hl=ru" >More Types</a></li></ul></li></ul></li><li class="nav-section"><div class="nav-section-header"><a href="../manifest/manifest-intro9201.html?hl=ru" >App Manifest</a><span class="toggle-icon" tabindex="0"></span></div><ul><li><a href="../manifest/action-element9201.html?hl=ru" >&lt;action&gt;</a></li><li><a href="../manifest/activity-element9201.html?hl=ru" >&lt;activity&gt;</a></li><li><a href="../manifest/activity-alias-element9201.html?hl=ru" >&lt;activity-alias&gt;</a></li><li><a href="../manifest/application-element9201.html?hl=ru" >&lt;application&gt;</a></li><li><a href="../manifest/category-element9201.html?hl=ru" >&lt;category&gt;</a></li><li><a href="../manifest/compatible-screens-element9201.html?hl=ru" >&lt;compatible-screens&gt;</a></li><li><a href="../manifest/data-element9201.html?hl=ru" >&lt;data&gt;</a></li><li><a href="../manifest/grant-uri-permission-element9201.html?hl=ru" >&lt;grant-uri-permission&gt;</a></li><li><a href="../manifest/instrumentation-element9201.html?hl=ru" >&lt;instrumentation&gt;</a></li><li><a href="../manifest/intent-filter-element9201.html?hl=ru" >&lt;intent-filter&gt;</a></li><li><a href="../manifest/manifest-element9201.html?hl=ru" >&lt;manifest&gt;</a></li><li><a href="../manifest/meta-data-element9201.html?hl=ru" >&lt;meta-data&gt;</a></li><li><a href="../manifest/path-permission-element9201.html?hl=ru" >&lt;path-permission&gt;</a></li><li><a href="../manifest/permission-element9201.html?hl=ru" >&lt;permission&gt;</a></li><li><a href="../manifest/permission-group-element9201.html?hl=ru" >&lt;permission-group&gt;</a></li><li><a href="../manifest/permission-tree-element9201.html?hl=ru" >&lt;permission-tree&gt;</a></li><li><a href="../manifest/provider-element9201.html?hl=ru" >&lt;provider&gt;</a></li><li><a href="../manifest/receiver-element9201.html?hl=ru" >&lt;receiver&gt;</a></li><li><a href="../manifest/service-element9201.html?hl=ru" >&lt;service&gt;</a></li><li><a href="../manifest/supports-gl-texture-element9201.html?hl=ru" >&lt;supports-gl-texture&gt;</a></li><li><a href="../manifest/supports-screens-element9201.html?hl=ru" >&lt;supports-screens&gt;</a></li><li><a href="../manifest/uses-configuration-element9201.html?hl=ru" >&lt;uses-configuration&gt;</a></li><li><a href="../manifest/uses-feature-element9201.html?hl=ru" >&lt;uses-feature&gt;</a></li><li><a href="../manifest/uses-library-element9201.html?hl=ru" >&lt;uses-library&gt;</a></li><li><a href="../manifest/uses-permission-element9201.html?hl=ru" >&lt;uses-permission&gt;</a></li><li><a href="../manifest/uses-permission-sdk-23-element9201.html?hl=ru" >&lt;uses-permission-sdk-23&gt;</a></li><li><a href="../manifest/uses-sdk-element9201.html?hl=ru" >&lt;uses-sdk&gt;</a></li></ul></li><li class="nav-section"><div class="nav-section-header"><a href="../ui/index9201.html?hl=ru" >User Interface</a><span class="toggle-icon" tabindex="0"></span></div><ul><li><a href="../ui/overview9201.html?hl=ru" >Overview</a></li><li class="nav-section"><div class="nav-section-header"><a href="../ui/declaring-layout9201.html?hl=ru" >Layouts</a><span class="toggle-icon" tabindex="0"></span></div><ul><li><a href="../ui/layout/linear9201.html?hl=ru" >Linear Layout</a></li><li><a href="../ui/layout/relative9201.html?hl=ru" >Relative Layout</a></li><li><a href="../ui/layout/recyclerview9201.html?hl=ru" >Recycler View</a></li><li><a href="../ui/layout/listview9201.html?hl=ru" >List View</a></li><li><a href="../ui/layout/gridview9201.html?hl=ru" >Grid View</a></li></ul></li><li class="nav-section"><div class="nav-section-header"><a href="../ui/controls9201.html?hl=ru" >Input Controls</a><span class="toggle-icon" tabindex="0"></span></div><ul><li><a href="../ui/controls/button9201.html?hl=ru" >Buttons</a></li><li><a href="../ui/controls/checkbox9201.html?hl=ru" >Checkboxes</a></li><li><a href="../ui/controls/radiobutton9201.html?hl=ru" >Radio Buttons</a></li><li><a href="../ui/controls/togglebutton9201.html?hl=ru" >Toggle Buttons</a></li><li><a href="../ui/controls/spinner9201.html?hl=ru" >Spinners</a></li><li><a href="../ui/controls/pickers9201.html?hl=ru" >Pickers</a></li></ul></li><li><a href="../ui/ui-events9201.html?hl=ru" >Input Events</a></li><li><a href="../ui/menus9201.html?hl=ru" >Menus</a></li><li><a href="../ui/settings9201.html?hl=ru" >Settings</a></li><li><a href="../ui/dialogs9201.html?hl=ru" >Dialogs</a></li><li><a href="../ui/notifiers/notifications9201.html?hl=ru" >Notifications</a></li><li><a href="../ui/notifiers/toasts9201.html?hl=ru" >Toasts</a></li><li><a href="../ui/shortcuts9201.html?hl=ru" >App Shortcuts</a></li><li class="nav-section"><div class="nav-section-header"><a href="../search/index9201.html?hl=ru" >Search</a><span class="toggle-icon" tabindex="0"></span></div><ul><li><a href="../search/search-dialog9201.html?hl=ru" >Creating a Search Interface</a></li><li><a href="../search/adding-recent-query-suggestions9201.html?hl=ru" >Adding Recent Query Suggestions</a></li><li><a href="../search/adding-custom-suggestions9201.html?hl=ru" >Adding Custom Suggestions</a></li><li><a href="../search/searchable-config9201.html?hl=ru" >Searchable Configuration</a></li></ul></li><li><a href="../ui/multi-window9201.html?hl=ru" >Multi-Window Support</a></li><li><a href="../ui/drag-drop9201.html?hl=ru" >Drag and Drop</a></li><li class="nav-section"><div class="nav-section-header"><a href="../ui/accessibility/index9201.html?hl=ru" >Accessibility</a><span class="toggle-icon" tabindex="0"></span></div><ul><li><a href="../ui/accessibility/apps9201.html?hl=ru" >Making Apps More Accessible</a></li><li><a href="../ui/accessibility/checklist9201.html?hl=ru" >Accessibility Developer Checklist</a></li><li><a href="../ui/accessibility/node-tree-debugging9201.html?hl=ru" >Using Node Tree Debugging</a></li><li><a href="../ui/accessibility/services9201.html?hl=ru" >Building Accessibility Services</a></li><li><a href="../ui/accessibility/custom-views9201.html?hl=ru" >Building Accessible Custom Views</a></li></ul></li><li><a href="../ui/themes9201.html?hl=ru" >Styles and Themes</a></li><li><a href="../ui/custom-components9201.html?hl=ru" >Custom Components</a></li></ul></li><li class="nav-section"><div class="nav-section-header"><a href="../graphics/index9201.html?hl=ru" >Animation and Graphics</a><span class="toggle-icon" tabindex="0"></span></div><ul><li><a href="../graphics/overview9201.html?hl=ru" >Overview</a></li><li><a href="../graphics/prop-animation9201.html?hl=ru" >Property Animation</a></li><li><a href="../graphics/view-animation9201.html?hl=ru" >View Animation</a></li><li><a href="../graphics/drawable-animation9201.html?hl=ru" >Drawable Animation</a></li><li class="nav-section"><div class="nav-section-header"><a href="../graphics/2d-graphics9201.html?hl=ru" >Canvas and Drawables</a><span class="toggle-icon" tabindex="0"></span></div><ul><li><a href="../graphics/vector-drawable-resources9201.html?hl=ru" >Vector Drawable</a></li></ul></li><li><a href="../graphics/opengl9201.html?hl=ru" >OpenGL ES</a></li><li><a href="../graphics/hardware-accel9201.html?hl=ru" >Hardware Acceleration</a></li></ul></li><li class="nav-section"><div class="nav-section-header"><a href="../renderscript/index9201.html?hl=ru" >Computation</a><span class="toggle-icon" tabindex="0"></span></div><ul><li><a href="../renderscript/compute9201.html?hl=ru" >RenderScript</a></li><li><a href="../renderscript/advanced9201.html?hl=ru" >Advanced RenderScript</a></li><li class="nav-section"><div class="nav-section-header"><a href="../renderscript/reference/overview9201.html?hl=ru" >Runtime API Reference</a><span class="toggle-icon" tabindex="0"></span></div><ul><li><a href="../renderscript/reference/rs_value_types9201.html?hl=ru" >Numerical Types</a></li><li><a href="../renderscript/reference/rs_object_types9201.html?hl=ru" >Object Types</a></li><li><a href="../renderscript/reference/rs_convert9201.html?hl=ru" >Conversion Functions</a></li><li><a href="../renderscript/reference/rs_math9201.html?hl=ru" >Mathematical Constants and Functions</a></li><li><a href="../renderscript/reference/rs_vector_math9201.html?hl=ru" >Vector Math Functions</a></li><li><a href="../renderscript/reference/rs_matrix9201.html?hl=ru" >Matrix Functions</a></li><li><a href="../renderscript/reference/rs_quaternion9201.html?hl=ru" >Quaternion Functions</a></li><li><a href="../renderscript/reference/rs_atomic9201.html?hl=ru" >Atomic Update Functions</a></li><li><a href="../renderscript/reference/rs_time9201.html?hl=ru" >Time Functions and Types</a></li><li><a href="../renderscript/reference/rs_allocation_data9201.html?hl=ru" >Allocation Data Access Functions</a></li><li><a href="../renderscript/reference/rs_object_info9201.html?hl=ru" >Object Characteristics Functions</a></li><li><a href="../renderscript/reference/rs_for_each9201.html?hl=ru" >Kernel Invocation Functions and Types</a></li><li><a href="../renderscript/reference/rs_io9201.html?hl=ru" >Input/Output Functions</a></li><li><a href="../renderscript/reference/rs_debug9201.html?hl=ru" >Debugging Functions</a></li><li><a href="../renderscript/reference/rs_graphics9201.html?hl=ru" >Graphics Functions and Types</a></li><li><a href="../renderscript/reference/index9201.html?hl=ru" >Index</a></li></ul></li></ul></li><li class="nav-section"><div class="nav-section-header"><a href="../media-apps/index9201.html?hl=ru" >Media Apps</a><span class="toggle-icon" tabindex="0"></span></div><ul><li><a href="../media-apps/media-apps-overview9201.html?hl=ru" >Media Apps Overview</a></li><li><a href="../media-apps/working-with-a-media-session9201.html?hl=ru" >Working with a Media Session</a></li><li class="nav-section"><div class="nav-section-header"><a href="../media-apps/audio-app/building-an-audio-app9201.html?hl=ru" >Building an Audio App</a><span class="toggle-icon" tabindex="0"></span></div><ul><li><a href="../media-apps/audio-app/building-a-mediabrowserservice9201.html?hl=ru" >Building a Media Browser Service</a></li><li><a href="../media-apps/audio-app/building-a-mediabrowser-client9201.html?hl=ru" >Building a Media Browser Client</a></li><li><a href="../media-apps/audio-app/mediasession-callbacks9201.html?hl=ru" >Media Session Callbacks</a></li></ul></li><li class="nav-section"><div class="nav-section-header"><a href="../media-apps/video-app/building-a-video-app9201.html?hl=ru" >Building a Video App</a><span class="toggle-icon" tabindex="0"></span></div><ul><li><a href="../media-apps/video-app/building-a-video-player-activity9201.html?hl=ru" >Building a Video Player Activity</a></li><li><a href="../media-apps/video-app/mediasession-callbacks9201.html?hl=ru" >Media Session Callbacks</a></li></ul></li><li><a href="../media-apps/mediabuttons9201.html?hl=ru" >Responding to Media Buttons</a></li><li><a href="../media-apps/volume-and-earphones9201.html?hl=ru" >Handling Changes in Audio Output</a></li></ul></li><li class="nav-section"><div class="nav-section-header"><a href="../media/index9201.html?hl=ru" >Media and Camera</a><span class="toggle-icon" tabindex="0"></span></div><ul><li><a href="../media/media-formats9201.html?hl=ru" >Supported Media Formats</a></li><li><a href="../media/mediaplayer9201.html?hl=ru" >MediaPlayer</a></li><li><a href="../media/mediarecorder9201.html?hl=ru" >MediaRecorder</a></li><li><a href="../media/exoplayer9201.html?hl=ru" >ExoPlayer</a></li><li class="nav-section"><div class="nav-section-header"><a href="../media/media-routing9201.html?hl=ru" >Media Routing</a><span class="toggle-icon" tabindex="0"></span></div><ul><li><a href="../media/mediarouter9201.html?hl=ru" >MediaRouter API</a></li><li><a href="../media/mediarouteprovider9201.html?hl=ru" >MediaRouteProvider API</a></li></ul></li><li><a href="../media/camera9201.html?hl=ru" >Camera API</a></li></ul></li><li class="nav-section"><div class="nav-section-header"><a href="../sensors/index9201.html?hl=ru" >Location and Sensors</a><span class="toggle-icon" tabindex="0"></span></div><ul><li><a href="../location/index9201.html?hl=ru" >Location and Maps</a></li><li><a href="../location/strategies9201.html?hl=ru" >Location Strategies</a></li><li><a href="../sensors/sensors_overview9201.html?hl=ru" >Sensors Overview</a></li><li><a href="../sensors/sensors_motion9201.html?hl=ru" >Motion Sensors</a></li><li><a href="../sensors/sensors_position9201.html?hl=ru" >Position Sensors</a></li><li><a href="../sensors/sensors_environment9201.html?hl=ru" >Environment Sensors</a></li></ul></li><li class="nav-section"><div class="nav-section-header"><a href="../connectivity/index9201.html?hl=ru" >Connectivity</a><span class="toggle-icon" tabindex="0"></span></div><ul><li class="nav-section"><div class="nav-section-header"><a href="../connectivity/bluetooth9201.html?hl=ru" >Bluetooth</a><span class="toggle-icon" tabindex="0"></span></div><ul><li><a href="../connectivity/bluetooth-le9201.html?hl=ru" >Bluetooth Low Energy</a></li></ul></li><li class="nav-section"><div class="nav-section-header"><a href="../connectivity/nfc/index9201.html?hl=ru" >NFC</a><span class="toggle-icon" tabindex="0"></span></div><ul><li><a href="../connectivity/nfc/nfc9201.html?hl=ru" >NFC Basics</a></li><li><a href="../connectivity/nfc/advanced-nfc9201.html?hl=ru" >Advanced NFC</a></li><li><a href="../connectivity/nfc/hce9201.html?hl=ru" >Host-based Card Emulation</a></li></ul></li><li><a href="../connectivity/wifip2p9201.html?hl=ru" >Wi-Fi P2P</a></li><li class="nav-section"><div class="nav-section-header"><a href="../connectivity/usb/index9201.html?hl=ru" >USB</a><span class="toggle-icon" tabindex="0"></span></div><ul><li><a href="../connectivity/usb/accessory9201.html?hl=ru" >Accessory</a></li><li><a href="../connectivity/usb/host9201.html?hl=ru" >Host</a></li></ul></li><li><a href="../connectivity/sip9201.html?hl=ru" >SIP</a></li></ul></li><li class="nav-section"><div class="nav-section-header"><a href="../text/index9201.html?hl=ru" >Text and Input</a><span class="toggle-icon" tabindex="0"></span></div><ul><li><a href="../text/copy-paste9201.html?hl=ru" >Copy and Paste</a></li><li class="nav-section"><div class="nav-section-header"><a href="../text/creating-input-method9201.html?hl=ru" >Creating an IME</a><span class="toggle-icon" tabindex="0"></span></div><ul><li><a href="../text/image-keyboard9201.html?hl=ru" >Image Keyboard</a></li></ul></li><li><a href="../text/spell-checker-framework9201.html?hl=ru" >Spelling Checker</a></li></ul></li><li class="nav-section"><div class="nav-section-header"><a href="../data/index9201.html?hl=ru" >Data Storage</a><span class="toggle-icon" tabindex="0"></span></div><ul><li><a href="../data/data-storage9201.html?hl=ru" >Storage Options</a></li><li class="nav-section"><div class="nav-section-header"><a href="../data/backup9201.html?hl=ru" >Data Backup</a><span class="toggle-icon" tabindex="0"></span></div><ul><li><a href="../data/autobackup9201.html?hl=ru" >Auto Backup</a></li><li><a href="../data/keyvaluebackup9201.html?hl=ru" >Key/Value Backup</a></li><li><a href="../data/testingbackup9201.html?hl=ru" >Testing Backup and Restore</a></li></ul></li><li><a href="../data/install-location9201.html?hl=ru" >App Install Location</a></li></ul></li><li class="nav-section"><div class="nav-section-header"><a href="../admin/index9201.html?hl=ru" >Administration</a><span class="toggle-icon" tabindex="0"></span></div><ul><li><a href="../admin/device-admin9201.html?hl=ru" >Device Policies</a></li></ul></li><li class="nav-section"><div class="nav-section-header"><a href="../../webapps/index9201.html?hl=ru" >Web Apps</a><span class="toggle-icon" tabindex="0"></span></div><ul><li><a href="../../webapps/targeting9201.html?hl=ru" >Supporting Different Screens in Web Apps</a></li><li><a href="../../webapps/webview9201.html?hl=ru" >Building Web Apps in WebView</a></li><li><a href="../../webapps/migrating9201.html?hl=ru" >Migrating to WebView in Android 4.4</a></li><li><a href="../../webapps/debugging9201.html?hl=ru" >Debugging Web Apps</a></li><li><a href="../../webapps/best-practices9201.html?hl=ru" >Best Practices for Web Apps</a></li></ul></li><li class="nav-section"><div class="nav-section-header"><a href="../../practices/index9201.html?hl=ru"  de-lang="Bewährte Verfahren" es-lang="Prácticas recomendadas" fr-lang="Meilleures pratiques" it-lang="Best practice" ja-lang="ベスト プラクティス" zh-cn-lang="最佳实践" zh-tw-lang="最佳實務">Best Practices</a><span class="toggle-icon" tabindex="0"></span></div><ul><li class="nav-section"><div class="nav-section-header"><a href="../../practices/screens_support9201.html?hl=ru" >Supporting Multiple Screens</a><span class="toggle-icon" tabindex="0"></span></div><ul><li><a href="../../practices/screens-distribution9201.html?hl=ru" >Distributing to Specific Screens</a></li><li><a href="../../practices/screen-compat-mode9201.html?hl=ru" >Screen Compatibility Mode</a></li></ul></li><li><a href="../../practices/app-design/seamlessness9201.html?hl=ru" >Designing for Seamlessness</a></li><li><a href="../../practices/tablets-and-handsets9201.html?hl=ru" >Supporting Tablets and Handsets</a></li></ul></li>
            </ul>
            
          
        </div>
        
        
          



<ul id="dac-main-navigation" class="dac-nav-list dac-swap-section dac-left dac-no-anim" tabindex=0>
  <li class="dac-nav-item home">
    <a class="dac-nav-link" href="https://developer.android.com/index.html?hl=ru">Начало</a>
    <i class="dac-sprite dac-expand-more-black dac-nav-sub-slider" tabindex=0></i>
    <ul class="dac-nav-secondary about">
      <li class="dac-nav-item versions">
        <a class="dac-nav-link" href="https://developer.android.com/about/versions/nougat/index.html?hl=ru">Android</a>
      </li>
      <li class="dac-nav-item wear">
        <a class="dac-nav-link" href="https://developer.android.com/wear/index.html?hl=ru">Wear</a>
      </li>
      <li class="dac-nav-item tv">
        <a class="dac-nav-link" href="https://developer.android.com/tv/index.html?hl=ru">TV</a>
      </li>
      <li class="dac-nav-item auto">
        <a class="dac-nav-link" href="https://developer.android.com/auto/index.html?hl=ru">Auto</a>
      </li>
      <li class="dac-nav-item things">
        <a class="dac-nav-link" href="https://developer.android.com/things/index.html?hl=ru">Things</a>
      </li>
    </ul>
  </li>
  <li class="dac-nav-item design">
    <a class="dac-nav-link" href="https://developer.android.com/design/index.html?hl=ru"
       zh-tw-lang="設計"
       zh-cn-lang="设计"
       ru-lang="Проектирование"
       ko-lang="디자인"
       ja-lang="設計"
       es-lang="Diseñar">Design</a>
  </li>
  <li class="dac-nav-item develop">
    <a class="dac-nav-link" href="https://developer.android.com/develop/index.html?hl=ru"
       zh-tw-lang="開發"
       zh-cn-lang="开发"
       ru-lang="Разработка"
       ko-lang="개발"
       ja-lang="開発"
       es-lang="Desarrollar">Develop</a>
    <i class="dac-sprite dac-expand-more-black dac-nav-sub-slider" tabindex=0></i>
    <ul class="dac-nav-secondary develop">
      <li class="dac-nav-item training">
        <a class="dac-nav-link" href="https://developer.android.com/training/index.html?hl=ru"
           zh-tw-lang="訓練課程"
           zh-cn-lang="培训"
           ru-lang="Курсы"
           ko-lang="교육"
           ja-lang="トレーニング"
           es-lang="Capacitación">Обучение</a>
      </li>
      <li class="dac-nav-item guide">
        <a class="dac-nav-link" href="../../index9201.html?hl=ru"
           zh-tw-lang="API 指南"
           zh-cn-lang="API 指南"
           ru-lang="Руководства по API"
           ko-lang="API 가이드"
           ja-lang="API ガイド"
           es-lang="Guías de la API">API Guides</a>
      </li>
      <li class="dac-nav-item reference">
        <a class="dac-nav-link" href="https://developer.android.com/reference/packages.html?hl=ru"
           zh-tw-lang="參考資源"
           zh-cn-lang="参考"
           ru-lang="Справочник"
           ko-lang="참조문서"
           ja-lang="リファレンス"
           es-lang="Referencia">Справочники</a>
      </li>
      <li class="dac-nav-item samples">
        <a class="dac-nav-link" href="https://developer.android.com/samples/index.html?hl=ru">Примеры</a>
      </li>
      <li class="dac-nav-item libraries">
        <a class="dac-nav-link" href="https://developer.android.com/topic/libraries/index.html?hl=ru"
           >Библиотеки</a></li>
      <li class="dac-nav-item studio">
        <a class="dac-nav-link" href="https://developer.android.com/studio/index.html?hl=ru"
           >Android Studio</a></li>
      <li class="dac-nav-item ndk">
        <a class="dac-nav-link" href="https://developer.android.com/ndk/index.html?hl=ru"
           >Android NDK</a></li>
      <li class="dac-nav-item google">
        <a class="dac-nav-link" href="https://developer.android.com/google/index.html?hl=ru">Google Services</a>
      </li>
      <li class="dac-nav-item quality-guidelines">
        <a class="dac-nav-link" href="https://developer.android.com/develop/quality-guidelines/index.html?hl=ru">Quality Guidelines</a>
      </li>
      <li class="dac-nav-item kotlin">
        <a class="dac-nav-link" href="https://developer.android.com/kotlin/index.html?hl=ru">Kotlin</a>
       </li>
    </ul>
  </li>
  <li class="dac-nav-item distribute">
    <a class="dac-nav-link" href="https://developer.android.com/distribute/index.html?hl=ru"
       zh-tw-lang="發佈"
       zh-cn-lang="分发"
       ru-lang="Распространение"
       ko-lang="배포"
       ja-lang="配布"
       de-lang="Vertrieb"
       es-lang="Distribuir"
       es-419-lang="Distribuye"
       fr-lang="Distribuer"
       id-lang="Distribusikan"
       pt-br-lang="Distribuição"
       th-lang="จัดจำหน่าย"
       tr-lang="Dağıtma"
       vi-lang="Phân phối">Distribute</a>
    <i class="dac-sprite dac-expand-more-black dac-nav-sub-slider" tabindex=0></i>
    <ul class="dac-nav-secondary distribute">
      <li class="dac-nav-item google-play">
        <a class="dac-nav-link" href="https://developer.android.com/distribute/google-play/index.html?hl=ru">Google Play</a>
      </li>
      <li class="dac-nav-item console">
        <a class="dac-nav-link" href="https://developer.android.com/distribute/console/index.html?hl=ru">Play Console</a>
      </li>
      <li class="dac-nav-item best-practices">
        <a class="dac-nav-link" href="https://developer.android.com/distribute/best-practices/index.html?hl=ru"
          es-419-lang="Recomendaciones"
          fr-lang="Bonnes pratiques"
          id-lang="Praktik terbaik"
          ja-lang="おすすめの方法"
          ko-lang="권장사항"
          pt-br-lang="Práticas recomendadas"
          ru-lang="Рекомендации"
          th-lang="จัดจำหน่าย"
          tr-lang="En iyi uygulamalar"
          vi-lang="Các phương pháp hay nhất"
          zh-cn-lang="最佳做法"
          zh-tw-lang="最佳做法">Best practices</a>
      </li>
      <li class="dac-nav-item marketing-tools">
        <a class="dac-nav-link" href="https://developer.android.com/distribute/marketing-tools/index.html?hl=ru"
          de-lang="Marketing-Tools"
          es-419-lang="Herramientas de marketing"
          fr-lang="Outils marketing"
          id-lang="Fitur pemasaran"
          ja-lang="マーケティング ツール"
          ko-lang="마케팅 도구"
          pt-br-lang="Ferramentas de marketing"
          ru-lang="Маркетинговые инструменты"
          th-lang="เครื่องมือการตลาด"
          tr-lang="Pazarlama araçları"
          vi-lang="Công cụ tiếp thị"
          zh-cn-lang="营销工具"
          zh-tw-lang="行銷工具">Marketing tools</a>
      </li>
      <li class="dac-nav-item policy-center">
        <a class="dac-nav-link" href="https://play.google.com/about/developer-content-policy/" target="_blank">Policy center</a>
      </li>
    </ul>
  </li>
  <li class="dac-nav-item stories">
    <a class="dac-nav-link" href="https://developer.android.com/stories/index.html?hl=ru">Stories</a>
  </li>
  
  <li class="dac-nav-item preview">
    <a class="dac-nav-link" href="https://developer.android.com/preview/index.html?hl=ru">Preview</a>
  </li>
  
</ul>

        
      </div>
    </div>
  </nav>

  <a name="top" tabindex="0"></a>
  
  <div class="wrap clearfix" id="body-content">
  
    
      
      <div class="content-header">
        <ul class="dac-header-crumbs"></ul>
        <!-- Breadcrumb Setup -->
        <script>$('.dac-nav-list').dacCurrentPage().dacCrumbs();</script>
        <h1 itemprop="name">Платформа доступа к хранилищу (Storage Access Framework)</h1>
      
        
      
      </div>
      
    
    <div class="jd-descr " itemprop="articleBody">
      

<div id="qv-wrapper">
<div id="qv">

<h2>Содержание документа
<a href="#" onclick="hideNestedItems('#toc44',this);return false;" class="header-toggle">
        <span class="more">больше информации</span>
        <span class="less" style="display:none">меньше информации</span></a></h2>
<ol id="toc44" class="hide-nested">
    <li>
        <a href="#overview">Обзор</a>
    </li>
    <li>
        <a href="#flow">Поток управления</a>
    </li>
    <li>
        <a href="#client">Создание клиентского приложения</a>
        <ol>
        <li><a href="#search">Поиск документов</a></li>
        <li><a href="#process">Обработка результатов</a></li>
        <li><a href="#metadata">Изучение метаданных документа</a></li>
        <li><a href="#open">Открытие документа</a></li>
        <li><a href="#create">Создание нового документа</a></li>
        <li><a href="#delete">Удаление документа</a></li>
        <li><a href="#edit">Редактирование документа</a></li>
        <li><a href="#permissions">Удержание прав доступа</a></li>
        </ol>
    </li>
    <li><a href="#custom">Создание собственного поставщика документов</a>
        <ol>
        <li><a href="#manifest">Манифест</a></li>
        <li><a href="#contract">Контракты</a></li>
        <li><a href="#subclass">Создание подкласса класса DocumentsProvider</a></li>
        <li><a href="#security">Безопасность</a></li>
        </ol>
    </li>

</ol>
<h2>Ключевые классы</h2>
<ol>
    <li><code><a href="https://developer.android.com/reference/android/provider/DocumentsProvider.html?hl=ru">DocumentsProvider</a></code></li>
    <li><code><a href="https://developer.android.com/reference/android/provider/DocumentsContract.html?hl=ru">DocumentsContract</a></code></li>
</ol>

<h2>Видео</h2>

<ol>
    <li><a href="http://www.youtube.com/watch?v=zxHVeXbK1P4&amp;hl=ru">
DevBytes: Android 4.4 Storage Access Framework: Поставщик</a></li>
     <li><a href="http://www.youtube.com/watch?v=UFj9AEz0DHQ&amp;hl=ru">
DevBytes: Android 4.4 Storage Access Framework: Клиент</a></li>
</ol>


<h2>Примеры кода</h2>

<ol>
    <li><a href="https://developer.android.com/samples/StorageProvider/index.html?hl=ru">
Класс StorageProvider</a></li>
     <li><a href="https://developer.android.com/samples/StorageClient/index.html?hl=ru">
Класс StorageClient</a></li>
</ol>

<h2>См. также:</h2>
<ol>
    <li>
        <a href="content-provider-basics9201.html?hl=ru">
Основные сведения о поставщике контента
</a>
    </li>
</ol>

</div>
</div>


<p>Платформа доступа к хранилищу (Storage Access Framework, SAF) впервые появилась в Android версии 4.4 (API уровня 19). Платформа SAF
 облегчает пользователям поиск и открытие документов, изображений и других файлов
в хранилищах всех поставщиков, с которыми они работают. Стандартный удобный интерфейс
позволяет пользователям применять единый для всех приложений и поставщиков способ поиска файлов и доступа к последним добавленным файлам.</p>

<p>Облачные или локальные службы хранения могут присоединиться к этой экосистеме, реализовав
класс <code><a href="https://developer.android.com/reference/android/provider/DocumentsProvider.html?hl=ru">DocumentsProvider</a></code>, инкапсулирующий их услуги. Клиентские
приложения, которым требуется доступ к документам поставщика, могут интегрироваться с SAF с помощью всего нескольких
строчек кода.</p>

<p>Платформа SAF включает в себя следующие компоненты:</p>

<ul>
<li><strong>Поставщик документов</strong>&mdash;поставщик контента, позволяющий
службе хранения (например, Диск Google) показывать файлы, которыми он управляет. Поставщик документов
реализуется как подкласс класса<code><a href="https://developer.android.com/reference/android/provider/DocumentsProvider.html?hl=ru">DocumentsProvider</a></code>.
Его схема основана на традиционной файловой иерархии,
однако физический способ хранения данных в поставщике документов остается на усмотрении разработчика.
 Платформа Android включает в себя несколько встроенных поставщиков документов, таких как
Загрузки, Изображения и Видео.</li>

<li><strong>Клиентское приложение</strong>&mdash;пользовательское приложение, вызывающее намерение
<code><a href="https://developer.android.com/reference/android/content/Intent.html?hl=ru#ACTION_OPEN_DOCUMENT">ACTION_OPEN_DOCUMENT</a></code> и/или
<code><a href="https://developer.android.com/reference/android/content/Intent.html?hl=ru#ACTION_CREATE_DOCUMENT">ACTION_CREATE_DOCUMENT</a></code> и принимающее
файлы, возвращаемые поставщиками документов.</li>

<li><strong>Элемент выбора</strong>&mdash;системный пользовательский интерфейс, обеспечивающий пользователям доступ к документам у всех
поставщиков документов, которые удовлетворяют критериям поиска, заданным в клиентском приложении.</li>
</ul>

<p>Платформа SAF в числе прочих предоставляет следующие функции:</p>
<ul>
<li>позволяет пользователям искать контент у всех поставщиков документов, а не только у одного приложения;</li>
<li>обеспечивает приложению возможность долговременного, постоянного доступа к
 документам, принадлежащим поставщику документов. Благодаря такому доступу пользователи могут добавлять, редактировать,
 сохранять и удалять файлы, хранящиеся у поставщика;</li>
<li>поддерживает несколько учетных записей и временные корневые каталоги, например, поставщики
на USB-накопителях, которые появляются, только когда накопитель вставлен в порт. </li>
</ul>

<h2 id ="overview">Обзор</h2>

<p>В центре платформы SAF находится поставщик контента, являющийся
подклассом класса <code><a href="https://developer.android.com/reference/android/provider/DocumentsProvider.html?hl=ru">DocumentsProvider</a></code>. Внутри <em>поставщика документов</em>данные имеют
структуру традиционной файловой иерархии:</p>
<p><img src="../../../images/providers/storage_datamodel9201.png?hl=ru" alt="data model" /></p>
<p class="img-caption"><strong>Рисунок 1.</strong> Модель данных поставщика документов. На рисунке Root (Корневой каталог) указывает на один объект Document (Документ),
который затем разветвляется в целое дерево.</p>

<p>Обратите внимание на следующее.</p>
<ul>

<li>Каждый поставщик документов предоставляет один или несколько
«корневых каталогов», являющихся отправными точками при обходе дерева документов.
Каждый корневой каталог имеет уникальный идентификатор <code><a href="https://developer.android.com/reference/android/provider/DocumentsContract.Root.html?hl=ru#COLUMN_ROOT_ID">COLUMN_ROOT_ID</a></code>
и указывает на документ (каталог),
представляющий содержимое на уровне ниже корневого.
Корневые каталоги динамичны по своей конструкции, чтобы обеспечивать поддержку таким вариантам использования, как несколько учетных записей,
временные хранилища на USB-нкопителях и возможность для пользователя войти в систему и выйти из нее.</li>

<li>В каждом корневом каталоге находится один документ. Этот документ указывает на количество документов <em>N</em>
каждый из которых, в свою очередь, может указывать на один или <em>N</em> документов. </li>

<li>Каждый сервер хранилища показывает
отдельные файлы и каталоги, ссылаясь на них с помощью уникального
идентификатора <code><a href="https://developer.android.com/reference/android/provider/DocumentsContract.Document.html?hl=ru#COLUMN_DOCUMENT_ID">COLUMN_DOCUMENT_ID</a></code>.
Идентификаторы документов должны быть уникальными и не меняться после присвоения, поскольку они используются для выдачи постоянных
URI, не зависящих от перезагрузки устройства.</li>


<li>Документ — это или открываемый файл (имеющий конкретный MIME-тип), или
каталог, содержащий другие документы (с
MIME-типом <code><a href="https://developer.android.com/reference/android/provider/DocumentsContract.Document.html?hl=ru#MIME_TYPE_DIR">MIME_TYPE_DIR</a></code>).</li>

<li>Каждый документ может иметь различные свойства, описываемые флагами
<code><a href="https://developer.android.com/reference/android/provider/DocumentsContract.Document.html?hl=ru#COLUMN_FLAGS">COLUMN_FLAGS</a></code>,
такими как<code><a href="https://developer.android.com/reference/android/provider/DocumentsContract.Document.html?hl=ru#FLAG_SUPPORTS_WRITE">FLAG_SUPPORTS_WRITE</a></code>,
<code><a href="https://developer.android.com/reference/android/provider/DocumentsContract.Document.html?hl=ru#FLAG_SUPPORTS_DELETE">FLAG_SUPPORTS_DELETE</a></code> и
<code><a href="https://developer.android.com/reference/android/provider/DocumentsContract.Document.html?hl=ru#FLAG_SUPPORTS_THUMBNAIL">FLAG_SUPPORTS_THUMBNAIL</a></code>.
Документ с одним и тем же идентификатором <code><a href="https://developer.android.com/reference/android/provider/DocumentsContract.Document.html?hl=ru#COLUMN_DOCUMENT_ID">COLUMN_DOCUMENT_ID</a></code> может находиться
в нескольких каталогах.</li>
</ul>

<h2 id="flow">Поток управления</h2>
<p>Как было сказано выше, модель данных поставщика документов основана на традиционной
файловой иерархии. Однако физический способ хранения данных остается на усмотрение разработчика, при
условии, что к ним можно обращаться через API-интерфейс <code><a href="https://developer.android.com/reference/android/provider/DocumentsProvider.html?hl=ru">DocumentsProvider</a></code>. Например, можно
использовать для данных облачное хранилище на основе тегов.</p>

<p>На рисунке 2 показан пример того, как приложение для обработки фотографий может использовать SAF
для доступа к сохраненным данным:</p>
<p><img src="../../../images/providers/storage_dataflow9201.png?hl=ru" alt="app" /></p>

<p class="img-caption"><strong>Рисунок 2.</strong> Поток управления Storage Access Framework</p>

<p>Обратите внимание на следующее.</p>
<ul>

<li>На платформе SAF поставщики и клиенты не взаимодействуют
напрямую. Клиент запрашивает разрешение на взаимодействие
с файлами (то есть, на чтение, редактирование, создание или удаление файлов).</li>

<li>Взаимодействие начинается, когда приложение (в нашем примере обрабатывающее фотографии) активизирует намерение
<code><a href="https://developer.android.com/reference/android/content/Intent.html?hl=ru#ACTION_OPEN_DOCUMENT">ACTION_OPEN_DOCUMENT</a></code> или <code><a href="https://developer.android.com/reference/android/content/Intent.html?hl=ru#ACTION_CREATE_DOCUMENT">ACTION_CREATE_DOCUMENT</a></code>. Намерение может включать в себя фильтры
для уточнения критериев, например, «предоставить открываемые файлы
с MIME-типом image».</li>

<li>Когда намерение срабатывает, системный элемент выбора переходит к каждому зарегистрированному поставщику
и показывает пользователю корневые каталоги с контентом, соответствующим запросу.</li>

<li>Элемент выбора предоставляет пользователю стандартный интерфейс, даже
если поставщики документов значительно различаются. В качестве примера на рисунке 2
изображены Диск Google, поставщик на USB-накопителе и облачный поставщик.</li>
</ul>

<p>На рисунке 3 показан элемент выбора, в котором пользователь для поиска изображений выбрал учетную запись
Диск Google:</p>

<p><img src="../../../images/providers/storage_picker9201.png?hl=ru" width="340" alt="picker" style="border:2px solid #ddd" /></p>

<p class="img-caption"><strong>Рисунок 3.</strong> Элемент выбора</p>

<p>Когда пользователь выбирает Диск Google, изображения отображаются, как показано на
рисунке 4. С этого момента пользователь может взаимодействовать с ними любыми способами,
 которые поддерживаются поставщиком и клиентским приложением.

<p><img src="../../../images/providers/storage_photos9201.png?hl=ru" width="340" alt="picker" style="border:2px solid #ddd" /></p>

<p class="img-caption"><strong>Рисунок 4.</strong> Изображения</p>

<h2 id="client">Создание клиентского приложения</h2>

<p>В Android версии 4.3 и ниже для того, чтобы приложение могло получать файл от другого
приложения, оно должно активизировать намерение, например, <code><a href="https://developer.android.com/reference/android/content/Intent.html?hl=ru#ACTION_PICK">ACTION_PICK</a></code>
или <code><a href="https://developer.android.com/reference/android/content/Intent.html?hl=ru#ACTION_GET_CONTENT">ACTION_GET_CONTENT</a></code>. После этого пользователь должен выбрать
какое-либо одно приложение, чтобы получить файл, а оно должно предоставить пользователю
интерфейс, с помощью которого он сможет выбирать и получать файлы. </p>

<p>Начиная с Android 4.4 и выше, у разработчика имеется дополнительная возможность — намерение
<code><a href="https://developer.android.com/reference/android/content/Intent.html?hl=ru#ACTION_OPEN_DOCUMENT">ACTION_OPEN_DOCUMENT</a></code>,
которое отображает пользовательский интерфейс элемента выбора, управляемого системой. Этот элемент предоставляет пользователю
обзор всех файлов, доступных в других приложениях. Благодаря этому единому интерфейсу,
пользователь может выбрать файл в любом из поддерживаемых приложений.</p>

<p>Намерение <code><a href="https://developer.android.com/reference/android/content/Intent.html?hl=ru#ACTION_OPEN_DOCUMENT">ACTION_OPEN_DOCUMENT</a></code> не
является заменой для намерения <code><a href="https://developer.android.com/reference/android/content/Intent.html?hl=ru#ACTION_GET_CONTENT">ACTION_GET_CONTENT</a></code>.
 Разработчику следует использовать то, которое лучше соответствует потребностям приложения:</p>

<ul>
<li>используйте <code><a href="https://developer.android.com/reference/android/content/Intent.html?hl=ru#ACTION_GET_CONTENT">ACTION_GET_CONTENT</a></code>, если приложению нужно просто
прочитать или импортировать данные. При таком подходе приложение импортирует копию данных,
 например, файл с изображением.</li>

<li>используйте <code><a href="https://developer.android.com/reference/android/content/Intent.html?hl=ru#ACTION_OPEN_DOCUMENT">ACTION_OPEN_DOCUMENT</a></code>, если
приложению нужна возможность долговременного, постоянного доступа к документам, принадлежащим поставщику
документов. В качестве примера можно назвать редактор фотографий, позволяющий пользователям обрабатывать
изображения, хранящиеся в поставщике документов. </li>

</ul>


<p>В этом разделе показано, как написать клиентское приложение, использующее намерения
<code><a href="https://developer.android.com/reference/android/content/Intent.html?hl=ru#ACTION_OPEN_DOCUMENT">ACTION_OPEN_DOCUMENT</a></code> и
<code><a href="https://developer.android.com/reference/android/content/Intent.html?hl=ru#ACTION_CREATE_DOCUMENT">ACTION_CREATE_DOCUMENT</a></code>.</p>


<h3 id="search">Поиск документов</h3>

<p>
В следующем фрагменте кода намерение <code><a href="https://developer.android.com/reference/android/content/Intent.html?hl=ru#ACTION_OPEN_DOCUMENT">ACTION_OPEN_DOCUMENT</a></code>
используется для поиска поставщиков документов,
содержащих файлы изображений:</p>

<pre>private static final int READ_REQUEST_CODE = 42;
...
/**
 * Fires an intent to spin up the &quot;file chooser&quot; UI and select an image.
 */
public void performFileSearch() {

    // ACTION_OPEN_DOCUMENT is the intent to choose a file via the system's file
    // browser.
    Intent intent = new Intent(Intent.ACTION_OPEN_DOCUMENT);

    // Filter to only show results that can be &quot;opened&quot;, such as a
    // file (as opposed to a list of contacts or timezones)
    intent.addCategory(Intent.CATEGORY_OPENABLE);

    // Filter to show only images, using the image MIME data type.
    // If one wanted to search for ogg vorbis files, the type would be &quot;audio/ogg&quot;.
    // To search for all documents available via installed storage providers,
    // it would be &quot;*/*&quot;.
    intent.setType(&quot;image/*&quot;);

    startActivityForResult(intent, READ_REQUEST_CODE);
}</pre>

<p>Обратите внимание на следующее.</p>
<ul>
<li>Когда приложение активизирует намерение <code><a href="https://developer.android.com/reference/android/content/Intent.html?hl=ru#ACTION_OPEN_DOCUMENT">ACTION_OPEN_DOCUMENT</a></code>
, оно запускает элемент выбора, отображающий всех поставщиков документов, соответствующих заданным критериям.</li>

<li>Добавление категории <code><a href="https://developer.android.com/reference/android/content/Intent.html?hl=ru#CATEGORY_OPENABLE">CATEGORY_OPENABLE</a></code> в
фильтры намерения приводит к отображению только тех документов, которые можно открыть, например, файлов с изображениями.</li>

<li>Оператор <code>intent.setType("image/*")</code> выполняет дальнейшую фильтрацию, чтобы
отображались только документы с MIME-типом image.</li>
</ul>

<h3 id="results">Обработка результатов</h3>

<p>Когда пользователь выбирает документ в элементе выбора,
вызывается метод <code><a href="https://developer.android.com/reference/android/app/Activity.html?hl=ru#onActivityResult(int, int, android.content.Intent)">onActivityResult()</a></code>.
Идентификатор URI, указывающий на выбранный документ, содержится в параметре<code>resultData</code>.
 Чтобы извлечь URI, следует вызвать <code><a href="https://developer.android.com/reference/android/content/Intent.html?hl=ru#getData()">getData()</a></code>.
Этот URI можно использовать для получения документа, нужного пользователю. Например:
</p>

<pre>&#64;Override
public void onActivityResult(int requestCode, int resultCode,
        Intent resultData) {

    // The ACTION_OPEN_DOCUMENT intent was sent with the request code
    // READ_REQUEST_CODE. If the request code seen here doesn't match, it's the
    // response to some other intent, and the code below shouldn't run at all.

    if (requestCode == READ_REQUEST_CODE && resultCode == Activity.RESULT_OK) {
        // The document selected by the user won't be returned in the intent.
        // Instead, a URI to that document will be contained in the return intent
        // provided to this method as a parameter.
        // Pull that URI using resultData.getData().
        Uri uri = null;
        if (resultData != null) {
            uri = resultData.getData();
            Log.i(TAG, "Uri: " + uri.toString());
            showImage(uri);
        }
    }
}
</pre>

<h3 id="metadata">Изучение метаданных документа</h3>

<p>Имея в своем распоряжении URI документа, разработчик получает доступ к его метаданным. В следующем
фрагменте кода метаданные документа, определяемого идентификатором URI, считываются и записываются в журнал:</p>

<pre>public void dumpImageMetaData(Uri uri) {

    // The query, since it only applies to a single document, will only return
    // one row. There's no need to filter, sort, or select fields, since we want
    // all fields for one document.
    Cursor cursor = getActivity().getContentResolver()
            .query(uri, null, null, null, null, null);

    try {
    // moveToFirst() returns false if the cursor has 0 rows.  Very handy for
    // &quot;if there's anything to look at, look at it&quot; conditionals.
        if (cursor != null &amp;&amp; cursor.moveToFirst()) {

            // Note it's called &quot;Display Name&quot;.  This is
            // provider-specific, and might not necessarily be the file name.
            String displayName = cursor.getString(
                    cursor.getColumnIndex(OpenableColumns.DISPLAY_NAME));
            Log.i(TAG, &quot;Display Name: &quot; + displayName);

            int sizeIndex = cursor.getColumnIndex(OpenableColumns.SIZE);
            // If the size is unknown, the value stored is null.  But since an
            // int can't be null in Java, the behavior is implementation-specific,
            // which is just a fancy term for &quot;unpredictable&quot;.  So as
            // a rule, check if it's null before assigning to an int.  This will
            // happen often:  The storage API allows for remote files, whose
            // size might not be locally known.
            String size = null;
            if (!cursor.isNull(sizeIndex)) {
                // Technically the column stores an int, but cursor.getString()
                // will do the conversion automatically.
                size = cursor.getString(sizeIndex);
            } else {
                size = &quot;Unknown&quot;;
            }
            Log.i(TAG, &quot;Size: &quot; + size);
        }
    } finally {
        cursor.close();
    }
}
</pre>

<h3 id="open-client">Открытие документа</h3>

<p>Получив URI документа, разработчик может открывать его и в целом
делать с ним всё, что угодно.</p>

<h4>Объект растровых изображений</h4>

<p>Приведем пример кода для открытия объекта <code><a href="https://developer.android.com/reference/android/graphics/Bitmap.html?hl=ru">Bitmap</a></code>:</p>

<pre>private Bitmap getBitmapFromUri(Uri uri) throws IOException {
    ParcelFileDescriptor parcelFileDescriptor =
            getContentResolver().openFileDescriptor(uri, "r");
    FileDescriptor fileDescriptor = parcelFileDescriptor.getFileDescriptor();
    Bitmap image = BitmapFactory.decodeFileDescriptor(fileDescriptor);
    parcelFileDescriptor.close();
    return image;
}
</pre>

<p>Обратите внимание, что не следует производить эту операцию в потоке пользовательского интерфейса. Ее нужно выполнять
в фоне, с помощью <code><a href="https://developer.android.com/reference/android/os/AsyncTask.html?hl=ru">AsyncTask</a></code>. Когда файл с растровым изображением откроется, его
можно отобразить в виджете <code><a href="https://developer.android.com/reference/android/widget/ImageView.html?hl=ru">ImageView</a></code>.
</p>

<h4>Получение объекта InputStream</h4>

<p>Далее приведен пример того, как можно получить объект <code><a href="https://developer.android.com/reference/java/io/InputStream.html?hl=ru">InputStream</a></code> по идентификатору URI. В этом
фрагменте кода строчки файла считываются в объект строкового типа:</p>

<pre>private String readTextFromUri(Uri uri) throws IOException {
    InputStream inputStream = getContentResolver().openInputStream(uri);
    BufferedReader reader = new BufferedReader(new InputStreamReader(
            inputStream));
    StringBuilder stringBuilder = new StringBuilder();
    String line;
    while ((line = reader.readLine()) != null) {
        stringBuilder.append(line);
    }
    fileInputStream.close();
    parcelFileDescriptor.close();
    return stringBuilder.toString();
}
</pre>

<h3 id="create">Создание нового документа</h3>

<p>Приложение может создать новый документ в поставщике документов, используя намерение
<code><a href="https://developer.android.com/reference/android/content/Intent.html?hl=ru#ACTION_CREATE_DOCUMENT">ACTION_CREATE_DOCUMENT</a></code>
. Чтобы создать файл, нужно указать в намерении MIME-тип и имя файла, а затем
запустить его с уникальным кодом запроса. Об остальном позаботится платформа:</p>


<pre>
// Here are some examples of how you might call this method.
// The first parameter is the MIME type, and the second parameter is the name
// of the file you are creating:
//
// createFile("text/plain", "foobar.txt");
// createFile("image/png", "mypicture.png");

// Unique request code.
private static final int WRITE_REQUEST_CODE = 43;
...
private void createFile(String mimeType, String fileName) {
    Intent intent = new Intent(Intent.ACTION_CREATE_DOCUMENT);

    // Filter to only show results that can be &quot;opened&quot;, such as
    // a file (as opposed to a list of contacts or timezones).
    intent.addCategory(Intent.CATEGORY_OPENABLE);

    // Create a file with the requested MIME type.
    intent.setType(mimeType);
    intent.putExtra(Intent.EXTRA_TITLE, fileName);
    startActivityForResult(intent, WRITE_REQUEST_CODE);
}
</pre>

<p>После создания нового документа можно получить его URI с помощью
метода <code><a href="https://developer.android.com/reference/android/app/Activity.html?hl=ru#onActivityResult(int, int, android.content.Intent)">onActivityResult()</a></code>, чтобы иметь возможность
записывать в него данные.</p>

<h3 id="delete">Удаление документа</h3>

<p>Если у разработчика имеется URI документа, а объект
<code><a href="https://developer.android.com/reference/android/provider/DocumentsContract.Document.html?hl=ru#COLUMN_FLAGS">Document.COLUMN_FLAGS</a></code>
этого документа содержит флаг
<code><a href="https://developer.android.com/reference/android/provider/DocumentsContract.Document.html?hl=ru#FLAG_SUPPORTS_DELETE">SUPPORTS_DELETE</a></code>,
то документ можно удалить. Например:</p>

<pre>
DocumentsContract.deleteDocument(getContentResolver(), uri);
</pre>

<h3 id="edit">Редактирование документа</h3>

<p>Платформа SAF позволяет редактировать текстовые документы на месте.
В следующем фрагменте кода активизируется
намерение <code><a href="https://developer.android.com/reference/android/content/Intent.html?hl=ru#ACTION_OPEN_DOCUMENT">ACTION_OPEN_DOCUMENT</a></code>, а
категория <code><a href="https://developer.android.com/reference/android/content/Intent.html?hl=ru#CATEGORY_OPENABLE">CATEGORY_OPENABLE</a></code> используется, чтобы отображались только
документы, которые можно открыть. Затем производится дальнейшая фильтрация, чтобы отображались только текстовые файлы:</p>

<pre>
private static final int EDIT_REQUEST_CODE = 44;
/**
 * Open a file for writing and append some text to it.
 */
 private void editDocument() {
    // ACTION_OPEN_DOCUMENT is the intent to choose a file via the system's
    // file browser.
    Intent intent = new Intent(Intent.ACTION_OPEN_DOCUMENT);

    // Filter to only show results that can be &quot;opened&quot;, such as a
    // file (as opposed to a list of contacts or timezones).
    intent.addCategory(Intent.CATEGORY_OPENABLE);

    // Filter to show only text files.
    intent.setType(&quot;text/plain&quot;);

    startActivityForResult(intent, EDIT_REQUEST_CODE);
}
</pre>

<p>Далее, из метода <code><a href="https://developer.android.com/reference/android/app/Activity.html?hl=ru#onActivityResult(int, int, android.content.Intent)">onActivityResult()</a></code>
(см. <a href="#results">Обработка результатов</a>) можно вызвать код для выполнения редактирования.
В следующем фрагменте кода объект <code><a href="https://developer.android.com/reference/java/io/FileOutputStream.html?hl=ru">FileOutputStream</a></code>
получен с помощью объекта класса <code><a href="https://developer.android.com/reference/android/content/ContentResolver.html?hl=ru">ContentResolver</a></code>. По умолчанию используется режим записи.
Рекомендуется запрашивать минимально необходимые права доступа, поэтому не следует запрашивать
чтение/запись, если приложению требуется только записать файл:</p>

<pre>private void alterDocument(Uri uri) {
    try {
        ParcelFileDescriptor pfd = getActivity().getContentResolver().
                openFileDescriptor(uri, "w");
        FileOutputStream fileOutputStream =
                new FileOutputStream(pfd.getFileDescriptor());
        fileOutputStream.write(("Overwritten by MyCloud at " +
                System.currentTimeMillis() + "\n").getBytes());
        // Let the document provider know you're done by closing the stream.
        fileOutputStream.close();
        pfd.close();
    } catch (FileNotFoundException e) {
        e.printStackTrace();
    } catch (IOException e) {
        e.printStackTrace();
    }
}</pre>

<h3 id="permissions">Удержание прав доступа</h3>

<p>Когда приложение открывает файл для чтения или записи, система предоставляет
ему URI-разрешение на этот файл. Разрешение действует вплоть до перезагрузки устройства.
Предположим, что в графическом редакторе требуется, чтобы у пользователя была возможность
открыть непосредственно в этом приложении последние пять изображений, которые он редактировал. Если он
перезапустил устройство, возникает необходимость снова отсылать его к системному элементу выбора для поиска
файлов. Очевидно, это далеко не идеальный вариант.</p>

<p>Чтобы избежать такой ситуации, разработчик может удержать права доступа, предоставленные системой
его приложению. Приложение фактически принимает постоянное URI-разрешение,
предлагаемое системой. В результате пользователь получает непрерывный доступ к файлам
из приложения, независимо от перезагрузки устройства:</p>


<pre>final int takeFlags = intent.getFlags()
            &amp; (Intent.FLAG_GRANT_READ_URI_PERMISSION
            | Intent.FLAG_GRANT_WRITE_URI_PERMISSION);
// Check for the freshest data.
getContentResolver().takePersistableUriPermission(uri, takeFlags);</pre>

<p>Остается один заключительный шаг. Можно сохранить последние
URI-идентификаторы, с которыми работало приложение. Однако не исключено, что они потеряют актуальность, поскольку другое приложение
может удалить или модифицировать документ. Поэтому следует всегда вызывать
<code>getContentResolver().takePersistableUriPermission()</code>, чтобы получать
актуальные данные.</p>

<h2 id="custom">Создание собственного поставщика документов</h2>

<p>
При разработке приложения, оказывающего услуги по хранению файлов (например,
службы хранения в облаке), можно предоставить доступ к файлам при помощи
SAF, написав собственный поставщик документов.  В этом разделе показано,
как это сделать.</p>


<h3 id="manifest">Манифест</h3>

<p>Чтобы реализовать собственный поставщик документов, необходимо добавить в манифест приложения
следующую информацию:</p>
<ul>

<li>Целевой API-интерфейс уровня 19 или выше.</li>

<li>Элемент <code>&lt;provider&gt;</code>, в котором объявляется нестандартный поставщик
 хранилища. </li>

<li>Имя поставщика, т. е., имя его класса с именем пакета.
Например: <code>com.example.android.storageprovider.MyCloudProvider</code>.</li>

<li>Имя центра поставщика, т. е. имя пакета (в этом примере —
<code>com.example.android.storageprovider</code>) с типом поставщика контента
(<code>documents</code>). Например,<code>com.example.android.storageprovider.documents</code>.</li>

<li>Атрибут <code>android:exported</code>, установленный в значение <code>&quot;true&quot;</code>.
 Необходимо экспортировать поставщик, чтобы он был виден другим приложениям.</li>

<li>Атрибут <code>android:grantUriPermissions</code>, установленный в значение
<code>&quot;true&quot;</code>. Этот параметр позволяет системе предоставлять другим приложениям доступ
к контенту поставщика. Обсуждение того, как следует удерживать права доступа
к конкретному документу см. в разделе <a href="#permissions">Удержание прав доступа</a>.</li>

<li>Разрешение <code>MANAGE_DOCUMENTS</code>. По умолчанию поставщик доступен
всем. Добавление этого разрешения в манифест делает поставщик доступным только системе.
Это важно для обеспечения безопасности.</li>

<li>Атрибут <code>android:enabled</code>, имеющий логическое значение, определенное в файле
ресурсов. Этот атрибут предназначен для отключения поставщика на устройствах под управлением Android версии 4.3 и ниже.
 Например: <code>android:enabled="@bool/atLeastKitKat"</code>. Помимо
включения этого атрибута в манифест, необходимо сделать следующее:
<ul>
<li>В файл ресурсов <code>bool.xml</code>, расположенный в каталоге <code>res/values/</code>, добавить
строчку <pre>&lt;bool name=&quot;atLeastKitKat&quot;&gt;false&lt;/bool&gt;</pre></li>

<li>В файл ресурсов <code>bool.xml</code>, расположенный в каталоге <code>res/values-v19/</code>, добавить
строчку <pre>&lt;bool name=&quot;atLeastKitKat&quot;&gt;true&lt;/bool&gt;</pre></li>
</ul></li>

<li>Фильтр намерения с действием
<code>android.content.action.DOCUMENTS_PROVIDER</code>, чтобы поставщик
появлялся в элементе выбора, когда система будет искать поставщиков.</li>

</ul>
<p>Ниже приведены отрывки из образца манифеста, включающего в себя поставщик:</p>

<pre>&lt;manifest... &gt;
    ...
    &lt;uses-sdk
        android:minSdkVersion=&quot;19&quot;
        android:targetSdkVersion=&quot;19&quot; /&gt;
        ....
        &lt;provider
            android:name=&quot;com.example.android.storageprovider.MyCloudProvider&quot;
            android:authorities=&quot;com.example.android.storageprovider.documents&quot;
            android:grantUriPermissions=&quot;true&quot;
            android:exported=&quot;true&quot;
            android:permission=&quot;android.permission.MANAGE_DOCUMENTS&quot;
            android:enabled=&quot;&#64;bool/atLeastKitKat&quot;&gt;
            &lt;intent-filter&gt;
                &lt;action android:name=&quot;android.content.action.DOCUMENTS_PROVIDER&quot; /&gt;
            &lt;/intent-filter&gt;
        &lt;/provider&gt;
    &lt;/application&gt;

&lt;/manifest&gt;</pre>

<h4 id="43">Поддержка устройств под управлением Android версии 4.3 и ниже</h4>

<p>Намерение
<code><a href="https://developer.android.com/reference/android/content/Intent.html?hl=ru#ACTION_OPEN_DOCUMENT">ACTION_OPEN_DOCUMENT</a></code> доступно только
на устройствах с Android версии 4.4 и выше.
Если приложение должно поддерживать <code><a href="https://developer.android.com/reference/android/content/Intent.html?hl=ru#ACTION_GET_CONTENT">ACTION_GET_CONTENT</a></code>,
чтобы обслуживать устройства, работающие под управлением Android 4.3 и ниже, необходимо
отключить фильтр намерения <code><a href="https://developer.android.com/reference/android/content/Intent.html?hl=ru#ACTION_GET_CONTENT">ACTION_GET_CONTENT</a></code> в
манифесте для устройств с Android версии 4.4 и выше. Поставщик
документов и намерение <code><a href="https://developer.android.com/reference/android/content/Intent.html?hl=ru#ACTION_GET_CONTENT">ACTION_GET_CONTENT</a></code> следует считать
взаимоисключающими. Если приложение поддерживает их одновременно, оно
будет появляться в пользовательском интерфейсе системного элемента выбора дважды, предлагая два различных способа доступа
к сохраненным данным. Это запутает пользователей.</p>

<p>Отключать фильтр намерения
<code><a href="https://developer.android.com/reference/android/content/Intent.html?hl=ru#ACTION_GET_CONTENT">ACTION_GET_CONTENT</a></code> на устройствах
с Android версии 4.4 и выше рекомендуется следующим образом:</p>

<ol>
<li>В файл ресурсов <code>bool.xml</code>, расположенный в каталоге <code>res/values/</code>, добавить
следующую строку: <pre>&lt;bool name=&quot;atMostJellyBeanMR2&quot;&gt;true&lt;/bool&gt;</pre></li>

<li>В файл ресурсов <code>bool.xml</code>, расположенный в каталоге <code>res/values-v19/</code>, добавить
следующую строку: <pre>&lt;bool name=&quot;atMostJellyBeanMR2&quot;&gt;false&lt;/bool&gt;</pre></li>

<li>Добавить
<a href="../manifest/activity-alias-element9201.html?hl=ru">псевдоним
операции</a>, чтобы отключить фильтр намерения <code><a href="https://developer.android.com/reference/android/content/Intent.html?hl=ru#ACTION_GET_CONTENT">ACTION_GET_CONTENT</a></code>
для версий 4.4 (API уровня 19) и выше. Например:

<pre>
&lt;!-- This activity alias is added so that GET_CONTENT intent-filter
     can be disabled for builds on API level 19 and higher. --&gt;
&lt;activity-alias android:name=&quot;com.android.example.app.MyPicker&quot;
        android:targetActivity=&quot;com.android.example.app.MyActivity&quot;
        ...
        android:enabled=&quot;@bool/atMostJellyBeanMR2&quot;&gt;
    &lt;intent-filter&gt;
        &lt;action android:name=&quot;android.intent.action.GET_CONTENT&quot; /&gt;
        &lt;category android:name=&quot;android.intent.category.OPENABLE&quot; /&gt;
        &lt;category android:name=&quot;android.intent.category.DEFAULT&quot; /&gt;
        &lt;data android:mimeType=&quot;image/*&quot; /&gt;
        &lt;data android:mimeType=&quot;video/*&quot; /&gt;
    &lt;/intent-filter&gt;
&lt;/activity-alias&gt;
</pre>
</li>
</ol>
<h3 id="contract">Контракты</h3>

<p>Как правило, при создании нестандартного поставщика контента одной из задач
является реализация классов-контрактов, описанная в руководстве для разработчиков
<a href="content-provider-creating9201.html?hl=ru#ContractClass">
Поставщики контента</a>. Класс-контракт представляет собой класс <code>public final</code>,
в котором содержатся определения констант для URI, имен столбцов, типов MIME и
других метаданных поставщика. Платформа SAF
предоставляет разработчику следующие классы-контракты, так что ему не нужно писать
собственные:</p>

<ul>
   <li><code><a href="https://developer.android.com/reference/android/provider/DocumentsContract.Document.html?hl=ru">DocumentsContract.Document</a></code></li>
   <li><code><a href="https://developer.android.com/reference/android/provider/DocumentsContract.Root.html?hl=ru">DocumentsContract.Root</a></code></li>
</ul>

<p>Например, когда
к поставщику документов приходит запрос на документы или корневой каталог, можно возвращать в курсоре следующие столбцы:</p>

<pre>private static final String[] DEFAULT_ROOT_PROJECTION =
        new String[]{Root.COLUMN_ROOT_ID, Root.COLUMN_MIME_TYPES,
        Root.COLUMN_FLAGS, Root.COLUMN_ICON, Root.COLUMN_TITLE,
        Root.COLUMN_SUMMARY, Root.COLUMN_DOCUMENT_ID,
        Root.COLUMN_AVAILABLE_BYTES,};
private static final String[] DEFAULT_DOCUMENT_PROJECTION = new
        String[]{Document.COLUMN_DOCUMENT_ID, Document.COLUMN_MIME_TYPE,
        Document.COLUMN_DISPLAY_NAME, Document.COLUMN_LAST_MODIFIED,
        Document.COLUMN_FLAGS, Document.COLUMN_SIZE,};
</pre>

<h3 id="subclass">Создание подкласса класса DocumentsProvider</h3>

<p>Следующим шагом в разработке собственного поставщика документов является создание подкласса
абстрактного класса <code><a href="https://developer.android.com/reference/android/provider/DocumentsProvider.html?hl=ru">DocumentsProvider</a></code>. Как минимум, необходимо
реализовать следующие методы:</p>

<ul>
<li><code><a href="https://developer.android.com/reference/android/provider/DocumentsProvider.html?hl=ru#queryRoots(java.lang.String[])">queryRoots()</a></code></li>

<li><code><a href="https://developer.android.com/reference/android/provider/DocumentsProvider.html?hl=ru#queryChildDocuments(java.lang.String, java.lang.String[], android.os.Bundle)">queryChildDocuments()</a></code></li>

<li><code><a href="https://developer.android.com/reference/android/provider/DocumentsProvider.html?hl=ru#queryDocument(java.lang.String, java.lang.String[])">queryDocument()</a></code></li>

<li><code><a href="https://developer.android.com/reference/android/provider/DocumentsProvider.html?hl=ru#openDocument(java.lang.String, java.lang.String, android.os.CancellationSignal)">openDocument()</a></code></li>
</ul>

<p>Это единственные методы, реализация которых строго обязательна, однако существует
намного больше методов, которые, возможно, тоже придется реализовать. Подробности приводятся в описании класса<code><a href="https://developer.android.com/reference/android/provider/DocumentsProvider.html?hl=ru">DocumentsProvider</a></code>
.</p>

<h4 id="queryRoots">Реализация метода queryRoots</h4>

<p>Реализация метода <code><a href="https://developer.android.com/reference/android/provider/DocumentsProvider.html?hl=ru#queryRoots(java.lang.String[])">queryRoots()</a></code> должна возвращать объект <code><a href="https://developer.android.com/reference/android/database/Cursor.html?hl=ru">Cursor</a></code>, указывающий на все
корневые каталоги поставщиков документов, используя столбцы, определенные в
<code><a href="https://developer.android.com/reference/android/provider/DocumentsContract.Root.html?hl=ru">DocumentsContract.Root</a></code>.</p>

<p>В следующем фрагменте кода параметр <code>projection</code> представляет
конкретные поля, нужные вызывающему объекту. В этом коде создается курсор,
и к нему добавляется одна строка, соответствующая одному корневому каталогу (каталогу верхнего уровня), например,
Загрузки или Изображения.  Большинство поставщиков имеет только один корневой каталог. Однако ничто не мешает иметь несколько корневых каталогов,
например, при наличии нескольких учетных записей. В этом случае достаточно добавить в
курсор еще одну строку.</p>

<pre>
&#64;Override
public Cursor queryRoots(String[] projection) throws FileNotFoundException {

    // Create a cursor with either the requested fields, or the default
    // projection if "projection" is null.
    final MatrixCursor result =
            new MatrixCursor(resolveRootProjection(projection));

    // If user is not logged in, return an empty root cursor.  This removes our
    // provider from the list entirely.
    if (!isUserLoggedIn()) {
        return result;
    }

    // It's possible to have multiple roots (e.g. for multiple accounts in the
    // same app) -- just add multiple cursor rows.
    // Construct one row for a root called &quot;MyCloud&quot;.
    final MatrixCursor.RowBuilder row = result.newRow();
    row.add(Root.COLUMN_ROOT_ID, ROOT);
    row.add(Root.COLUMN_SUMMARY, getContext().getString(R.string.root_summary));

    // FLAG_SUPPORTS_CREATE means at least one directory under the root supports
    // creating documents. FLAG_SUPPORTS_RECENTS means your application's most
    // recently used documents will show up in the &quot;Recents&quot; category.
    // FLAG_SUPPORTS_SEARCH allows users to search all documents the application
    // shares.
    row.add(Root.COLUMN_FLAGS, Root.FLAG_SUPPORTS_CREATE |
            Root.FLAG_SUPPORTS_RECENTS |
            Root.FLAG_SUPPORTS_SEARCH);

    // COLUMN_TITLE is the root title (e.g. Gallery, Drive).
    row.add(Root.COLUMN_TITLE, getContext().getString(R.string.title));

    // This document id cannot change once it's shared.
    row.add(Root.COLUMN_DOCUMENT_ID, getDocIdForFile(mBaseDir));

    // The child MIME types are used to filter the roots and only present to the
    //  user roots that contain the desired type somewhere in their file hierarchy.
    row.add(Root.COLUMN_MIME_TYPES, getChildMimeTypes(mBaseDir));
    row.add(Root.COLUMN_AVAILABLE_BYTES, mBaseDir.getFreeSpace());
    row.add(Root.COLUMN_ICON, R.drawable.ic_launcher);

    return result;
}</pre>

<h4 id="queryChildDocuments">Реализация метода queryChildDocuments</h4>

<p>Реализация метода
<code><a href="https://developer.android.com/reference/android/provider/DocumentsProvider.html?hl=ru#queryChildDocuments(java.lang.String, java.lang.String[], android.os.Bundle)">queryChildDocuments()</a></code>
должна возвращать объект<code><a href="https://developer.android.com/reference/android/database/Cursor.html?hl=ru">Cursor</a></code>, указывающий на все файлы в
заданном каталоге, используя столбцы, определенные в
<code><a href="https://developer.android.com/reference/android/provider/DocumentsContract.Document.html?hl=ru">DocumentsContract.Document</a></code>.</p>

<p>Этот метод вызывается, когда в интерфейсе элемента выбора пользователь выбирает корневой каталог приложения.
Метод получает документы-потомки каталога на уровне ниже корневого.  Его можно вызывать на любом уровне
файловой иерархии, а не только в корневом каталоге. В следующем фрагменте кода
создается курсор с запрошенными столбцами. Затем в него заносится информация о
каждом ближайшем потомке родительского каталога.
Потомком может быть изображение, еще один каталог, в общем, любой файл:</p>

<pre>&#64;Override
public Cursor queryChildDocuments(String parentDocumentId, String[] projection,
                              String sortOrder) throws FileNotFoundException {

    final MatrixCursor result = new
            MatrixCursor(resolveDocumentProjection(projection));
    final File parent = getFileForDocId(parentDocumentId);
    for (File file : parent.listFiles()) {
        // Adds the file's display name, MIME type, size, and so on.
        includeFile(result, null, file);
    }
    return result;
}
</pre>

<h4 id="queryDocument">Реализация метода queryDocument</h4>

<p>Реализация метода
<code><a href="https://developer.android.com/reference/android/provider/DocumentsProvider.html?hl=ru#queryDocument(java.lang.String, java.lang.String[])">queryDocument()</a></code>
должна возвращать объект<code><a href="https://developer.android.com/reference/android/database/Cursor.html?hl=ru">Cursor</a></code>, указывающий на заданный файл,
используя столбцы, определенные в<code><a href="https://developer.android.com/reference/android/provider/DocumentsContract.Document.html?hl=ru">DocumentsContract.Document</a></code>.
</p>

<p>Метод <code><a href="https://developer.android.com/reference/android/provider/DocumentsProvider.html?hl=ru#queryDocument(java.lang.String, java.lang.String[])">queryDocument()</a></code>
возвращает ту же информацию, которую возвращал
<code><a href="https://developer.android.com/reference/android/provider/DocumentsProvider.html?hl=ru#queryChildDocuments(java.lang.String, java.lang.String[], android.os.Bundle)">queryChildDocuments()</a></code>,
но для конкретного файла:</p>


<pre>&#64;Override
public Cursor queryDocument(String documentId, String[] projection) throws
        FileNotFoundException {

    // Create a cursor with the requested projection, or the default projection.
    final MatrixCursor result = new
            MatrixCursor(resolveDocumentProjection(projection));
    includeFile(result, documentId, null);
    return result;
}
</pre>

<h4 id="openDocument">Реализация метода openDocument</h4>

<p>Необходимо реализовать метод <code><a href="https://developer.android.com/reference/android/provider/DocumentsProvider.html?hl=ru#openDocument(java.lang.String, java.lang.String, android.os.CancellationSignal)">openDocument()</a></code>, который возвращает объект <code><a href="https://developer.android.com/reference/android/os/ParcelFileDescriptor.html?hl=ru">ParcelFileDescriptor</a></code>, представляющий
указанный файл. Другие приложения смогут воспользоваться возращенным объектом <code><a href="https://developer.android.com/reference/android/os/ParcelFileDescriptor.html?hl=ru">ParcelFileDescriptor</a></code>
для организации потока данных. Система вызывает этот метод, когда пользователь выбирает файл,
и клиентское приложение запрашивает доступ нему, вызывая
метод <code><a href="https://developer.android.com/reference/android/content/ContentResolver.html?hl=ru#openFileDescriptor(android.net.Uri, java.lang.String)">openFileDescriptor()</a></code>.
Например:</p>

<pre>&#64;Override
public ParcelFileDescriptor openDocument(final String documentId,
                                         final String mode,
                                         CancellationSignal signal) throws
        FileNotFoundException {
    Log.v(TAG, &quot;openDocument, mode: &quot; + mode);
    // It's OK to do network operations in this method to download the document,
    // as long as you periodically check the CancellationSignal. If you have an
    // extremely large file to transfer from the network, a better solution may
    // be pipes or sockets (see ParcelFileDescriptor for helper methods).

    final File file = getFileForDocId(documentId);

    final boolean isWrite = (mode.indexOf('w') != -1);
    if(isWrite) {
        // Attach a close listener if the document is opened in write mode.
        try {
            Handler handler = new Handler(getContext().getMainLooper());
            return ParcelFileDescriptor.open(file, accessMode, handler,
                        new ParcelFileDescriptor.OnCloseListener() {
                &#64;Override
                public void onClose(IOException e) {

                    // Update the file with the cloud server. The client is done
                    // writing.
                    Log.i(TAG, &quot;A file with id &quot; +
                    documentId + &quot; has been closed!
                    Time to &quot; +
                    &quot;update the server.&quot;);
                }

            });
        } catch (IOException e) {
            throw new FileNotFoundException(&quot;Failed to open document with id &quot;
            + documentId + &quot; and mode &quot; + mode);
        }
    } else {
        return ParcelFileDescriptor.open(file, accessMode);
    }
}
</pre>

<h3 id="security">Безопасность</h3>

<p>Предположим, что поставщик документов представляет собой защищенную паролем службу хранения в облаке,
а приложение должно убедиться, что пользователь вошел в систему, прежде чем оно предоставит ему доступ к файлам.
Что должно предпринять приложение, если пользователь не выполнил вход?  Решение состоит в том, чтобы
реализация метода <code><a href="https://developer.android.com/reference/android/provider/DocumentsProvider.html?hl=ru#queryRoots(java.lang.String[])">queryRoots()</a></code> не возвращала корневых каталогов. Иными словами, это должен быть пустой корневой курсор:</p>

<pre>
public Cursor queryRoots(String[] projection) throws FileNotFoundException {
...
    // If user is not logged in, return an empty root cursor.  This removes our
    // provider from the list entirely.
    if (!isUserLoggedIn()) {
        return result;
}
</pre>

<p>Следующий шаг состоит в вызове метода <code>getContentResolver().notifyChange()</code>.
Помните объект <code><a href="https://developer.android.com/reference/android/provider/DocumentsContract.html?hl=ru">DocumentsContract</a></code>?  Воспользуемся им для создания
соответствующего URI. В следующем фрагменте кода система извещается о необходимости опрашивать корневые каталоги
поставщика документов, когда меняется статус входа пользователя в систему. Если пользователь не
выполнил вход, метод <code><a href="https://developer.android.com/reference/android/provider/DocumentsProvider.html?hl=ru#queryRoots(java.lang.String[])">queryRoots()</a></code> возвратит
пустой курсор, как показано выше. Это гарантирует, что документы поставщика будут
доступны только пользователям, вошедшим в поставщик.</p>

<pre>private void onLoginButtonClick() {
    loginOrLogout();
    getContentResolver().notifyChange(DocumentsContract
            .buildRootsUri(AUTHORITY), null);
}
</pre>


    </div>

    

  
    
  
    



<div class="wrap">
  <footer class="dac-footer ">
    <div class="cols dac-footer-main">
      <div class="col-1of2">
        <div class="dac-footer-contact">
          <a class="dac-footer-contact-link" href="https://developer.android.com/newsletter/index.html?hl=ru" title="Newsletter">Newsletter</a>
          <a class="dac-footer-contact-link" href="https://android-developers.blogspot.com/" title="Блог" target="_blank">Блог</a>
          <a class="dac-footer-contact-link" href="https://developer.android.com/support.html?hl=ru" title="Поддержка">Поддержка</a>
        </div>
      </div>
      <div class="col-1of2 dac-footer-reachout">
        <div class="dac-footer-social">
          <a class="dac-button-social dac-youtube dac-footer-social-link" href="https://www.youtube.com/user/androiddevelopers" title="Android Developers on YouTube" target="_blank"><i class="dac-sprite dac-youtube"></i><span class="hide-text">Android Developers on YouTube</span></a>
          <a class="dac-button-social dac-gplus dac-footer-social-link" href="https://plus.google.com/+AndroidDevelopers" title="Android Developers on Google+" target="_blank"><i class="dac-sprite dac-gplus"></i><span class="hide-text">Android Developers on Google+</span></a>
          <a class="dac-button-social dac-twitter dac-footer-social-link" href="https://twitter.com/AndroidDev" title="Android Developers on Twitter" target="_blank"><i class="dac-sprite dac-twitter"></i><span class="hide-text">Android Developers on Twitter</span></a>
        </div>
      </div>
    </div>

    <hr class="dac-footer-separator"/>
      
      <p class="dac-footer-copyright">
        
        Except as noted, this content is licensed under <a href="http://creativecommons.org/licenses/by/2.5/" target="_blank">Creative Commons Attribution 2.5</a>. For details and restrictions, see the <a href="https://developer.android.com/license.html">Content License</a>.
      </p>
    

    <p class="dac-footer-links">
      <a href="https://www.android.com/" title="Android.com" target="_blank">Android.com</a>
      <a href="https://developer.android.com/?hl=ru" title="Android Developers">Android Developers</a>
      <a href="https://developer.android.com/studio/index.html?hl=ru" title="Android Studio">Android Studio</a>
      <a href="https://developer.android.com/distribute/console/index.html?hl=ru" title="Google Play Console">Google Play Console</a>
      <a href="https://developer.android.com/legal.html?hl=ru" title="Legal Notice">Legal Notice</a>
    </p>

    <!-- TODO(akassay) Update all DAC js to use the class instead of the id b/30368561 -->
    <form class="devsite-utility-footer-language" id="setlang" action="https://developer.android.com/i18n/setlang/" method="post">
      <input type="hidden" name="xsrf_token" value="vshpW1OWsiGiMJjoSsiIbiN8XSQyC_9eecikNrm38eA6MTQ5NzUxNjM0NTkyOTEyMA" />
      <input type="hidden" name="next" value="document-provider.html">
      <span id="language" class="locales">
        <select class="devsite-utility-footer-language-select" name="language">
          
          <option value="id"
            >
            Bahasa Indonesia
          </option>
          
          <option value="de"
            >
            Deutsch
          </option>
          
          <option value="en"
            >
            English
          </option>
          
          <option value="es"
            >
            español
          </option>
          
          <option value="es-419"
            >
            Español (América Latina)
          </option>
          
          <option value="fr"
            >
            français
          </option>
          
          <option value="pt-br"
            >
            Português Brasileiro
          </option>
          
          <option value="vi"
            >
            Tiếng Việt
          </option>
          
          <option value="tr"
            >
            Türkçe
          </option>
          
          <option value="ru"
             selected="selected" >
            Русский
          </option>
          
          <option value="th"
            >
            ภาษาไทย
          </option>
          
          <option value="ja"
            >
            日本語
          </option>
          
          <option value="zh-cn"
            >
            简体中文
          </option>
          
          <option value="zh-tw"
            >
            繁體中文
          </option>
          
          <option value="ko"
            >
            한국어
          </option>
          
        </select>
      </span>
    </form>
  </footer>
</div><!--/.wrap -->

<div class="dac-toast-group">
  <div class="dac-toast" data-toast>
    <div class="dac-toast-wrap">
      This site uses cookies to store your preferences for site-specific language and display options.
    </div>
  </div>
</div>

<div data-modal="newsletter" data-newsletter-fb data-swap class="dac-modal newsletter">
  <div class="dac-modal-container">
    <div class="dac-modal-window">
      <header class="dac-modal-header">
        <div class="dac-modal-header-actions">
          <button class="dac-modal-header-close" data-modal-toggle></button>
        </div>
        <div class="dac-swap" data-swap-container>
          <section class="dac-swap-section dac-active dac-down">
            <h2 class="norule dac-modal-header-title" data-t="newsletter.title">Get the latest Android developer news and tips that will help you find success on Google Play.</h2>
            <p class="dac-modal-header-subtitle" data-t="newsletter.requiredHint">* Required Fields</p>
          </section>
          <section class="dac-swap-section dac-up">
            
            <h2 class="norule dac-modal-header-title" data-t="newsletter.successTitle">Hooray!</h2>
          </section>
        </div>
      </header>
      <div class="dac-swap" data-swap-container>
        <section class="dac-swap-section dac-active dac-left">
          <form action="https://services.google.com/fb/submissions/android-developer-mailing-list/" class="dac-form" method="post">
            <section class="dac-modal-content">
              <fieldset class="dac-form-fieldset">
                <div class="cols">
                  <div class="col-1of2 newsletter-leftCol">
                    <div class="dac-form-input-group">
                      <label for="newsletter-full-name" class="dac-form-floatlabel" data-t="newsletter.name">Full name</label>
                      <input type="text" class="dac-form-input" name="fullname" id="newsletter-full-name" required>
                      <span class="dac-form-required">*</span>
                    </div>
                    <div class="dac-form-input-group">
                      <label for="newsletter-email" class="dac-form-floatlabel" data-t="newsletter.email">Адрес электронной почты</label>
                      <input type="email" class="dac-form-input" name="emailaddress" id="newsletter-email" required>
                      <span class="dac-form-required">*</span>
                    </div>
                  </div>
                  <div class="col-1of2 newsletter-rightCol">
                    <div class="dac-form-input-group">
                      <label for="newsletter-company" class="dac-form-floatlabel" data-t="newsletter.company">Company / developer name</label>
                      <input type="text" class="dac-form-input" name="companydevelopername" id="newsletter-company">
                    </div>
                    <div class="dac-form-input-group">
                      <label for="newsletter-play-store" class="dac-form-floatlabel" data-t="newsletter.appUrl">One of your Play Store app URLs</label>
                      <input type="url" class="dac-form-input" name="playstoreappurls" id="newsletter-play-store">
                    </div>
                  </div>
                </div>
              </fieldset>
              <fieldset class="dac-form-fieldset">
                <div class="cols">
                  <div class="col-1of2 newsletter-leftCol newsletter-interested" data-validation-message="Please check at least one item.">
                    <legend class="dac-form-legend">What are you interested in?<span class="dac-form-required">*</span></legend>
                    <div class="dac-form-radio-group">
                      <input type="checkbox" class="dac-form-checkbox" name="interested" id="interested-whats-new" value="whats-new">
                      <label for="interested-whats-new" class="dac-form-checkbox-button"></label>
                      <label for="interested-whats-new" class="dac-form-label">What's new</label>
                    </div>
                    <div class="dac-form-radio-group">
                      <input type="checkbox" class="dac-form-checkbox" name="interested" id="interested-games-updates" value="games-updates">
                      <label for="interested-games-updates" class="dac-form-checkbox-button"></label>
                      <label for="interested-games-updates" class="dac-form-label">Games updates</label>
                    </div>
                    <div class="dac-form-radio-group">
                      <input type="checkbox" class="dac-form-checkbox" name="interested" id="interested-android-development" value="android-development">
                      <label for="interested-android-development" class="dac-form-checkbox-button"></label>
                      <label for="interested-android-development" class="dac-form-label">Android development</label>
                    </div>
                  </div>
                  <div class="col-1of2 newsletter-rightCol newsletter-checkboxes">
                    <div class="dac-form-input-group">
                      <label for="newsletter-receive-in">Receive newsletter in</label>
                      <select name="language" class="dac-form-select" id="newsletter-receive-in">
                        <option value="en-US" selected>English</option>
                        <option value="ar">Arabic</option>
                        <option value="zh">Chinese (Simplified)</option>
                        <option value="zh-TW">Chinese (Traditional)</option>
                        <option value="fr">French</option>
                        <option value="de">German</option>
                        <option value="id">Indonesian (Bahasa)</option>
                        <option value="ja">Japanese</option>
                        <option value="ko">Korean</option>
                        <option value="pt-BR">Portuguese (Brazilian)</option>
                        <option value="ru">Russian</option>
                        <option value="es-419">Spanish (Latin American)</option>
                        <option value="th">Thai</option>
                        <option value="tr">Turkish</option>
                        <option value="vi">Vietnamese</option>
                      </select>
                    </div>
                    <div class="dac-form-radio-group">
                      <div class="dac-media">
                        <div class="dac-media-figure">
                          <input type="checkbox" class="dac-form-checkbox" name="marketingoptin" id="newsletter-add" required value="Add me to the mailing list.">
                          <label for="newsletter-add" class="dac-form-checkbox-button"></label>
                        </div>
                        <div class="dac-media-body">
                          <label for="newsletter-add" class="dac-form-label dac-form-aside">
                            Add me to the mailing list.
                            <span class="dac-form-required">*</span>
                          </label>
                        </div>
                      </div>
                    </div>
                    <div class="dac-form-radio-group">
                      <div class="dac-media">
                        <div class="dac-media-figure">
                          <input type="checkbox" class="dac-form-checkbox" name="privacystatement" id="newsletter-terms" required value="I acknowledge that the information provided in this form will be subject to Google's privacy policy (https://www.google.com/policies/privacy/).">
                          <label for="newsletter-terms" class="dac-form-checkbox-button"></label>
                        </div>
                        <div class="dac-media-body">
                          <label for="newsletter-terms" class="dac-form-label dac-form-aside"><span data-t="newsletter.privacyPolicy" data-t-html>
                            
                            I acknowledge that the information provided in this form will be subject to <a href="https://www.google.com/policies/privacy/">Google's privacy policy</a>.
                          </span>
                          <span class="dac-form-required">*</span></label>
                        </div>
                      </div>
                    </div>
                  </div>
                </div>
              </fieldset>
            </section>
            <input type="hidden" name="referrer" value="dac">
            <footer class="dac-modal-footer">
              <div class="cols">
                <div class="col-2of5">
                </div>
              </div>
              <button type="submit" value="Submit" class="dac-fab dac-primary dac-large dac-modal-action"><i class="dac-sprite dac-arrow-right"></i></button>
            </footer>
          </form>
        </section>
        <section class="dac-swap-section dac-right">
          <div class="dac-modal-content">
            <p class="newsletter-success-message" data-t="newsletter.successDetails">
              You have successfully signed up for the latest Android developer news and tips.
            </p>
          </div>
        </section>
      </div>
    </div>
  </div>
</div><!--/.dac-modal.newsletter-->


<div data-modal="langform" class="dac-modal" id="langform">
  <div class="dac-modal-container">
    <div class="dac-modal-window">
      <header class="dac-modal-header">
        <div class="dac-modal-header-actions">
          <button class="dac-modal-header-close" data-modal-toggle></button>
        </div>
        <section class="dac-swap-section dac-active dac-down">
          <h2 class="norule dac-modal-header-title">
            Browse this site in <span class="span-target-lang"></span>?
          </h2>
        </section>
      </header>
      <section class="dac-swap-section dac-active dac-left">
          <section class="dac-modal-content">
            <fieldset class="dac-form-fieldset">
              <div class="cols">
                <div class="col-2of2 langform-leftCol">
                  <p id="resetLangText">
                    You requested a page in <span class="span-target-lang"></span>, but your language preference for this site is <span class="span-current-lang"></span>.
                  </p>
                  <p id="resetLangCta">
                    Would you like to change your language preference and browse this site in <span class="span-target-lang"></span>? If you want to change your language preference later, use the language menu at the bottom of each page.
                  </p>
                </div>
              </div>
            </fieldset>
          </section>
          <footer class="dac-modal-footer" id="langfooter">
            <div class="cols">
              <div class="col-2of5">
              </div>
            </div>
            <a href="#" class="yes" onclick="return false;">
              <button class="button dac-primary dac-modal-action lang yes" data-t="newsletter.resetLangButtonYes" data-modal-toggle>
                Change Language
              </button>
            </a>
            <a href="#" class="" onclick="return false;">
              <button class="button dac-primary dac-modal-action lang no" data-t="newsletter.resetLangButtonNo" data-modal-toggle>
                Not Now
              </button>
            </a>
          </footer>
        </form>
      </section>
    </div>
  </div>
</div><!--/.dac-modal-->


<div data-modal="api-unavailable" class="dac-modal" id="api-unavailable">
  <div class="dac-modal-container">
    <div class="dac-modal-window">
      <header class="dac-modal-header">
        <div class="dac-modal-header-actions">
          <button class="dac-modal-header-close" data-modal-toggle></button>
        </div>
        <section class="dac-swap-section dac-active dac-down">
          <h2 class="norule dac-modal-header-title">
            This class requires API level <span class="api-level"></span> or higher
          </h2>
        </section>
      </header>
      <section class="dac-swap-section dac-active dac-left">
          <section class="dac-modal-content">
            <p>
              This doc is hidden because your selected API level for the documentation is <span class="api-level"></span>. You can change the documentation API level with the selector above the left navigation.
            </p>
            
            <p>For more information about specifying the API level your app requires, read <a href="https://developer.android.com/training/basics/supporting-devices/platforms.html">Supporting Different Platform Versions</a>.</p>
          </section>
          <footer class="dac-modal-footer" id="langfooter">
            <div class="cols">
              <div class="col-2of5">
              </div>
            </div>
            <a href="#" class="ok" onclick="return false;">
              <button class="button dac-primary dac-modal-action ok"
              data-modal-toggle>
                OK, make this page visible
              </button>
            </a>
          </footer>
        </form>
      </section>
    </div>
  </div>
</div><!--/.dac-modal#api-unavailable-->

    
  </div><!--/#body-content-->

  <!-- Nav Setup -->
  <script>$('[data-dac-nav]').dacNav();</script>
  <script type="text/javascript">
    $('.slideshow-container').dacSlideshow({
        btnPrev: '.slideshow-prev',
        btnNext: '.slideshow-next',
        btnPause: '#pauseButton'
    });

    $(".feed").dacTabbedList({
      nav_id: '.feed-nav',
      frame_id: '.feed-frame'
    });
  </script>
  
  <script src="../../../ytblogger_lists_unified05ec.js?hl=ru?v=2017061508" defer></script>
  <script src="../../../android_metadata_en05ec.js?hl=ru?v=2017061508" defer></script>
  
  <script src="../../../reference/lists05ec.js?hl=ru?v=2017061508" defer></script>
  <script src="../../../reference/gms_lists05ec.js?hl=ru?v=2017061508" defer></script>
  <script src="../../../reference/android/support/wearable/lists05ec.js?hl=ru?v=2017061508" defer></script>
  <script src="../../../reference/android/support/test/lists05ec.js?hl=ru?v=2017061508" defer></script>
  <script src="../../../reference/android/support/constraint/lists05ec.js?hl=ru?v=2017061508" defer></script>
  <script src="https://developer.android.com/_static2/f304fc21fa/jsi18n/?hl=ru"></script>
  <script>
    // Load localized metadata.
    (function(lang) {
      if (lang === 'en') { return; }
      document.write('<script src="https://developer.android.com/android_metadata_ru.js?hl=ru?v=2017061508" defer></' + 'script>');
    })(getLangPref())

    // Add skip to content for accessibility.
    $('#skip-to-main').click(function() {
      $('a[name=top]').focus();
    });

    $('.devsite-utility-footer-language-select').each(function() {
      $(this).change(function() {
        changeLangPref(this.value, true)
        $('.devsite-utility-footer-language').submit();
      });
    });
  </script>

  <script>
    (function($) {
      devsite.analytics.InitAnalytics();
    })(jQuery);
  </script>

  


<div id="survey-box-wrapper">
  <div class="material-dialog" style="width:270px">
    <div class="material-dialog-title">
      Take a one-minute survey?
    </div>
    <div class="material-dialog-description">
      Help us improve Android tools and documentation.
    </div>
    <div class="material-button-bar">
      <a class="dac-button dac-primary dac-raised" target="_blank"
          href="https://goo.gl/forms/kV7MoyD2dvcWkd5N2">Sure</a>
      <a class="dac-button" href="#">No thanks</a>
    </div>
  </div>
</div>

</body>

<!-- Mirrored from developer.android.com/guide/topics/providers/document-provider.html?hl=ru by HTTrack Website Copier/3.x [XR&CO'2014], Thu, 15 Jun 2017 09:06:48 GMT -->
</html>
