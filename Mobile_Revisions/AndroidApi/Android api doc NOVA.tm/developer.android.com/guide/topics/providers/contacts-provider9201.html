





<!DOCTYPE html>
<html lang="ru">

<!-- Mirrored from developer.android.com/guide/topics/providers/contacts-provider.html?hl=ru by HTTrack Website Copier/3.x [XR&CO'2014], Thu, 15 Jun 2017 09:06:45 GMT -->
<!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=utf-8" /><!-- /Added by HTTrack -->
<head>

  



<meta name="viewport" content="width=device-width,initial-scale=1.0,minimum-scale=1.0,maximum-scale=1.0,user-scalable=no">
<meta content="IE=edge" http-equiv="X-UA-Compatible">





<script>var a=window.devsite||{};window.devsite=a;a.readyCallbacks=[];window.devsite.readyCallbacks=a.readyCallbacks;a.ready=function(b){a.readyCallbacks.push(b)};window.devsite.ready=a.ready;
</script>

<meta charset="utf-8">



<meta name="xsrf_token" content="e-8bz1jY5EGxMTVua6DEj0po3O4S7Ee9nDs1TpjLOC06MTQ5NzUxNjM0NTI4Mzk3MA" />

  
    <link rel="canonical" href="contacts-provider9201.html?hl=ru">
  

  
    <link rel="alternate" href="contacts-provider327f.html?hl=vi" hreflang="vi">
  
    <link rel="alternate" href="contacts-providerf854.html?hl=zh-tw" hreflang="zh-Hant">
  
    <link rel="alternate" href="contacts-provider9201.html?hl=ru" hreflang="ru">
  
    <link rel="alternate" href="contacts-provider.html" hreflang="en">
  
    <link rel="alternate" href="contacts-provider0b8e.html?hl=zh-cn" hreflang="zh-Hans">
  
    <link rel="alternate" href="contacts-provider7554.html?hl=es-419" hreflang="es-419">
  
    <link rel="alternate" href="contacts-providerde3a.html?hl=es" hreflang="es">
  
    <link rel="alternate" href="contacts-provider9e29.html?hl=ja" hreflang="ja">
  
    <link rel="alternate" href="contacts-provider232e.html?hl=ko" hreflang="ko">
  
    <link rel="alternate" href="contacts-provider0cf2.html?hl=id" hreflang="id">
  
    <link rel="alternate" href="contacts-provider6dd3.html?hl=pt-br" hreflang="pt-br">
  
    <link rel="alternate" href="https://developer.android.google.cn/guide/topics/providers/contacts-provider.html?hl=vi" hreflang="vi-cn">
  
    <link rel="alternate" href="https://developer.android.google.cn/guide/topics/providers/contacts-provider.html?hl=zh-tw" hreflang="zh-Hant-cn">
  
    <link rel="alternate" href="https://developer.android.google.cn/guide/topics/providers/contacts-provider.html?hl=ru" hreflang="ru-cn">
  
    <link rel="alternate" href="https://developer.android.google.cn/guide/topics/providers/contacts-provider.html" hreflang="en-cn">
  
    <link rel="alternate" href="https://developer.android.google.cn/guide/topics/providers/contacts-provider.html?hl=zh-cn" hreflang="zh-Hans-cn">
  
    <link rel="alternate" href="https://developer.android.google.cn/guide/topics/providers/contacts-provider.html?hl=es-419" hreflang="es-419-cn">
  
    <link rel="alternate" href="https://developer.android.google.cn/guide/topics/providers/contacts-provider.html?hl=es" hreflang="es-cn">
  
    <link rel="alternate" href="https://developer.android.google.cn/guide/topics/providers/contacts-provider.html?hl=ja" hreflang="ja-cn">
  
    <link rel="alternate" href="https://developer.android.google.cn/guide/topics/providers/contacts-provider.html?hl=ko" hreflang="ko-cn">
  
    <link rel="alternate" href="https://developer.android.google.cn/guide/topics/providers/contacts-provider.html?hl=id" hreflang="id-cn">
  
    <link rel="alternate" href="https://developer.android.google.cn/guide/topics/providers/contacts-provider.html?hl=pt-br" hreflang="pt-br-cn">
  

  <link rel="alternate" href="contacts-provider.html" hreflang="x-default">




<link rel="shortcut icon" href="../../../_static/f304fc21fa/images/android/favicon9201.png?hl=ru">

<link rel="apple-touch-icon" href="../../../_static/f304fc21fa/images/android/touchicon-1809201.png?hl=ru">


<title>

  Поставщик контактов | Android Developers

</title>

  <meta name="description" content="Поставщик контактов представляет собой эффективный и гибкий компонент Android, который управляет центральным репозиторием устройства, в котором хранятся пользовательские данные. Поставщик контактов — это источник данных, которые отображаются в приложении…">


<!-- STYLESHEETS -->
<link rel="stylesheet" href="http://fonts.googleapis.com/css?family=Roboto+Condensed">
<link rel="stylesheet"
    href="http://fonts.googleapis.com/css?family=Roboto:light,regular,medium,thin,italic,mediumitalic,bold"
    title="roboto">







<link href="../../../static/css/default05ec.css?hl=ru?v=2017061508" rel="stylesheet" type="text/css">
<!-- JAVASCRIPT -->
<script src="../../../_static/f304fc21fa/js/android_3p-bundle9201.js?hl=ru" type="text/javascript"></script>
<script src="../../../_static/f304fc21fa/js/script_foot_closure_android__ru9201.js?hl=ru"></script>
<script src="../../../_static/f304fc21fa/js/script_foot_android9201.js?hl=ru"></script>

<script type="text/javascript">
  var toRoot = 'https://developer.android.com/';
  devsite.permissions.init({"039e5d84b87fd75807ffb37b7f1bbf2c": true, "098dafe57affddc137df300142652cfd": false, "cb025a64a50094835616312f4774a53d": true, "51470233c56fc1fde50f00b73c52b216": false, "752953480de00a336d911a46966cc16d": false, "700def1a83e356c06c0925afb05de4b0": false, "6749dcb526ce9bde6993550c7d928d24": true});

  var replaceBlog = false;
  var replaceYouTube = false;
  var siteDefaultLocale = 'en';

  var ANDROID_LANGUAGES = [
      'id','de','en','es','es-419','fr','pt-br','vi','tr','ru','th','ja','zh-cn','zh-tw','ko'
  ];
</script>
<script src="../../../static/js/docs05ec.js?hl=ru?v=2017061508" type="text/javascript"></script>


</head>

<body class="gc-documentation
            
            
              develop
              guide
            
            "
      itemscope itemtype="http://schema.org/Article">
  


  
    <input class="google-analytics-id-json" type="hidden" value="{&quot;dimensions&quot;: {&quot;dimension6&quot;: &quot;ru&quot;, &quot;dimension4&quot;: &quot;API Guides&quot;, &quot;dimension5&quot;: &quot;ru&quot;, &quot;dimension3&quot;: false, &quot;dimension1&quot;: &quot;Signed out&quot;, &quot;dimension8&quot;: null}, &quot;gaid&quot;: &quot;UA-49880327-2&quot;}">
  
    <input class="google-analytics-id-json" type="hidden" value="{&quot;dimensions&quot;: {&quot;dimension6&quot;: &quot;ru&quot;, &quot;dimension4&quot;: &quot;API Guides&quot;, &quot;dimension5&quot;: &quot;ru&quot;, &quot;dimension3&quot;: false, &quot;dimension1&quot;: &quot;Signed out&quot;, &quot;dimension8&quot;: null}, &quot;gaid&quot;: &quot;UA-5831155-1&quot;}">
  



  
  
    <script>
      var dataLayer = [{"freeTrialEligibleUser": "False", "userCountry": "BE", "language": {"requested": "ru", "served": "ru"}, "projectName": "API Guides", "scriptsafe": null, "signedIn": "False", "internalUser": "False"}];
    </script>
  



  
  <a href="#top" id="skip-to-main">Skip to content</a>
  <header id="header-wrapper">
    <div class="dac-header" id="header">
      <div class="dac-header-inner">
        <a class="dac-nav-toggle" data-dac-toggle-nav href="#" title="Open navigation">
          <span class="dac-nav-hamburger">
            <span class="dac-nav-hamburger-top"></span>
            <span class="dac-nav-hamburger-mid"></span>
            <span class="dac-nav-hamburger-bot"></span>
          </span>
        </a>
        
        <a class="dac-header-logo" href="https://developer.android.com/index.html?hl=ru">
          <img class="dac-header-logo-image" src="../../../static/images/android_logo9201.png?hl=ru"
              srcset="https://developer.android.com/static/images/android_logo_2x.png 2x?hl=ru"
              width="32" height="36" alt="Android"> Developers</a>
        <ul class="dac-header-tabs">
          <li>
            <a class="dac-header-tab" href="https://developer.android.com/design/index.html?hl=ru"
               zh-tw-lang="設計"
               zh-cn-lang="设计"
               ru-lang="Проектирование"
               ko-lang="디자인"
               ja-lang="設計"
               es-lang="Diseñar">Design</a>
          </li>
          <li>
            <a class="dac-header-tab" href="https://developer.android.com/develop/index.html?hl=ru"
               zh-tw-lang="開發"
               zh-cn-lang="开发"
               ru-lang="Разработка"
               ko-lang="개발"
               ja-lang="開発"
               es-lang="Desarrollar">Develop</a>
          </li>
          <li>
            <a class="dac-header-tab" href="https://developer.android.com/distribute/index.html?hl=ru"
               zh-tw-lang="發佈"
               zh-cn-lang="分发"
               ru-lang="Распространение"
               ko-lang="배포"
               ja-lang="配布"
               es-lang="Distribuir">Distribute</a>
          </li>
        </ul>


        

        <a class="dac-header-console-btn gc-analytics-event" href="https://play.google.com/apps/publish/"
           data-category="User" data-action="Console" data-label="Clicked">
          <img src="https://developer.android.com/static/images/developer-console-icon.svg?hl=ru" width="18" height="19" alt="Play Console">Play Console</a>

        

<form data-search="" class="dac-header-search">
  <button class="dac-header-search-close" data-search-close="">
    <i class="dac-sprite dac-back-arrow"></i>
  </button>

  <div class="dac-header-search-inner">
    <i class="dac-sprite dac-search-white dac-header-search-icon"></i>
    
    <input id="search_autocomplete" type="text" value="" autocomplete="off" name="q" class="dac-header-search-input" placeholder="Поиск">
    <button class="dac-header-search-clear dac-hidden" data-search-clear="">
      <i class="dac-sprite dac-close-black"></i>
    </button>
  </div>
</form>

        
      </div><!--/.header-wrap.wrap-->
    </div><!--/.header-->

    

<div id="search-results" class="dac-search-results">
  <div id="dac-search-results-history" class="dac-search-results-history">
    <div class="wrap dac-search-results-history-wrap">
      <div class="cols">
        <div class="col-1of2 col-tablet-1of2 col-mobile-1of1">
          <h2>Most visited</h2>
          <div class="resource-flow-layout" data-history-query="history:most/visited" data-maxresults="3" data-cardsizes="18x2"></div>
        </div>

        <div class="col-1of2 col-tablet-1of2 col-mobile-1of1">
          <h2>Recently visited</h2>
          <div class="resource-flow-layout cols" data-history-query="history:recent" data-allow-duplicates="true" data-maxresults="3" data-cardsizes="18x2"></div>
        </div>
      </div>
    </div>
  </div>

  <div id="dac-search-results-content" class="dac-search-results-content">
    <div class="dac-search-results-metadata wrap">
      <div class="dac-search-results-for">
        
          <h2>
          Results for <span id="search-results-for"></span>
          </h2>
      </div>

      <div id="dac-search-results-hero"></div>

      <div class="dac-search-results-hero cols">
        <div id="dac-search-results-reference" class="col-6of6 col-tablet-2of2 col-mobile-1of1">
          <div class="suggest-card reference no-display">
            <ul class="dac-search-results-reference">
            </ul>
          </div>
        </div>
      </div>

      <div class="cols dac-search-results-cse">
        <script src="../../../../cse.google.com/f4116.txt?cx=000521750095050289010:zpcpi1ea4s8" async></script>
        <gcse:searchresults-only linkTarget="_self"></gcse:searchresults-only>
      </div>
    </div>
  </div>
</div>

  </header>

  <a name="navigation" tabindex=0 class="nav-start-marker">navigation</a>
  <nav class="dac-nav">
    <div class="dac-nav-dimmer" data-dac-toggle-nav></div>
    <div class="dac-nav-sidebar" data-swap data-dynamic="false" data-transition-speed="300" data-dac-nav>
      <div data-swap-container>
        
        <a class="dac-nav-back-button dac-swap-section dac-up dac-no-anim" tabindex=0 data-swap-button>
          
          <i class="dac-sprite dac-nav-back"></i> <span class="dac-nav-back-title">Назад</span>
        </a>

        <div class="dac-nav-sub dac-swap-section dac-right dac-active" itemscope
            itemtype="http://schema.org/SiteNavigationElement">
          
          
            
            <ul id="nav">
              <li class="nav-section"><div class="nav-section-header"><a href="../../index9201.html?hl=ru" >Introduction</a><span class="toggle-icon" tabindex="0"></span></div><ul><li><a href="../../components/fundamentals9201.html?hl=ru" >App Fundamentals</a></li><li><a href="../../practices/compatibility9201.html?hl=ru" >Device Compatibility</a></li><li class="nav-section"><div class="nav-section-header"><a href="../permissions/index9201.html?hl=ru" >System Permissions</a><span class="toggle-icon" tabindex="0"></span></div><ul><li><a href="../permissions/requesting9201.html?hl=ru" >Requesting Permissions</a></li><li><a href="../permissions/defining9201.html?hl=ru" >Defining Permissions</a></li></ul></li></ul></li><li class="nav-section"><div class="nav-section-header"><a href="../../platform/index9201.html?hl=ru" >Platform Architecture</a><span class="toggle-icon" tabindex="0"></span></div><ul><li><a href="../../platform/j8-jack9201.html?hl=ru"  es-lang="Funciones del lenguaje Java 8" in-lang="Fitur Bahasa Java 8" ja-lang="Java 8 の機能" ko-lang="Java 8 언어 기능" pt-br-lang="Recursos de linguagem do Java 8" ru-lang="Возможности языка Java 8" vi-lang="Tính năng của Ngôn ngữ Java 8" zh-cn-lang="Java 8 语言功能" zh-tw-lang="Java 8 語言功能">Use Java 8 Language Features</a></li><li><a href="../../practices/verifying-apps-art9201.html?hl=ru" >Verifying App Behavior on the Android Runtime (ART)</a></li></ul></li><li class="nav-section"><div class="nav-section-header"><a href="../../components/index9201.html?hl=ru" >App Components</a><span class="toggle-icon" tabindex="0"></span></div><ul><li class="nav-section"><div class="nav-section-header"><a href="../../components/intents-filters9201.html?hl=ru" >Intents and Intent Filters</a><span class="toggle-icon" tabindex="0"></span></div><ul><li><a href="../../components/intents-common9201.html?hl=ru" >Common Intents</a></li></ul></li><li class="nav-section"><div class="nav-section-header"><a href="../../components/activities/index9201.html?hl=ru" >Activities</a><span class="toggle-icon" tabindex="0"></span></div><ul><li><a href="../../components/activities/intro-activities9201.html?hl=ru" >Introduction to Activities</a></li><li><a href="../../components/activities/activity-lifecycle9201.html?hl=ru" >The Activity Lifecycle</a></li><li><a href="../../components/activities/state-changes9201.html?hl=ru" >Activity State Changes</a></li><li><a href="../../components/activities/tasks-and-back-stack9201.html?hl=ru" >Tasks and Back Stack</a></li><li><a href="../../components/activities/process-lifecycle9201.html?hl=ru" >Processes and Application Lifecycle</a></li><li><a href="../../components/activities/parcelables-and-bundles9201.html?hl=ru" >Parcelables and Bundles</a></li><li><a href="../../components/activities/recents9201.html?hl=ru" >Recents Screen</a></li></ul></li><li><a href="../../components/fragments9201.html?hl=ru" >Fragments</a></li><li><a href="../../components/loaders9201.html?hl=ru" >Loaders</a></li><li class="nav-section"><div class="nav-section-header"><a href="../../components/services9201.html?hl=ru" >Services</a><span class="toggle-icon" tabindex="0"></span></div><ul><li><a href="../../components/bound-services9201.html?hl=ru" >Bound Services</a></li><li><a href="../../components/aidl9201.html?hl=ru" >AIDL</a></li></ul></li><li class="nav-section"><div class="nav-section-header"><a href="content-providers9201.html?hl=ru" >Content Providers</a><span class="toggle-icon" tabindex="0"></span></div><ul><li><a href="content-provider-basics9201.html?hl=ru" >Content Provider Basics</a></li><li><a href="content-provider-creating9201.html?hl=ru" >Creating a Content Provider</a></li><li><a href="calendar-provider9201.html?hl=ru" >Calendar Provider</a></li><li><a href="contacts-provider9201.html?hl=ru" >Contacts Provider</a></li><li><a href="document-provider9201.html?hl=ru" >Open files using Storage Access Framework</a></li><li><a href="create-document-provider9201.html?hl=ru" >Create a Custom Document Provider</a></li></ul></li><li><a href="../../components/broadcasts9201.html?hl=ru" >Broadcasts</a></li><li class="nav-section"><div class="nav-section-header"><a href="../appwidgets/index9201.html?hl=ru" >App Widgets</a><span class="toggle-icon" tabindex="0"></span></div><ul><li><a href="../appwidgets/host9201.html?hl=ru" >App Widget Host</a></li></ul></li><li><a href="../../components/processes-and-threads9201.html?hl=ru" >Processes and Threads</a></li></ul></li><li class="nav-section"><div class="nav-section-header"><a href="../resources/index9201.html?hl=ru" >App Resources</a><span class="toggle-icon" tabindex="0"></span></div><ul><li><a href="../resources/overview9201.html?hl=ru" >Overview</a></li><li><a href="../resources/providing-resources9201.html?hl=ru" >Providing Resources</a></li><li><a href="../resources/accessing-resources9201.html?hl=ru" >Accessing Resources</a></li><li><a href="../resources/runtime-changes9201.html?hl=ru" >Handling Runtime Changes</a></li><li class="nav-section"><div class="nav-section-header"><a href="../resources/localization9201.html?hl=ru" >Localization</a><span class="toggle-icon" tabindex="0"></span></div><ul><li><a href="../resources/icu4j-framework9201.html?hl=ru" >ICU4J Android Framework APIs</a></li><li><a href="../resources/multilingual-support9201.html?hl=ru" >Language and Locale</a></li></ul></li><li><a href="../resources/complex-xml-resources9201.html?hl=ru" >Complex XML Resources</a></li><li class="nav-section"><div class="nav-section-header"><a href="../resources/available-resources9201.html?hl=ru" >Resource Types</a><span class="toggle-icon" tabindex="0"></span></div><ul><li><a href="../resources/animation-resource9201.html?hl=ru" >Animation</a></li><li><a href="../resources/color-list-resource9201.html?hl=ru" >Color State List</a></li><li><a href="../resources/drawable-resource9201.html?hl=ru" >Drawable</a></li><li><a href="../resources/layout-resource9201.html?hl=ru" >Layout</a></li><li><a href="../resources/menu-resource9201.html?hl=ru" >Menu</a></li><li><a href="../resources/string-resource9201.html?hl=ru" >String</a></li><li><a href="../resources/style-resource9201.html?hl=ru" >Style</a></li><li><a href="../resources/more-resources9201.html?hl=ru" >More Types</a></li></ul></li></ul></li><li class="nav-section"><div class="nav-section-header"><a href="../manifest/manifest-intro9201.html?hl=ru" >App Manifest</a><span class="toggle-icon" tabindex="0"></span></div><ul><li><a href="../manifest/action-element9201.html?hl=ru" >&lt;action&gt;</a></li><li><a href="../manifest/activity-element9201.html?hl=ru" >&lt;activity&gt;</a></li><li><a href="../manifest/activity-alias-element9201.html?hl=ru" >&lt;activity-alias&gt;</a></li><li><a href="../manifest/application-element9201.html?hl=ru" >&lt;application&gt;</a></li><li><a href="../manifest/category-element9201.html?hl=ru" >&lt;category&gt;</a></li><li><a href="../manifest/compatible-screens-element9201.html?hl=ru" >&lt;compatible-screens&gt;</a></li><li><a href="../manifest/data-element9201.html?hl=ru" >&lt;data&gt;</a></li><li><a href="../manifest/grant-uri-permission-element9201.html?hl=ru" >&lt;grant-uri-permission&gt;</a></li><li><a href="../manifest/instrumentation-element9201.html?hl=ru" >&lt;instrumentation&gt;</a></li><li><a href="../manifest/intent-filter-element9201.html?hl=ru" >&lt;intent-filter&gt;</a></li><li><a href="../manifest/manifest-element9201.html?hl=ru" >&lt;manifest&gt;</a></li><li><a href="../manifest/meta-data-element9201.html?hl=ru" >&lt;meta-data&gt;</a></li><li><a href="../manifest/path-permission-element9201.html?hl=ru" >&lt;path-permission&gt;</a></li><li><a href="../manifest/permission-element9201.html?hl=ru" >&lt;permission&gt;</a></li><li><a href="../manifest/permission-group-element9201.html?hl=ru" >&lt;permission-group&gt;</a></li><li><a href="../manifest/permission-tree-element9201.html?hl=ru" >&lt;permission-tree&gt;</a></li><li><a href="../manifest/provider-element9201.html?hl=ru" >&lt;provider&gt;</a></li><li><a href="../manifest/receiver-element9201.html?hl=ru" >&lt;receiver&gt;</a></li><li><a href="../manifest/service-element9201.html?hl=ru" >&lt;service&gt;</a></li><li><a href="../manifest/supports-gl-texture-element9201.html?hl=ru" >&lt;supports-gl-texture&gt;</a></li><li><a href="../manifest/supports-screens-element9201.html?hl=ru" >&lt;supports-screens&gt;</a></li><li><a href="../manifest/uses-configuration-element9201.html?hl=ru" >&lt;uses-configuration&gt;</a></li><li><a href="../manifest/uses-feature-element9201.html?hl=ru" >&lt;uses-feature&gt;</a></li><li><a href="../manifest/uses-library-element9201.html?hl=ru" >&lt;uses-library&gt;</a></li><li><a href="../manifest/uses-permission-element9201.html?hl=ru" >&lt;uses-permission&gt;</a></li><li><a href="../manifest/uses-permission-sdk-23-element9201.html?hl=ru" >&lt;uses-permission-sdk-23&gt;</a></li><li><a href="../manifest/uses-sdk-element9201.html?hl=ru" >&lt;uses-sdk&gt;</a></li></ul></li><li class="nav-section"><div class="nav-section-header"><a href="../ui/index9201.html?hl=ru" >User Interface</a><span class="toggle-icon" tabindex="0"></span></div><ul><li><a href="../ui/overview9201.html?hl=ru" >Overview</a></li><li class="nav-section"><div class="nav-section-header"><a href="../ui/declaring-layout9201.html?hl=ru" >Layouts</a><span class="toggle-icon" tabindex="0"></span></div><ul><li><a href="../ui/layout/linear9201.html?hl=ru" >Linear Layout</a></li><li><a href="../ui/layout/relative9201.html?hl=ru" >Relative Layout</a></li><li><a href="../ui/layout/recyclerview9201.html?hl=ru" >Recycler View</a></li><li><a href="../ui/layout/listview9201.html?hl=ru" >List View</a></li><li><a href="../ui/layout/gridview9201.html?hl=ru" >Grid View</a></li></ul></li><li class="nav-section"><div class="nav-section-header"><a href="../ui/controls9201.html?hl=ru" >Input Controls</a><span class="toggle-icon" tabindex="0"></span></div><ul><li><a href="../ui/controls/button9201.html?hl=ru" >Buttons</a></li><li><a href="../ui/controls/checkbox9201.html?hl=ru" >Checkboxes</a></li><li><a href="../ui/controls/radiobutton9201.html?hl=ru" >Radio Buttons</a></li><li><a href="../ui/controls/togglebutton9201.html?hl=ru" >Toggle Buttons</a></li><li><a href="../ui/controls/spinner9201.html?hl=ru" >Spinners</a></li><li><a href="../ui/controls/pickers9201.html?hl=ru" >Pickers</a></li></ul></li><li><a href="../ui/ui-events9201.html?hl=ru" >Input Events</a></li><li><a href="../ui/menus9201.html?hl=ru" >Menus</a></li><li><a href="../ui/settings9201.html?hl=ru" >Settings</a></li><li><a href="../ui/dialogs9201.html?hl=ru" >Dialogs</a></li><li><a href="../ui/notifiers/notifications9201.html?hl=ru" >Notifications</a></li><li><a href="../ui/notifiers/toasts9201.html?hl=ru" >Toasts</a></li><li><a href="../ui/shortcuts9201.html?hl=ru" >App Shortcuts</a></li><li class="nav-section"><div class="nav-section-header"><a href="../search/index9201.html?hl=ru" >Search</a><span class="toggle-icon" tabindex="0"></span></div><ul><li><a href="../search/search-dialog9201.html?hl=ru" >Creating a Search Interface</a></li><li><a href="../search/adding-recent-query-suggestions9201.html?hl=ru" >Adding Recent Query Suggestions</a></li><li><a href="../search/adding-custom-suggestions9201.html?hl=ru" >Adding Custom Suggestions</a></li><li><a href="../search/searchable-config9201.html?hl=ru" >Searchable Configuration</a></li></ul></li><li><a href="../ui/multi-window9201.html?hl=ru" >Multi-Window Support</a></li><li><a href="../ui/drag-drop9201.html?hl=ru" >Drag and Drop</a></li><li class="nav-section"><div class="nav-section-header"><a href="../ui/accessibility/index9201.html?hl=ru" >Accessibility</a><span class="toggle-icon" tabindex="0"></span></div><ul><li><a href="../ui/accessibility/apps9201.html?hl=ru" >Making Apps More Accessible</a></li><li><a href="../ui/accessibility/checklist9201.html?hl=ru" >Accessibility Developer Checklist</a></li><li><a href="../ui/accessibility/node-tree-debugging9201.html?hl=ru" >Using Node Tree Debugging</a></li><li><a href="../ui/accessibility/services9201.html?hl=ru" >Building Accessibility Services</a></li><li><a href="../ui/accessibility/custom-views9201.html?hl=ru" >Building Accessible Custom Views</a></li></ul></li><li><a href="../ui/themes9201.html?hl=ru" >Styles and Themes</a></li><li><a href="../ui/custom-components9201.html?hl=ru" >Custom Components</a></li></ul></li><li class="nav-section"><div class="nav-section-header"><a href="../graphics/index9201.html?hl=ru" >Animation and Graphics</a><span class="toggle-icon" tabindex="0"></span></div><ul><li><a href="../graphics/overview9201.html?hl=ru" >Overview</a></li><li><a href="../graphics/prop-animation9201.html?hl=ru" >Property Animation</a></li><li><a href="../graphics/view-animation9201.html?hl=ru" >View Animation</a></li><li><a href="../graphics/drawable-animation9201.html?hl=ru" >Drawable Animation</a></li><li class="nav-section"><div class="nav-section-header"><a href="../graphics/2d-graphics9201.html?hl=ru" >Canvas and Drawables</a><span class="toggle-icon" tabindex="0"></span></div><ul><li><a href="../graphics/vector-drawable-resources9201.html?hl=ru" >Vector Drawable</a></li></ul></li><li><a href="../graphics/opengl9201.html?hl=ru" >OpenGL ES</a></li><li><a href="../graphics/hardware-accel9201.html?hl=ru" >Hardware Acceleration</a></li></ul></li><li class="nav-section"><div class="nav-section-header"><a href="../renderscript/index9201.html?hl=ru" >Computation</a><span class="toggle-icon" tabindex="0"></span></div><ul><li><a href="../renderscript/compute9201.html?hl=ru" >RenderScript</a></li><li><a href="../renderscript/advanced9201.html?hl=ru" >Advanced RenderScript</a></li><li class="nav-section"><div class="nav-section-header"><a href="../renderscript/reference/overview9201.html?hl=ru" >Runtime API Reference</a><span class="toggle-icon" tabindex="0"></span></div><ul><li><a href="../renderscript/reference/rs_value_types9201.html?hl=ru" >Numerical Types</a></li><li><a href="../renderscript/reference/rs_object_types9201.html?hl=ru" >Object Types</a></li><li><a href="../renderscript/reference/rs_convert9201.html?hl=ru" >Conversion Functions</a></li><li><a href="../renderscript/reference/rs_math9201.html?hl=ru" >Mathematical Constants and Functions</a></li><li><a href="../renderscript/reference/rs_vector_math9201.html?hl=ru" >Vector Math Functions</a></li><li><a href="../renderscript/reference/rs_matrix9201.html?hl=ru" >Matrix Functions</a></li><li><a href="../renderscript/reference/rs_quaternion9201.html?hl=ru" >Quaternion Functions</a></li><li><a href="../renderscript/reference/rs_atomic9201.html?hl=ru" >Atomic Update Functions</a></li><li><a href="../renderscript/reference/rs_time9201.html?hl=ru" >Time Functions and Types</a></li><li><a href="../renderscript/reference/rs_allocation_data9201.html?hl=ru" >Allocation Data Access Functions</a></li><li><a href="../renderscript/reference/rs_object_info9201.html?hl=ru" >Object Characteristics Functions</a></li><li><a href="../renderscript/reference/rs_for_each9201.html?hl=ru" >Kernel Invocation Functions and Types</a></li><li><a href="../renderscript/reference/rs_io9201.html?hl=ru" >Input/Output Functions</a></li><li><a href="../renderscript/reference/rs_debug9201.html?hl=ru" >Debugging Functions</a></li><li><a href="../renderscript/reference/rs_graphics9201.html?hl=ru" >Graphics Functions and Types</a></li><li><a href="../renderscript/reference/index9201.html?hl=ru" >Index</a></li></ul></li></ul></li><li class="nav-section"><div class="nav-section-header"><a href="../media-apps/index9201.html?hl=ru" >Media Apps</a><span class="toggle-icon" tabindex="0"></span></div><ul><li><a href="../media-apps/media-apps-overview9201.html?hl=ru" >Media Apps Overview</a></li><li><a href="../media-apps/working-with-a-media-session9201.html?hl=ru" >Working with a Media Session</a></li><li class="nav-section"><div class="nav-section-header"><a href="../media-apps/audio-app/building-an-audio-app9201.html?hl=ru" >Building an Audio App</a><span class="toggle-icon" tabindex="0"></span></div><ul><li><a href="../media-apps/audio-app/building-a-mediabrowserservice9201.html?hl=ru" >Building a Media Browser Service</a></li><li><a href="../media-apps/audio-app/building-a-mediabrowser-client9201.html?hl=ru" >Building a Media Browser Client</a></li><li><a href="../media-apps/audio-app/mediasession-callbacks9201.html?hl=ru" >Media Session Callbacks</a></li></ul></li><li class="nav-section"><div class="nav-section-header"><a href="../media-apps/video-app/building-a-video-app9201.html?hl=ru" >Building a Video App</a><span class="toggle-icon" tabindex="0"></span></div><ul><li><a href="../media-apps/video-app/building-a-video-player-activity9201.html?hl=ru" >Building a Video Player Activity</a></li><li><a href="../media-apps/video-app/mediasession-callbacks9201.html?hl=ru" >Media Session Callbacks</a></li></ul></li><li><a href="../media-apps/mediabuttons9201.html?hl=ru" >Responding to Media Buttons</a></li><li><a href="../media-apps/volume-and-earphones9201.html?hl=ru" >Handling Changes in Audio Output</a></li></ul></li><li class="nav-section"><div class="nav-section-header"><a href="../media/index9201.html?hl=ru" >Media and Camera</a><span class="toggle-icon" tabindex="0"></span></div><ul><li><a href="../media/media-formats9201.html?hl=ru" >Supported Media Formats</a></li><li><a href="../media/mediaplayer9201.html?hl=ru" >MediaPlayer</a></li><li><a href="../media/mediarecorder9201.html?hl=ru" >MediaRecorder</a></li><li><a href="../media/exoplayer9201.html?hl=ru" >ExoPlayer</a></li><li class="nav-section"><div class="nav-section-header"><a href="../media/media-routing9201.html?hl=ru" >Media Routing</a><span class="toggle-icon" tabindex="0"></span></div><ul><li><a href="../media/mediarouter9201.html?hl=ru" >MediaRouter API</a></li><li><a href="../media/mediarouteprovider9201.html?hl=ru" >MediaRouteProvider API</a></li></ul></li><li><a href="../media/camera9201.html?hl=ru" >Camera API</a></li></ul></li><li class="nav-section"><div class="nav-section-header"><a href="../sensors/index9201.html?hl=ru" >Location and Sensors</a><span class="toggle-icon" tabindex="0"></span></div><ul><li><a href="../location/index9201.html?hl=ru" >Location and Maps</a></li><li><a href="../location/strategies9201.html?hl=ru" >Location Strategies</a></li><li><a href="../sensors/sensors_overview9201.html?hl=ru" >Sensors Overview</a></li><li><a href="../sensors/sensors_motion9201.html?hl=ru" >Motion Sensors</a></li><li><a href="../sensors/sensors_position9201.html?hl=ru" >Position Sensors</a></li><li><a href="../sensors/sensors_environment9201.html?hl=ru" >Environment Sensors</a></li></ul></li><li class="nav-section"><div class="nav-section-header"><a href="../connectivity/index9201.html?hl=ru" >Connectivity</a><span class="toggle-icon" tabindex="0"></span></div><ul><li class="nav-section"><div class="nav-section-header"><a href="../connectivity/bluetooth9201.html?hl=ru" >Bluetooth</a><span class="toggle-icon" tabindex="0"></span></div><ul><li><a href="../connectivity/bluetooth-le9201.html?hl=ru" >Bluetooth Low Energy</a></li></ul></li><li class="nav-section"><div class="nav-section-header"><a href="../connectivity/nfc/index9201.html?hl=ru" >NFC</a><span class="toggle-icon" tabindex="0"></span></div><ul><li><a href="../connectivity/nfc/nfc9201.html?hl=ru" >NFC Basics</a></li><li><a href="../connectivity/nfc/advanced-nfc9201.html?hl=ru" >Advanced NFC</a></li><li><a href="../connectivity/nfc/hce9201.html?hl=ru" >Host-based Card Emulation</a></li></ul></li><li><a href="../connectivity/wifip2p9201.html?hl=ru" >Wi-Fi P2P</a></li><li class="nav-section"><div class="nav-section-header"><a href="../connectivity/usb/index9201.html?hl=ru" >USB</a><span class="toggle-icon" tabindex="0"></span></div><ul><li><a href="../connectivity/usb/accessory9201.html?hl=ru" >Accessory</a></li><li><a href="../connectivity/usb/host9201.html?hl=ru" >Host</a></li></ul></li><li><a href="../connectivity/sip9201.html?hl=ru" >SIP</a></li></ul></li><li class="nav-section"><div class="nav-section-header"><a href="../text/index9201.html?hl=ru" >Text and Input</a><span class="toggle-icon" tabindex="0"></span></div><ul><li><a href="../text/copy-paste9201.html?hl=ru" >Copy and Paste</a></li><li class="nav-section"><div class="nav-section-header"><a href="../text/creating-input-method9201.html?hl=ru" >Creating an IME</a><span class="toggle-icon" tabindex="0"></span></div><ul><li><a href="../text/image-keyboard9201.html?hl=ru" >Image Keyboard</a></li></ul></li><li><a href="../text/spell-checker-framework9201.html?hl=ru" >Spelling Checker</a></li></ul></li><li class="nav-section"><div class="nav-section-header"><a href="../data/index9201.html?hl=ru" >Data Storage</a><span class="toggle-icon" tabindex="0"></span></div><ul><li><a href="../data/data-storage9201.html?hl=ru" >Storage Options</a></li><li class="nav-section"><div class="nav-section-header"><a href="../data/backup9201.html?hl=ru" >Data Backup</a><span class="toggle-icon" tabindex="0"></span></div><ul><li><a href="../data/autobackup9201.html?hl=ru" >Auto Backup</a></li><li><a href="../data/keyvaluebackup9201.html?hl=ru" >Key/Value Backup</a></li><li><a href="../data/testingbackup9201.html?hl=ru" >Testing Backup and Restore</a></li></ul></li><li><a href="../data/install-location9201.html?hl=ru" >App Install Location</a></li></ul></li><li class="nav-section"><div class="nav-section-header"><a href="../admin/index9201.html?hl=ru" >Administration</a><span class="toggle-icon" tabindex="0"></span></div><ul><li><a href="../admin/device-admin9201.html?hl=ru" >Device Policies</a></li></ul></li><li class="nav-section"><div class="nav-section-header"><a href="../../webapps/index9201.html?hl=ru" >Web Apps</a><span class="toggle-icon" tabindex="0"></span></div><ul><li><a href="../../webapps/targeting9201.html?hl=ru" >Supporting Different Screens in Web Apps</a></li><li><a href="../../webapps/webview9201.html?hl=ru" >Building Web Apps in WebView</a></li><li><a href="../../webapps/migrating9201.html?hl=ru" >Migrating to WebView in Android 4.4</a></li><li><a href="../../webapps/debugging9201.html?hl=ru" >Debugging Web Apps</a></li><li><a href="../../webapps/best-practices9201.html?hl=ru" >Best Practices for Web Apps</a></li></ul></li><li class="nav-section"><div class="nav-section-header"><a href="../../practices/index9201.html?hl=ru"  de-lang="Bewährte Verfahren" es-lang="Prácticas recomendadas" fr-lang="Meilleures pratiques" it-lang="Best practice" ja-lang="ベスト プラクティス" zh-cn-lang="最佳实践" zh-tw-lang="最佳實務">Best Practices</a><span class="toggle-icon" tabindex="0"></span></div><ul><li class="nav-section"><div class="nav-section-header"><a href="../../practices/screens_support9201.html?hl=ru" >Supporting Multiple Screens</a><span class="toggle-icon" tabindex="0"></span></div><ul><li><a href="../../practices/screens-distribution9201.html?hl=ru" >Distributing to Specific Screens</a></li><li><a href="../../practices/screen-compat-mode9201.html?hl=ru" >Screen Compatibility Mode</a></li></ul></li><li><a href="../../practices/app-design/seamlessness9201.html?hl=ru" >Designing for Seamlessness</a></li><li><a href="../../practices/tablets-and-handsets9201.html?hl=ru" >Supporting Tablets and Handsets</a></li></ul></li>
            </ul>
            
          
        </div>
        
        
          



<ul id="dac-main-navigation" class="dac-nav-list dac-swap-section dac-left dac-no-anim" tabindex=0>
  <li class="dac-nav-item home">
    <a class="dac-nav-link" href="https://developer.android.com/index.html?hl=ru">Начало</a>
    <i class="dac-sprite dac-expand-more-black dac-nav-sub-slider" tabindex=0></i>
    <ul class="dac-nav-secondary about">
      <li class="dac-nav-item versions">
        <a class="dac-nav-link" href="https://developer.android.com/about/versions/nougat/index.html?hl=ru">Android</a>
      </li>
      <li class="dac-nav-item wear">
        <a class="dac-nav-link" href="https://developer.android.com/wear/index.html?hl=ru">Wear</a>
      </li>
      <li class="dac-nav-item tv">
        <a class="dac-nav-link" href="https://developer.android.com/tv/index.html?hl=ru">TV</a>
      </li>
      <li class="dac-nav-item auto">
        <a class="dac-nav-link" href="https://developer.android.com/auto/index.html?hl=ru">Auto</a>
      </li>
      <li class="dac-nav-item things">
        <a class="dac-nav-link" href="https://developer.android.com/things/index.html?hl=ru">Things</a>
      </li>
    </ul>
  </li>
  <li class="dac-nav-item design">
    <a class="dac-nav-link" href="https://developer.android.com/design/index.html?hl=ru"
       zh-tw-lang="設計"
       zh-cn-lang="设计"
       ru-lang="Проектирование"
       ko-lang="디자인"
       ja-lang="設計"
       es-lang="Diseñar">Design</a>
  </li>
  <li class="dac-nav-item develop">
    <a class="dac-nav-link" href="https://developer.android.com/develop/index.html?hl=ru"
       zh-tw-lang="開發"
       zh-cn-lang="开发"
       ru-lang="Разработка"
       ko-lang="개발"
       ja-lang="開発"
       es-lang="Desarrollar">Develop</a>
    <i class="dac-sprite dac-expand-more-black dac-nav-sub-slider" tabindex=0></i>
    <ul class="dac-nav-secondary develop">
      <li class="dac-nav-item training">
        <a class="dac-nav-link" href="https://developer.android.com/training/index.html?hl=ru"
           zh-tw-lang="訓練課程"
           zh-cn-lang="培训"
           ru-lang="Курсы"
           ko-lang="교육"
           ja-lang="トレーニング"
           es-lang="Capacitación">Обучение</a>
      </li>
      <li class="dac-nav-item guide">
        <a class="dac-nav-link" href="../../index9201.html?hl=ru"
           zh-tw-lang="API 指南"
           zh-cn-lang="API 指南"
           ru-lang="Руководства по API"
           ko-lang="API 가이드"
           ja-lang="API ガイド"
           es-lang="Guías de la API">API Guides</a>
      </li>
      <li class="dac-nav-item reference">
        <a class="dac-nav-link" href="https://developer.android.com/reference/packages.html?hl=ru"
           zh-tw-lang="參考資源"
           zh-cn-lang="参考"
           ru-lang="Справочник"
           ko-lang="참조문서"
           ja-lang="リファレンス"
           es-lang="Referencia">Справочники</a>
      </li>
      <li class="dac-nav-item samples">
        <a class="dac-nav-link" href="https://developer.android.com/samples/index.html?hl=ru">Примеры</a>
      </li>
      <li class="dac-nav-item libraries">
        <a class="dac-nav-link" href="https://developer.android.com/topic/libraries/index.html?hl=ru"
           >Библиотеки</a></li>
      <li class="dac-nav-item studio">
        <a class="dac-nav-link" href="https://developer.android.com/studio/index.html?hl=ru"
           >Android Studio</a></li>
      <li class="dac-nav-item ndk">
        <a class="dac-nav-link" href="https://developer.android.com/ndk/index.html?hl=ru"
           >Android NDK</a></li>
      <li class="dac-nav-item google">
        <a class="dac-nav-link" href="https://developer.android.com/google/index.html?hl=ru">Google Services</a>
      </li>
      <li class="dac-nav-item quality-guidelines">
        <a class="dac-nav-link" href="https://developer.android.com/develop/quality-guidelines/index.html?hl=ru">Quality Guidelines</a>
      </li>
      <li class="dac-nav-item kotlin">
        <a class="dac-nav-link" href="https://developer.android.com/kotlin/index.html?hl=ru">Kotlin</a>
       </li>
    </ul>
  </li>
  <li class="dac-nav-item distribute">
    <a class="dac-nav-link" href="https://developer.android.com/distribute/index.html?hl=ru"
       zh-tw-lang="發佈"
       zh-cn-lang="分发"
       ru-lang="Распространение"
       ko-lang="배포"
       ja-lang="配布"
       de-lang="Vertrieb"
       es-lang="Distribuir"
       es-419-lang="Distribuye"
       fr-lang="Distribuer"
       id-lang="Distribusikan"
       pt-br-lang="Distribuição"
       th-lang="จัดจำหน่าย"
       tr-lang="Dağıtma"
       vi-lang="Phân phối">Distribute</a>
    <i class="dac-sprite dac-expand-more-black dac-nav-sub-slider" tabindex=0></i>
    <ul class="dac-nav-secondary distribute">
      <li class="dac-nav-item google-play">
        <a class="dac-nav-link" href="https://developer.android.com/distribute/google-play/index.html?hl=ru">Google Play</a>
      </li>
      <li class="dac-nav-item console">
        <a class="dac-nav-link" href="https://developer.android.com/distribute/console/index.html?hl=ru">Play Console</a>
      </li>
      <li class="dac-nav-item best-practices">
        <a class="dac-nav-link" href="https://developer.android.com/distribute/best-practices/index.html?hl=ru"
          es-419-lang="Recomendaciones"
          fr-lang="Bonnes pratiques"
          id-lang="Praktik terbaik"
          ja-lang="おすすめの方法"
          ko-lang="권장사항"
          pt-br-lang="Práticas recomendadas"
          ru-lang="Рекомендации"
          th-lang="จัดจำหน่าย"
          tr-lang="En iyi uygulamalar"
          vi-lang="Các phương pháp hay nhất"
          zh-cn-lang="最佳做法"
          zh-tw-lang="最佳做法">Best practices</a>
      </li>
      <li class="dac-nav-item marketing-tools">
        <a class="dac-nav-link" href="https://developer.android.com/distribute/marketing-tools/index.html?hl=ru"
          de-lang="Marketing-Tools"
          es-419-lang="Herramientas de marketing"
          fr-lang="Outils marketing"
          id-lang="Fitur pemasaran"
          ja-lang="マーケティング ツール"
          ko-lang="마케팅 도구"
          pt-br-lang="Ferramentas de marketing"
          ru-lang="Маркетинговые инструменты"
          th-lang="เครื่องมือการตลาด"
          tr-lang="Pazarlama araçları"
          vi-lang="Công cụ tiếp thị"
          zh-cn-lang="营销工具"
          zh-tw-lang="行銷工具">Marketing tools</a>
      </li>
      <li class="dac-nav-item policy-center">
        <a class="dac-nav-link" href="https://play.google.com/about/developer-content-policy/" target="_blank">Policy center</a>
      </li>
    </ul>
  </li>
  <li class="dac-nav-item stories">
    <a class="dac-nav-link" href="https://developer.android.com/stories/index.html?hl=ru">Stories</a>
  </li>
  
  <li class="dac-nav-item preview">
    <a class="dac-nav-link" href="https://developer.android.com/preview/index.html?hl=ru">Preview</a>
  </li>
  
</ul>

        
      </div>
    </div>
  </nav>

  <a name="top" tabindex="0"></a>
  
  <div class="wrap clearfix" id="body-content">
  
    
      
      <div class="content-header">
        <ul class="dac-header-crumbs"></ul>
        <!-- Breadcrumb Setup -->
        <script>$('.dac-nav-list').dacCurrentPage().dacCrumbs();</script>
        <h1 itemprop="name">Поставщик контактов</h1>
      
        
      
      </div>
      
    
    <div class="jd-descr " itemprop="articleBody">
      

<div id="qv-wrapper">
<div id="qv">
<h2>Краткое описание</h2>
<ul>
    <li>Репозиторий Android с пользовательскими данными.</li>
    <li>
        Синхронизация со службами в Интернете.
    </li>
    <li>
        Интеграция с потоками данных из социальных сетей.
    </li>
</ul>
<h2>Содержание документа</h2>
<ol>
    <li>
        <a href="#InformationTypes">Структура поставщика контактов</a>
    </li>
    <li>
        <a href="#RawContactBasics">Необработанные контакты</a>
    </li>
    <li>
        <a href="#DataBasics">Данные</a>
    </li>
    <li>
        <a href="#ContactBasics">Контакты</a>
    </li>
    <li>
        <a href="#Sources">Данные, полученные от адаптеров синхронизации</a>
    </li>
    <li>
        <a href="#Permissions">Требуемые разрешения</a>
    </li>
    <li>
        <a href="#UserProfile">Профиль пользователя</a>
    </li>
    <li>
        <a href="#ContactsProviderMetadata">Метаданные поставщика контактов</a>
    </li>
    <li>
        <a href="#Access">Доступ к поставщику контактов</a>
    <li>
    </li>
    <li>
        <a href="#SyncAdapters">Адаптеры синхронизации поставщика контактов</a>
    </li>
    <li>
        <a href="#SocialStream">Потоки данных из социальных сетей</a>
    </li>
    <li>
        <a href="#AdditionalFeatures">Дополнительные возможности поставщика контактов</a>
    </li>
</ol>
<h2>Ключевые классы</h2>
<ol>
    <li><code><a href="https://developer.android.com/reference/android/provider/ContactsContract.Contacts.html?hl=ru">ContactsContract.Contacts</a></code></li>
    <li><code><a href="https://developer.android.com/reference/android/provider/ContactsContract.RawContacts.html?hl=ru">ContactsContract.RawContacts</a></code></li>
    <li><code><a href="https://developer.android.com/reference/android/provider/ContactsContract.Data.html?hl=ru">ContactsContract.Data</a></code></li>
    <li><code>android.provider.ContactsContract.StreamItems</code></li>
</ol>
<h2>Образцы кода по теме</h2>
<ol>
    <li>
        <a href="https://developer.android.com/resources/samples/ContactManager/index.html?hl=ru">
Диспетчер контактов
</a>
    </li>
    <li>
        <a href="https://developer.android.com/resources/samples/SampleSyncAdapter/index.html?hl=ru">
Пример адаптера синхронизации</a>
    </li>
</ol>
<h2>См. также:</h2>
<ol>
    <li>
        <a href="content-provider-basics9201.html?hl=ru">
Основные сведения о поставщике контента
</a>
    </li>
</ol>
</div>
</div>
<p>
    Поставщик контактов представляет собой эффективный и гибкий компонент Android, который управляет
центральным репозиторием устройства, в котором хранятся пользовательские данные. Поставщик контактов — это источник данных,
которые отображаются в приложении «Контакты» на вашем устройстве. Вы также можете получить доступ к этим данным в своем собственном
приложении и организовать обмен такими данными между устройством и службами в Интернете. Поставщик взаимодействует
с широким набором источников данных и пытается организовать управление как можно большим набором данных о каждом человеке, поэтому
организация поставщика довольно сложная. По этой причине API поставщика
содержит широкий набор классов-контрактов и интерфейсов, отвечающих как за получение данных, так и за их
изменение.
</p>
<p>
    В этом руководстве рассматриваются следующие вопросы:
</p>
    <ul>
        <li>
            основная структура поставщика;
        </li>
        <li>
            порядок получения данных от поставщика;
        </li>
        <li>
            порядок изменения данных в поставщике;
        </li>
        <li>
            порядок записи адаптера синхронизации для синхронизации данных, полученных с вашего сервера, с данными в
поставщике контактов.
        </li>
    </ul>
<p>
    При изучении данного материала подразумевается, что вы уже знакомы с основами поставщиков контента Android. Дополнительные сведения
о поставщиках контента Android представлены в руководстве
<a href="content-provider-basics9201.html?hl=ru">Основные
сведения о поставщике контента</a>. Пример
<a href="https://developer.android.com/resources/samples/SampleSyncAdapter/index.html?hl=ru">адаптера синхронизации</a>
служит примером использования такого приложения для обмена данными между поставщиком
контактов и приложением, размещенным в веб-службах Google.
</p>
<h2 id="InformationTypes">Структура поставщика контактов</h2>
<p>
    Поставщик контактов представляет собой поставщик контента Android. Он содержит в себе три типа
данных о пользователе, каждый из которых указан в отдельной таблице, предоставляемой поставщиком,
как показано на рисунке 1.
</p>
<img src="../../../images/providers/contacts_structure9201.png?hl=ru" alt="" height="364" id="figure1" />
<p class="img-caption">
  <strong>Рисунок 1.</strong> Структура таблицы поставщика контактов.
</p>
<p>
    В качестве имен этих трех таблиц обычно используются названия соответствующих классов-контрактов. Эти классы
определяют константы для URI контента, названий столбцов и значений в столбцах этих таблиц.
</p>
<dl>
    <dt>
        Таблица <code><a href="https://developer.android.com/reference/android/provider/ContactsContract.Contacts.html?hl=ru">ContactsContract.Contacts</a></code>
    </dt>
    <dd>
        Строки в этой таблице содержат данные о разных пользователях, полученные путем агрегации строк необработанных контактов.
    </dd>
    <dt>
        Таблица <code><a href="https://developer.android.com/reference/android/provider/ContactsContract.RawContacts.html?hl=ru">ContactsContract.RawContacts</a></code>
    </dt>
    <dd>
        Строки в этой таблице содержат сводные данные о пользователе, относящиеся к пользовательскому аккаунту и его типу.
    </dd>
    <dt>
        Таблица <code><a href="https://developer.android.com/reference/android/provider/ContactsContract.Data.html?hl=ru">ContactsContract.Data</a></code>
    </dt>
    <dd>
        Строки в этой таблице содержат сведения о необработанных контактах, такие как адреса эл. почты или номера телефонов.
    </dd>
</dl>
<p>
    Другие таблицы, представленные классами-контрактами в <code><a href="https://developer.android.com/reference/android/provider/ContactsContract.html?hl=ru">ContactsContract</a></code>,
представляют собой вспомогательные таблицы, которые поставщик контактов использует для управления своими операциями или поддержки
определенных функций, имеющихся в приложении устройства «Контакты» или приложениях для телефонной связи.
</p>
<h2 id="RawContactBasics">Необработанные контакты</h2>
<p>
    Необработанный контакт представляет собой данные о пользователе, поступающие из одного аккаунта определенного
типа. Поскольку в качестве источника данных о пользователе в поставщике контактов может выступать сразу несколько онлайн-служб,
для одного и того же пользователя в поставщике контактов может существовать несколько необработанных контактов.
    Это также позволяет пользователю объединять пользовательские данные из нескольких аккаунтов
одного и того же типа.
</p>
<p>
    Большая часть данных необработанного контакта не хранится в таблице
<code><a href="https://developer.android.com/reference/android/provider/ContactsContract.RawContacts.html?hl=ru">ContactsContract.RawContacts</a></code>. Вместо этого они хранятся в одной или нескольких
строках в таблице <code><a href="https://developer.android.com/reference/android/provider/ContactsContract.Data.html?hl=ru">ContactsContract.Data</a></code>. В каждой строке данных имеется
столбец <code><a href="https://developer.android.com/reference/android/provider/ContactsContract.DataColumns.html?hl=ru#RAW_CONTACT_ID">Data.RAW_CONTACT_ID</a></code>,
в котором содержится значение <code>android.provider.BaseColumns#_ID RawContacts._ID</code> его
родительской строки<code><a href="https://developer.android.com/reference/android/provider/ContactsContract.RawContacts.html?hl=ru">ContactsContract.RawContacts</a></code>.
</p>
<h3 id="RawContactsColumns">Важные столбцы необработанных контактов</h3>
<p>
    В таблице 1 указаны столбцы таблицы <code><a href="https://developer.android.com/reference/android/provider/ContactsContract.RawContacts.html?hl=ru">ContactsContract.RawContacts</a></code>,
которые имеют большое значение. Обязательно ознакомьтесь с примечаниями, приведенными после этой таблицы.
</p>
<p class="table-caption" id="table1">
    <strong>Таблица 1.</strong> Важные столбцы необработанных контактов.
</p>
<table>
    <tr>
        <th scope="col">Название столбца</th>
        <th scope="col">Использование</th>
        <th scope="col">Примечания</th>
    </tr>
    <tr>
        <td>
            <code><a href="https://developer.android.com/reference/android/provider/ContactsContract.SyncColumns.html?hl=ru#ACCOUNT_NAME">ACCOUNT_NAME</a></code>
        </td>
        <td>
            Имя аккаунта для типа аккаунта, который выступает в роли источника данных для необработанного контакта.
            Например, имя аккаунта Google является одним из эл. адресов почты Gmail
владельца устройства. Дополнительные сведения
см. в следующей записи
<code><a href="https://developer.android.com/reference/android/provider/ContactsContract.SyncColumns.html?hl=ru#ACCOUNT_TYPE">ACCOUNT_TYPE</a></code>.
        </td>
        <td>
            Формат этого имени зависит от типа аккаунта. Это не обязательно
адрес эл. почты.
        </td>
    </tr>
    <tr>
        <td>
            <code><a href="https://developer.android.com/reference/android/provider/ContactsContract.SyncColumns.html?hl=ru#ACCOUNT_TYPE">ACCOUNT_TYPE</a></code>
        </td>
        <td>
            Тип аккаунта, который выступает в роли источника данных для необработанного контакта. Например, тип аккаунта
Google — <code>com.google</code>. Всегда указывайте тип аккаунта
и идентификатор домена, которым вы владеете или управляете. Это позволит гарантировать уникальность
типа вашего аккаунта.
        </td>
        <td>
            У типа аккаунта, выступающего в роли источника данных контактов, обычно имеется связанный с ним адаптер синхронизации,
который синхронизирует данные с поставщиком контактов.
    </tr>
    <tr>
        <td>
            <code><a href="https://developer.android.com/reference/android/provider/ContactsContract.RawContactsColumns.html?hl=ru#DELETED">DELETED</a></code>
        </td>
        <td>
            Флаг deleted для необработанного контакта.
        </td>
        <td>
            Этот флаг позволяет поставщику контактов хранить строку внутри себя до тех пор,
пока адаптеры синхронизации не смогут удалить эту строку с серверов, а затем
удалить ее из репозитория.
        </td>
    </tr>
</table>
<h4>Примечания</h4>
<p>
    Ниже представлены важные примечания к таблице
<code><a href="https://developer.android.com/reference/android/provider/ContactsContract.RawContacts.html?hl=ru">ContactsContract.RawContacts</a></code>.
</p>
<ul>
    <li>
        Имя необработанного контакта не хранится в его строке в таблице
<code><a href="https://developer.android.com/reference/android/provider/ContactsContract.RawContacts.html?hl=ru">ContactsContract.RawContacts</a></code>. Вместо этого оно хранится в
таблице <code><a href="https://developer.android.com/reference/android/provider/ContactsContract.Data.html?hl=ru">ContactsContract.Data</a></code>
в строке <code><a href="https://developer.android.com/reference/android/provider/ContactsContract.CommonDataKinds.StructuredName.html?hl=ru">ContactsContract.CommonDataKinds.StructuredName</a></code>. У необработанного контакта
имеется в таблице <code><a href="https://developer.android.com/reference/android/provider/ContactsContract.Data.html?hl=ru">ContactsContract.Data</a></code> только одна строка такого типа.
    </li>
    <li>
        <strong>Внимание!</strong> Чтобы использовать в строке необработанного контакта данные собственного аккаунта, строку
, сначала необходимо зарегистрировать его в классе <code><a href="https://developer.android.com/reference/android/accounts/AccountManager.html?hl=ru">AccountManager</a></code>. Для этого предложите
пользователям добавить тип аккаунта и его имя в список аккаунтов. Если
не сделать этого, поставщик контактов автоматически удалит вашу строку необработанного контакта.
        <p>
            Например, если необходимо, чтобы в вашем приложении хранились данные контактов для веб-службы
в домене <code>com.example.dataservice</code>, и аккаунт пользователя службы
 выглядит следующим образом:<code>becky.sharp@dataservice.example.com</code>, то пользователю сначала необходимо добавить
«тип» аккаунта (<code>com.example.dataservice</code>) и его «имя»
(<code>becky.smart@dataservice.example.com</code>) прежде чем ваше приложение сможет добавлять строки необработанных контактов.
            Это требование можно указать в документации для пользователей, а также можно предложить
пользователю добавить тип и имя своего аккаунта, либо реализовать оба этих варианта. Более подробно типы и имена аккаунтов
рассматриваются в следующем разделе.
    </li>
</ul>
<h3 id="RawContactsExample">Источники данных необработанных контактов</h3>
<p>
    Чтобы понять, что такое необработанный контакт, рассмотрим пример с пользователем Emily Dickinson, на устройстве которой имеется три
следующих аккаунта:
</p>
<ul>
    <li><code>emily.dickinson@gmail.com</code>;</li>
    <li><code>emilyd@gmail.com</code>;</li>
    <li>Аккаунт belle_of_amherst в Twitter</li>
</ul>
<p>
    Она включила функцию <em>Синхронизировать контакты</em> для всех трех этих аккаунтов
в настройках <em>Аккаунты</em>.
</p>
<p>
    Предположим, что Emily Dickinson открывает браузер, входит в Gmail под именем
<code>emily.dickinson@gmail.com</code>, затем открывает
Контакты и добавляет новый контакт Thomas Higginson. Позже она снова входит в Gmail под именем
<code>emilyd@gmail.com</code> и отправляет письмо пользователю Thomas Higginson, который автоматически
добавляется в ее контакты. Также она подписана на новости от colonel_tom (аккаунт пользователя Thomas Higginson в Twitter) в
Twitter.
</p>
<p>
    В результате этих действий поставщик контактов создает три необработанных контакта:
</p>
<ol>
    <li>
        Необработанный контакт Thomas Higginson связан с аккаунтом <code>emily.dickinson@gmail.com</code>.
        Тип этого аккаунта — Google.
    </li>
    <li>
        Второй необработанный контакт Thomas Higginson связан с аккаунтом <code>emilyd@gmail.com</code>.
        Тип этого аккаунта — также Google. Второй необработанный контакт создается даже в том случае,
если его имя полностью совпадает с именем предыдущего контакта, поскольку первый
был добавлен для другого аккаунта.
    </li>
    <li>
        Третий необработанный контакт Thomas Higginson связан с аккаунтом belle_of_amherst. Тип этого аккаунта
— Twitter.
    </li>
</ol>
<h2 id="DataBasics">Данные</h2>
<p>
    Как уже указывалось ранее, данные необработанного контакта
хранятся в строке <code><a href="https://developer.android.com/reference/android/provider/ContactsContract.Data.html?hl=ru">ContactsContract.Data</a></code>, которая связана со значением
<code>_ID</code> необработанного контакта. Благодаря этому для одного необработанного контакта может существовать несколько экземпляров
одного и того же типа данных (например, адресов эл. почты или номеров телефонов). Например, если у контакта
Thomas Higginson для аккаунта <code>emilyd@gmail.com</code> (строка необработанного контакта Thomas Higginson,
связанная с учетной записью Google <code>emilyd@gmail.com</code>) имеется адрес эл. почты
<code>thigg@gmail.com</code> и служебный адрес эл. почты
<code>thomas.higginson@gmail.com</code>, то поставщик контактов сохраняет две строки
адреса эл. почты и связывает их с этим необработанным контактом.
</p>
<p>
    Обратите внимание, что в этой таблице хранятся данные разных типов. Строки со сведениями об отображаемом имени,
номере телефона, адресе эл. почты, почтовом адресе, фото и веб-сайте хранятся в таблице
<code><a href="https://developer.android.com/reference/android/provider/ContactsContract.Data.html?hl=ru">ContactsContract.Data</a></code>. Для упрощения управления этими данными в таблице
<code><a href="https://developer.android.com/reference/android/provider/ContactsContract.Data.html?hl=ru">ContactsContract.Data</a></code> предусмотрены столбцы с описательными именами,
а также другие столбцы с универсальными именами. Содержимое в столбце с описательным именем имеет то же значение,
независимо от типа данных в строке, тогда как содержимое столбца с универсальным именем
может иметь разное значение в зависимости от типа данных.
</p>
<h3 id="DescriptiveColumns">Описательные имена столбцов</h3>
<p>
    Вот некоторые примеры столбцов с описательными именами:
</p>
<dl>
    <dt>
        <code><a href="https://developer.android.com/reference/android/provider/ContactsContract.DataColumns.html?hl=ru#RAW_CONTACT_ID">RAW_CONTACT_ID</a></code>
    </dt>
    <dd>
        Значение в столбце <code>_ID</code> необработанного контакта для этих данных.
    </dd>
    <dt>
        <code><a href="https://developer.android.com/reference/android/provider/ContactsContract.DataColumns.html?hl=ru#MIMETYPE">MIMETYPE</a></code>
    </dt>
    <dd>
        Тип данных, хранящихся в этой строке, в виде настраиваемого типа MIME. Поставщик контактов
использует типы MIME, заданные в подклассах класса
<code><a href="https://developer.android.com/reference/android/provider/ContactsContract.CommonDataKinds.html?hl=ru">ContactsContract.CommonDataKinds</a></code>. Эти типы MIME являются открытыми, и
их может использовать любое приложение или адаптер синхронизации, поддерживающие работу с поставщиком контактов.
    </dd>
    <dt>
        <code><a href="https://developer.android.com/reference/android/provider/ContactsContract.DataColumns.html?hl=ru#IS_PRIMARY">IS_PRIMARY</a></code>
    </dt>
    <dd>
        Если этот тип данных для необработанного контакта встречается несколько раз, то
столбец <code><a href="https://developer.android.com/reference/android/provider/ContactsContract.DataColumns.html?hl=ru#IS_PRIMARY">IS_PRIMARY</a></code> помечает флагом
строки данных, в которых содержатся основные данные для этого типа. Например, если
пользователь нажал и удерживает номер телефона контакта и выбрал параметр <strong>Использовать по умолчанию</strong>,
то в столбце <code><a href="https://developer.android.com/reference/android/provider/ContactsContract.Data.html?hl=ru">ContactsContract.Data</a></code> с этим номером телефона
в соответствующем столбце <code><a href="https://developer.android.com/reference/android/provider/ContactsContract.DataColumns.html?hl=ru#IS_PRIMARY">IS_PRIMARY</a></code> задается
значение, отличное от нуля.
    </dd>
</dl>
<h3 id="GenericColumns">Универсальные имена столбцов</h3>
<p>
    Существует 15 общедоступных столбцов с универсальными именами (<code>DATA1</code>–<code>DATA15</code>)
и четыре дополнительных столбца
(<code>SYNC1</code>–<code>SYNC4</code>), которые используются только адаптерами
синхронизации. Константы столбцов с универсальными именами применяются всегда, независимо от типа данных,
содержащихся в столбце.
</p>
<p>
    Столбец <code>DATA1</code> является индексируемым.  Поставщик контактов всегда использует этот столбец для
данных, которые, как он ожидает, будут наиболее часто являться целевыми в запросах. Например,
в строке с адресами эл. почты в этом столбце указывается фактический адрес эл. почты.
</p>
<p>
    Обычно столбец <code>DATA15</code> зарезервирован для данных больших двоичных объектов
(BLOB), таких как миниатюры фотографий.
</p>
<h3 id="TypeSpecificNames">Имена столбцов по типам строк</h3>
<p>
    Для упрощения работы со столбцами определенного типа строк в поставщике контактов
также предусмотрены константы для имен столбцов по типам строк, которые определены в подклассах класса
<code><a href="https://developer.android.com/reference/android/provider/ContactsContract.CommonDataKinds.html?hl=ru">ContactsContract.CommonDataKinds</a></code>. Эти константы просто
присваивают одному и тому же имени столбца различные константы, что позволяет вам получать доступ к данным в строке
определенного типа.
</p>
<p>
    Например, класс <code><a href="https://developer.android.com/reference/android/provider/ContactsContract.CommonDataKinds.Email.html?hl=ru">ContactsContract.CommonDataKinds.Email</a></code> определяет
константы имени столбца для строки <code><a href="https://developer.android.com/reference/android/provider/ContactsContract.Data.html?hl=ru">ContactsContract.Data</a></code>,
в которой имеется тип MIME
<code><a href="https://developer.android.com/reference/android/provider/ContactsContract.CommonDataKinds.Email.html?hl=ru#CONTENT_ITEM_TYPE">Email.CONTENT_ITEM_TYPE</a></code>. В этом классе содержится константа
<code><a href="https://developer.android.com/reference/android/provider/ContactsContract.CommonDataKinds.Email.html?hl=ru#ADDRESS">ADDRESS</a></code> для столбца адреса
эл. почты. Фактическое значение
<code><a href="https://developer.android.com/reference/android/provider/ContactsContract.CommonDataKinds.Email.html?hl=ru#ADDRESS">ADDRESS</a></code> — data1, которое совпадает
с универсальным именем столбца.
</p>
<p class="caution">
    <strong>Внимание!</strong> Не добавляйте свои настраиваемые данные в таблицу
<code><a href="https://developer.android.com/reference/android/provider/ContactsContract.Data.html?hl=ru">ContactsContract.Data</a></code> с помощью строки, в которой имеется один из
предварительно заданных поставщиком типов MIME. В противном случае вы можете потерять данные или вызвать неполадки
в работе поставщика. Например, не следует добавлять строку с типом MIME
<code><a href="https://developer.android.com/reference/android/provider/ContactsContract.CommonDataKinds.Email.html?hl=ru#CONTENT_ITEM_TYPE">Email.CONTENT_ITEM_TYPE</a></code>, в которой в столбце
<code>DATA1</code> вместо адреса эл. почты содержится имя пользователя. Если вы укажете в строке собственный настраиваемый тип MIME, вы можете свободно
указывать собственные имена столбцов по типам строк и использовать их так, как пожелаете.
</p>
<p>
    На рисунке 2 показано, как столбцы с описательными именами и столбцы данных отображаются в строке
<code><a href="https://developer.android.com/reference/android/provider/ContactsContract.Data.html?hl=ru">ContactsContract.Data</a></code>, а также как имена столбцов по типу строк «накладываются»
на универсальные имена столбцов.
</p>
<img src="../../../images/providers/data_columns9201.png?hl=ru" alt="How type-specific column names map to generic column names" height="311" id="figure2" />
<p class="img-caption">
  <strong>Рисунок 2.</strong> Имена столбцов по типам строк и универсальные имена столбцов.
</p>
<h3 id="ColumnMaps">Классы имен столбцов по типам строк</h3>
<p>
    В таблице 2 перечислены наиболее часто используемые классы имен столбцов по типам строк.
</p>
<p class="table-caption" id="table2">
  <strong>Таблица 2.</strong> Классы имен столбцов по типам строк</p>
<table>
  <tr>
    <th scope="col">Класс сопоставления</th>
    <th scope="col">Тип данных</th>
    <th scope="col">Примечания</th>
  </tr>
  <tr>
    <td><code><a href="https://developer.android.com/reference/android/provider/ContactsContract.CommonDataKinds.StructuredName.html?hl=ru">ContactsContract.CommonDataKinds.StructuredName</a></code></td>
    <td>Данные об имени необработанного контакта, связанного с этой строкой данных.</td>
    <td>У необработанного контакта имеется только одна строка такого типа.</td>
  </tr>
  <tr>
    <td><code><a href="https://developer.android.com/reference/android/provider/ContactsContract.CommonDataKinds.Photo.html?hl=ru">ContactsContract.CommonDataKinds.Photo</a></code></td>
    <td>Основная фотография необработанного контакта, связанного с этой строкой данных.</td>
    <td>У необработанного контакта имеется только одна строка такого типа.</td>
  </tr>
  <tr>
    <td><code><a href="https://developer.android.com/reference/android/provider/ContactsContract.CommonDataKinds.Email.html?hl=ru">ContactsContract.CommonDataKinds.Email</a></code></td>
    <td>Адрес эл. почты необработанного контакта, связанного с этой строкой данных.</td>
    <td>У необработанного контакта может быть несколько адресов эл. почты.</td>
  </tr>
  <tr>
    <td><code><a href="https://developer.android.com/reference/android/provider/ContactsContract.CommonDataKinds.StructuredPostal.html?hl=ru">ContactsContract.CommonDataKinds.StructuredPostal</a></code></td>
    <td>Почтовый адрес необработанного контакта, связанного с этой строкой данных.</td>
    <td>У необработанного контакта может быть несколько почтовых адресов.</td>
  </tr>
  <tr>
    <td><code><a href="https://developer.android.com/reference/android/provider/ContactsContract.CommonDataKinds.GroupMembership.html?hl=ru">ContactsContract.CommonDataKinds.GroupMembership</a></code></td>
    <td>Идентификатор, с помощью которого необработанный контакт связан с одной из групп в поставщике контактов.</td>
    <td>
        Группы представляют собой необязательный компонент для типа аккаунта и имени аккаунта. Дополнительные сведения о
группах представлены в разделе <a href="#Groups">Группы контактов</a>.
    </td>
  </tr>
</table>
<h3 id="ContactBasics">Контакты</h3>
<p>
    Поставщик контактов объединяет строки с необработанными контактами для всех типов аккаунтов и имен аккаунтов
для создания <strong>контакта</strong>. Это позволяет упростить отображение и изменение всех данных,
собранных в отношении пользователя. Поставщик контактов управляет процессом создания строк
контактов и агрегированием необработанных контактов, у которых имеется строка контакта. Ни приложениям, ни
адаптерам синхронизации не разрешается добавлять контакты, а некоторые столбцы в строке контакта доступны только для чтения.
</p>
<p class="note">
    <strong>Примечание.</strong> Если попытаться добавить контакт в поставщик контактов с помощью метода
<code><a href="https://developer.android.com/reference/android/content/ContentResolver.html?hl=ru#insert(android.net.Uri, android.content.ContentValues)">insert()</a></code>, будет выдано исключение
<code><a href="https://developer.android.com/reference/java/lang/UnsupportedOperationException.html?hl=ru">UnsupportedOperationException</a></code>. Если вы попытаетесь обновить столбец,
доступный только для чтения, это действие будет проигнорировано.
</p>
<p>
    При добавлении нового необработанного контакта,
который не соответствует ни одному из существующих контактов, поставщик контактов создает новый контакт. Поставщик поступает аналогично в случае, если
данные в строке существующего необработанного контакта изменяются таким образом, что они больше не соответствуют контакту,
с которым они ранее были связаны. При создании приложением или адаптером синхронизации нового контакта,
который <em></em> соответствует существующему контакту, то новый контакт объединяется с
существующим контактом.
</p>
<p>
    Поставщик контактов связывает строку контакта с его строками необработанного контакта посредством столбца
<code>_ID</code> строки контакта в таблице
<code><a href="https://developer.android.com/reference/android/provider/ContactsContract.Contacts.html?hl=ru">Contacts</a></code>. Столбец <code>CONTACT_ID</code> в таблице необработанных контактов
<code><a href="https://developer.android.com/reference/android/provider/ContactsContract.RawContacts.html?hl=ru">ContactsContract.RawContacts</a></code> содержит значения <code>_ID</code> для
строки контактов, связанной с каждой строкой необработанных контактов.
</p>
<p>
    В таблице <code><a href="https://developer.android.com/reference/android/provider/ContactsContract.Contacts.html?hl=ru">ContactsContract.Contacts</a></code> также имеется столбец
<code>android.provider.ContactsContract.ContactsColumns#LOOKUP_KEY</code>, который выступает в роли
«постоянной ссылки» на строку контакта. Поскольку поставщик контактов автоматически сохраняет контакты,
в ответ на агрегирование или синхронизацию он может изменить значение <code>android.provider.BaseColumns#_ID</code>
строки контакта. Даже если это произойдет, URI контента
<code><a href="https://developer.android.com/reference/android/provider/ContactsContract.Contacts.html?hl=ru#CONTENT_LOOKUP_URI">CONTENT_LOOKUP_URI</a></code>, объединенный с
<code>android.provider.ContactsContract.ContactsColumns#LOOKUP_KEY</code> контакта, будет
по-прежнему указывать на строку контакта, поэтому вы можете смело использовать
<code>android.provider.ContactsContract.ContactsColumns#LOOKUP_KEY</code>
для сохранения ссылок на «избранные» контакты и др. Столбец имеет собственный формат,
который не связан с форматом столбца<code>android.provider.BaseColumns#_ID</code>.
</p>
<p>
    На рисунке 3 показаны взаимосвязи этих трех основных таблиц друг с другом.
</p>
<img src="../../../images/providers/contacts_tables9201.png?hl=ru" alt="Contacts provider main tables" height="514" id="figure4" />
<p class="img-caption">
  <strong>Рисунок 3</strong>. Взаимосвязи между таблицами контактов, необработанных контактов и сведений.
</p>
<h2 id="Sources">Данные, полученные от адаптеров синхронизации</h2>
<p>
    Пользователь вводит данные контактов прямо на устройстве, однако данные также поступают в поставщик контактов
из веб-служб посредством <strong>адаптеров синхронизации</strong>, что позволяет автоматизировать
обмен данными между устройством и службами в Интернете. Адаптеры синхронизации выполняются в фоновом режиме под
управлением системы, и для управления данными они вызывают методы
<code><a href="https://developer.android.com/reference/android/content/ContentResolver.html?hl=ru">ContentResolver</a></code>.
</p>
<p>
    В Android веб-служба, с которой работает адаптер синхронизации, определяется по типу аккаунта.
    Каждый адаптер синхронизации работает с одним типом аккаунта, однако он может поддерживать несколько имен аккаунтов
такого типа. Вкратце типы и имена аккаунтов рассматриваются
в разделе <a href="#RawContactsExample">Источники данных необработанных контактов</a>. Указанные ниже определения позволяют
более точно охарактеризовать связь между типами и именами аккаунтов и адаптерами синхронизации и службами.
</p>
<dl>
    <dt>
        Тип аккаунта
    </dt>
    <dd>
        Определяет службу, в которой пользователь хранит данные. В большинстве случаев для работы со
службой пользователю необходимо пройти проверку подлинности. Например, Google Контакты представляет собой тип аккаунтов, обозначаемый кодом
<code>google.com</code>. Это значение соответствует типу аккаунта, используемого
<code><a href="https://developer.android.com/reference/android/accounts/AccountManager.html?hl=ru">AccountManager</a></code>.
    </dd>
    <dt>
        Имя аккаунта
    </dt>
    <dd>
        Определяет конкретный аккаунт или имя для входа для типа аккаунта. Аккаунты «Контакты Google»
— это то же, что и аккаунты Google, в качестве имени которых используется адрес эл. почты.
        В других службах может использоваться имя пользователя, состоящее из одного слова, или числовой идентификатор.
    </dd>
</dl>
<p>
    Типы аккаунтов не обязательно должны быть уникальными. Пользователь может создать несколько аккаунтов Google Контакты
и загрузить данные из них в поставщик контактов; это может произойти в случае, если у пользователя имеется один набор
персональных контактов для личного аккаунта, и другой набор — для служебного аккаунта. Имена
аккаунтов обычно уникальные. Вместе они формируют определенный поток данных между поставщиком контактов
и внешними службами.
</p>
<p>
    Если необходимо передать данные из службы в поставщик контактов, необходимо создать
собственный адаптер синхронизации. Дополнительные сведения об этом представлены в разделе
<a href="#SyncAdapters">Адаптеры синхронизации поставщика контактов</a>.
</p>
<p>
    На рисунке 4 показано, какую роль выполняет поставщик контактов в потоке передачи данных
о пользователях. В области, отмеченной на рисунке как sync adapters, каждый адаптер промаркирован в соответствии с поддерживаемым им типом аккаунтов.
</p>
<img src="../../../images/providers/ContactsDataFlow9201.png?hl=ru" alt="Flow of data about people" height="252" id="figure5" />
<p class="img-caption">
  <strong>Рисунок 4</strong>. Поток передачи данных через поставщика контактов.
</p>
<h2 id="Permissions">Требуемые разрешения</h2>
<p>
    Приложения, которым требуется доступ к поставщику контактов,
должны запросить указанные ниже разрешения.
</p>
<dl>
    <dt>Доступ на чтение одной или нескольких таблиц</dt>
    <dd>
        <code><a href="https://developer.android.com/reference/android/Manifest.permission.html?hl=ru#READ_CONTACTS">READ_CONTACTS</a></code>, указанный в файле
<code>AndroidManifest.xml</code> с элементом
<code><a href="../manifest/uses-permission-element9201.html?hl=ru">
        &lt;uses-permission&gt;</a></code> в виде
<code>&lt;uses-permission android:name="android.permission.READ_CONTACTS"&gt;</code>.
    </dd>
    <dt>Доступ на запись в одну или несколько таблиц</dt>
    <dd>
        <code><a href="https://developer.android.com/reference/android/Manifest.permission.html?hl=ru#WRITE_CONTACTS">WRITE_CONTACTS</a></code>, указанный в файле
<code>AndroidManifest.xml</code> с элементом
<code><a href="../manifest/uses-permission-element9201.html?hl=ru">
        &lt;uses-permission&gt;</a></code> в виде
<code>&lt;uses-permission android:name="android.permission.WRITE_CONTACTS"&gt;</code>.
    </dd>
</dl>
<p>
    Эти разрешения не распространяются на работу с данными профиля пользователя. Профиль пользователя
и требуемые разрешения для работы с ним рассматриваются в разделе
<a href="#UserProfile">Профиль пользователя</a> ниже.
</p>
<p>
    Помните, что данные о контактах пользователя являются личными и конфиденциальными. Пользователи заботятся о своей конфиденциальности,
поэтому не хотят, чтобы приложения собирали данные о них самих или их контактах.
    Если пользователю не до конца ясно, для чего требуется разрешение на доступ к данным контактов, они могут присвоить
вашему приложению низкий рейтинг или вообще откажутся его устанавливать.
</p>
<h2 id="UserProfile">Профиль пользователя</h2>
<p>
    В таблице <code><a href="https://developer.android.com/reference/android/provider/ContactsContract.Contacts.html?hl=ru">ContactsContract.Contacts</a></code> имеется всего одна строка, содержащая
данные профиля для устройства пользователя. Эти данные описывают <code>user</code> устройства,
а не один из контактов пользователя. Строка контактов профиля связана со строкой
необработанных контактов в каждой из систем, в которой используется профиль.
    В каждой строке необработанного контакта профиля может содержаться несколько строк данных. Константы для доступа к профилю пользователя
представлены в классе <code><a href="https://developer.android.com/reference/android/provider/ContactsContract.Profile.html?hl=ru">ContactsContract.Profile</a></code>.
</p>
<p>
    Для доступа к профилю пользователя требуются особые разрешения. Кроме разрешений
<code><a href="https://developer.android.com/reference/android/Manifest.permission.html?hl=ru#READ_CONTACTS">READ_CONTACTS</a></code> и
<code><a href="https://developer.android.com/reference/android/Manifest.permission.html?hl=ru#WRITE_CONTACTS">WRITE_CONTACTS</a></code>, которые требуются для чтения и записи, для доступа к профилю пользователя необходимы разрешения
<code>android.Manifest.permission#READ_PROFILE</code> и
<code>android.Manifest.permission#WRITE_PROFILE</code>
на чтение и запись соответственно.
</p>
<p>
    Всегда следует помнить, что профиль пользователя представляет собой конфиденциальную информацию. Разрешение
<code>android.Manifest.permission#READ_PROFILE</code> предоставляет вам доступ к личной информации на устройстве
пользователя. В описании своего приложения обязательно укажите, для
чего вам требуется доступ к профилю пользователя.
</p>
<p>
    Чтобы получить строку контакта с профилем пользователя, вызовите метод
<code><a href="https://developer.android.com/reference/android/content/ContentResolver.html?hl=ru#query(android.net.Uri, java.lang.String[], java.lang.String, java.lang.String[], java.lang.String)">ContentResolver.query()</a></code>. Задайте для URI контента значение
<code><a href="https://developer.android.com/reference/android/provider/ContactsContract.Profile.html?hl=ru#CONTENT_URI">CONTENT_URI</a></code> и не указывайте никаких критериев
выборки. Этот URI контента также можно использовать в качестве основного URI для получения
необработанных контактов или данных профиля. Ниже представлен фрагмент кода для получения данных профиля.
</p>
<pre>
// Sets the columns to retrieve for the user profile
mProjection = new String[]
    {
        Profile._ID,
        Profile.DISPLAY_NAME_PRIMARY,
        Profile.LOOKUP_KEY,
        Profile.PHOTO_THUMBNAIL_URI
    };

// Retrieves the profile from the Contacts Provider
mProfileCursor =
        getContentResolver().query(
                Profile.CONTENT_URI,
                mProjection ,
                null,
                null,
                null);
</pre>
<p class="note">
    <strong>Примечание.</strong> Если при извлечении несколько строк контактов необходимо определить,
какой из них является профилем пользователя, обратитесь к столбцу
<code><a href="https://developer.android.com/reference/android/provider/ContactsContract.ContactsColumns.html?hl=ru#IS_USER_PROFILE">IS_USER_PROFILE</a></code> этой строки. Если в этом столбце
указано значение «1», то в это строке находится профиль пользователя.
</p>
<h2 id="ContactsProviderMetadata">Метаданные поставщика контактов</h2>
<p>
    Поставщик контактов управляет данными, которые используются для отслеживания состояния данных контакта в
репозитории. Эти метаданные о репозитории хранятся в различных местах, включая
строки необработанных контактов, данные и строки таблицы контактов, таблицу
<code><a href="https://developer.android.com/reference/android/provider/ContactsContract.Settings.html?hl=ru">ContactsContract.Settings</a></code> и таблицу
<code><a href="https://developer.android.com/reference/android/provider/ContactsContract.SyncState.html?hl=ru">ContactsContract.SyncState</a></code>. В таблице ниже
указаны значения каждого из этих фрагментов метаданных.
</p>
<p class="table-caption" id="table3">
  <strong>Таблица 3.</strong> Метаданные в поставщике контактов</p>
<table>
    <tr>
        <th scope="col">Таблица</th>
        <th scope="col">Столбец</th>
        <th scope="col">Значения</th>
        <th scope="col">Описание</th>
    </tr>
    <tr>
        <td rowspan="2"><code><a href="https://developer.android.com/reference/android/provider/ContactsContract.RawContacts.html?hl=ru">ContactsContract.RawContacts</a></code></td>
        <td rowspan="2"><code><a href="https://developer.android.com/reference/android/provider/ContactsContract.SyncColumns.html?hl=ru#DIRTY">DIRTY</a></code></td>
        <td>«0» — с момента последней синхронизации изменения не вносились.</td>
        <td rowspan="2">
            Служит для отметки необработанных контактов, которые были изменены на устройстве и которые необходимо снова синхронизировать с
сервером. Значение устанавливается автоматически поставщиком контактов при обновлении строк приложениями
Android.
            <p>
                Адаптеры синхронизации, которые вносят изменения в необработанные контакты или таблицы данных, должны всегда добавлять к используемому ими URI
контента строку
<code><a href="https://developer.android.com/reference/android/provider/ContactsContract.html?hl=ru#CALLER_IS_SYNCADAPTER">CALLER_IS_SYNCADAPTER</a></code>. Это позволяет предотвратить пометку таких строк поставщиком как «грязных».
                В противном случае изменения, внесенные адаптером синхронизации, будут рассматриваться как локальные изменения,
которые подлежат отправке на сервер, даже если источником таких изменений был сам сервер.
            </p>
        </td>
    </tr>
    <tr>
            <td>«1» — с момента последней синхронизации были внесены изменения, которые необходимо отразить и на сервере.</td>
    </tr>
    <tr>
        <td><code><a href="https://developer.android.com/reference/android/provider/ContactsContract.RawContacts.html?hl=ru">ContactsContract.RawContacts</a></code></td>
        <td><code><a href="https://developer.android.com/reference/android/provider/ContactsContract.SyncColumns.html?hl=ru#VERSION">VERSION</a></code></td>
        <td>Номер версии этой строки.</td>
        <td>
            Поставщик контактов автоматически увеличивает это значение при каждом
изменении в строке или в связанных с ним данных.
        </td>
    </tr>
    <tr>
        <td><code><a href="https://developer.android.com/reference/android/provider/ContactsContract.Data.html?hl=ru">ContactsContract.Data</a></code></td>
        <td><code><a href="https://developer.android.com/reference/android/provider/ContactsContract.DataColumns.html?hl=ru#DATA_VERSION">DATA_VERSION</a></code></td>
        <td>Номер версии этой строки.</td>
        <td>
            Поставщик контактов автоматически увеличивает это значение при каждом
изменении в строке данных.
        </td>
    </tr>
    <tr>
        <td><code><a href="https://developer.android.com/reference/android/provider/ContactsContract.RawContacts.html?hl=ru">ContactsContract.RawContacts</a></code></td>
        <td><code><a href="https://developer.android.com/reference/android/provider/ContactsContract.SyncColumns.html?hl=ru#SOURCE_ID">SOURCE_ID</a></code></td>
        <td>
            Строковое значение, которое служит уникальным идентификатором данного необработанного контакта в аккаунте,
в котором он был создан.
        </td>
        <td>
            Когда адаптер синхронизации создает новый необработанный контакт, в этом столбце следует указать
уникальный идентификатор этого необработанного контакта на сервере. Когда же приложение Android создает
новый необработанный контакт, то приложению следует оставить этот столбец пустым. Это служит сигналом для
адаптера синхронизации, чтобы создать новый необработанный контакт на сервере и
получить значение <code><a href="https://developer.android.com/reference/android/provider/ContactsContract.SyncColumns.html?hl=ru#SOURCE_ID">SOURCE_ID</a></code>.
            <p>
                В частности, идентификатор источника должен быть <strong>уникальным</strong> для каждого типа аккаунта
и неизменным при синхронизации.
            </p>
                <ul>
                    <li>
                        Уникальный: у каждого необработанного контакта для аккаунта должен быть свой собственный идентификатор источника. Если
не применить это требование, у вас обязательно возникнут проблемы с приложением «Контакты».
                        Обратите внимание, что два необработанных контакта одного и того же <em>типа</em> аккаунта могут
иметь одинаковый идентификатор источника. Например, необработанный контакт Thomas Higginson для
аккаунта <code>emily.dickinson@gmail.com</code> может иметь такой же
идентификатор источника, что и контакт Thomas Higginson для аккаунта
<code>emilyd@gmail.com</code>.
                    </li>
                    <li>
                        Стабильный: идентификаторы источников представляют собой неизменную часть данных онлайн-службы для
необработанного контакта. Например, если пользователь выполняет повторную синхронизацию после очистки хранилища контактов в
настройках приложения, идентификаторы источников восстановленных необработанных контактов должны быть такими же,
как и прежде. Если не применить это требование, перестанут
работать ярлыки.
                    </li>
                </ul>
        </td>
    </tr>
    <tr>
        <td rowspan="2"><code><a href="https://developer.android.com/reference/android/provider/ContactsContract.Groups.html?hl=ru">ContactsContract.Groups</a></code></td>
        <td rowspan="2"><code><a href="https://developer.android.com/reference/android/provider/ContactsContract.GroupsColumns.html?hl=ru#GROUP_VISIBLE">GROUP_VISIBLE</a></code></td>
        <td>«0» — контакты, представленные в этой группе, не должны отображаться в интерфейсах пользователя приложений Android.</td>
        <td>
            Этот столбец предназначен для сведений о совместимости с серверами, позволяющими пользователям скрывать контакты
в определенных группах.
        </td>
    </tr>
    <tr>
        <td>«1» — контакты, представленные в этой группе, могут отображаться в интерфейсах пользователя приложений.</td>
    </tr>
    <tr>
        <td rowspan="2"><code><a href="https://developer.android.com/reference/android/provider/ContactsContract.Settings.html?hl=ru">ContactsContract.Settings</a></code></td>
        <td rowspan="2">
            <code><a href="https://developer.android.com/reference/android/provider/ContactsContract.SettingsColumns.html?hl=ru#UNGROUPED_VISIBLE">UNGROUPED_VISIBLE</a></code></td>
        <td>
            «0» — для этого аккаунта и аккаунтов этого типа контакты, не принадлежащие к группе,
не отображаются в интерфейсах пользователя приложений Android.
        </td>
        <td rowspan="2">
            По умолчанию контакты скрыты, если ни один из их необработанных контактов не принадлежит группе
(принадлежность необработанного контакта к группе указывается в одном или нескольких строках
<code><a href="https://developer.android.com/reference/android/provider/ContactsContract.CommonDataKinds.GroupMembership.html?hl=ru">ContactsContract.CommonDataKinds.GroupMembership</a></code>
в таблице <code><a href="https://developer.android.com/reference/android/provider/ContactsContract.Data.html?hl=ru">ContactsContract.Data</a></code>).
            Установив этот флаг в строке таблицы <code><a href="https://developer.android.com/reference/android/provider/ContactsContract.Settings.html?hl=ru">ContactsContract.Settings</a></code>
для типа аккаунта и имени аккаунта, вы можете принудительно сделать видимыми контакты, не принадлежащие какой-либо группе.
            Один из вариантов использования этого флага — отображение контактов с серверов, на которых не используются группы.
        </td>
    </tr>
    <tr>
        <td>
            «1» — для этого аккаунта и аккаунтов этого типа контакты, не принадлежащие к группе,
отображаются в интерфейсах пользователя приложений Android.
        </td>

    </tr>
    <tr>
        <td><code><a href="https://developer.android.com/reference/android/provider/ContactsContract.SyncState.html?hl=ru">ContactsContract.SyncState</a></code></td>
        <td>(все)</td>
        <td>
            Эта таблица используется для хранения метаданных для вашего адаптера синхронизации.
        </td>
        <td>
            С помощью этой таблицы вы можете на постоянной основе хранить на устройстве сведения о состоянии синхронизации и другие связанные с
синхронизацией данные.
        </td>
    </tr>
</table>
<h2 id="Access">Доступ к поставщику контактов</h2>
<p>
    В этом разделе рассматриваются инструкции по получению доступа к данным из поставщика контактов, в частности,
следующие:
</p>
<ul>
    <li>
        запросы объектов;
    </li>
    <li>
        пакетное изменение;
    </li>
    <li>
        получение и изменение данных с помощью намерений;
    </li>
    <li>
        целостность данных.
    </li>
</ul>
<p>
    Дополнительные сведения о внесении изменений с помощью адаптеров синхронизации представлены в разделе
<a href="#SyncAdapters">Адаптеры синхронизации поставщика контактов</a>.
</p>
<h3 id="Entities">Запрос объектов</h3>
<p>
    Таблицы поставщика контактов имеют иерархическую структуру, поэтому зачастую полезно
извлекать строку и все связанные с ней ее дочерние строки. Например, для отображения
всей информации о пользователе вы, возможно, захотите извлечь все строки
<code><a href="https://developer.android.com/reference/android/provider/ContactsContract.RawContacts.html?hl=ru">ContactsContract.RawContacts</a></code> для одной строки
<code><a href="https://developer.android.com/reference/android/provider/ContactsContract.Contacts.html?hl=ru">ContactsContract.Contacts</a></code> или все строки
<code><a href="https://developer.android.com/reference/android/provider/ContactsContract.CommonDataKinds.Email.html?hl=ru">ContactsContract.CommonDataKinds.Email</a></code> для одной строки
<code><a href="https://developer.android.com/reference/android/provider/ContactsContract.RawContacts.html?hl=ru">ContactsContract.RawContacts</a></code>. Чтобы упростить этот процесс, в поставщике контактов имеются
<strong>объекты</strong>, которые выступают в роли соединителей базы данных между
таблицами.
</p>
<p>
    Объект представляет собой подобие таблицы, состоящей из выбранных столбцов родительской таблицы и ее дочерней таблицы.
    При запросе объекта вы предоставляете проекцию и критерии поиска на основе доступных в
объекте столбцов. В результате вы получаете объект <code><a href="https://developer.android.com/reference/android/database/Cursor.html?hl=ru">Cursor</a></code>, в котором
содержится одна строка для каждой извлеченной строки дочерней таблицы. Например, если запросить объект
<code><a href="https://developer.android.com/reference/android/provider/ContactsContract.Contacts.Entity.html?hl=ru">ContactsContract.Contacts.Entity</a></code> для имени контакта и все строки
<code><a href="https://developer.android.com/reference/android/provider/ContactsContract.CommonDataKinds.Email.html?hl=ru">ContactsContract.CommonDataKinds.Email</a></code> для всех необработанных контактов,
соответствующих этому имени, вы получите объект <code><a href="https://developer.android.com/reference/android/database/Cursor.html?hl=ru">Cursor</a></code>, содержащий по одной строке
для каждой строки <code><a href="https://developer.android.com/reference/android/provider/ContactsContract.CommonDataKinds.Email.html?hl=ru">ContactsContract.CommonDataKinds.Email</a></code>.
</p>
<p>
    Использование объектов упрощает запросы. С помощью объекта можно извлечь сразу все данные для
контакта или необработанного контакта, вместо того, чтобы сначала делать запрос к родительской таблице для получения
идентификатора и последующего запроса к дочерней таблице с использованием полученного идентификатора. Кроме того, поставщик контактов обрабатывает запрос
объекта за одну транзакцию, что гарантирует внутреннюю согласованность полученных
данных.
</p>
<p class="note">
    <strong>Примечание.</strong> Объект обычно содержит не все столбцы
родительской и дочерней таблиц. Если вы попытаетесь изменить имя столбца, который отсутствует в списке
констант имени столбца для объекта, вы получите <code><a href="https://developer.android.com/reference/java/lang/Exception.html?hl=ru">Exception</a></code>.
</p>
<p>
    Ниже представлен пример кода для получения всех строк необработанного контакта для контакта. Это фрагмент
более крупного приложения, в котором имеются две операции: «основная» и «для получения сведений». Основная операция
служит для получения списка строк контактов; при выборе пользователем контакта операция отправляет его идентификатор в операцию
для получения сведений. Операция для получения сведений использует объект <code><a href="https://developer.android.com/reference/android/provider/ContactsContract.Contacts.Entity.html?hl=ru">ContactsContract.Contacts.Entity</a></code>
для отображения всех строк данных, полученных ото всех необработанных контактов, которые связаны с выбранным
контактом.
</p>
<p>
    Вот фрагмент кода операции «для получения сведений»:
</p>
<pre>
...
    /*
     * Appends the entity path to the URI. In the case of the Contacts Provider, the
     * expected URI is content://com.google.contacts/#/entity (# is the ID value).
     */
    mContactUri = Uri.withAppendedPath(
            mContactUri,
            ContactsContract.Contacts.Entity.CONTENT_DIRECTORY);

    // Initializes the loader identified by LOADER_ID.
    getLoaderManager().initLoader(
            LOADER_ID,  // The identifier of the loader to initialize
            null,       // Arguments for the loader (in this case, none)
            this);      // The context of the activity

    // Creates a new cursor adapter to attach to the list view
    mCursorAdapter = new SimpleCursorAdapter(
            this,                        // the context of the activity
            R.layout.detail_list_item,   // the view item containing the detail widgets
            mCursor,                     // the backing cursor
            mFromColumns,                // the columns in the cursor that provide the data
            mToViews,                    // the views in the view item that display the data
            0);                          // flags

    // Sets the ListView's backing adapter.
    mRawContactList.setAdapter(mCursorAdapter);
...
&#64;Override
public Loader&lt;Cursor&gt; onCreateLoader(int id, Bundle args) {

    /*
     * Sets the columns to retrieve.
     * RAW_CONTACT_ID is included to identify the raw contact associated with the data row.
     * DATA1 contains the first column in the data row (usually the most important one).
     * MIMETYPE indicates the type of data in the data row.
     */
    String[] projection =
        {
            ContactsContract.Contacts.Entity.RAW_CONTACT_ID,
            ContactsContract.Contacts.Entity.DATA1,
            ContactsContract.Contacts.Entity.MIMETYPE
        };

    /*
     * Sorts the retrieved cursor by raw contact id, to keep all data rows for a single raw
     * contact collated together.
     */
    String sortOrder =
            ContactsContract.Contacts.Entity.RAW_CONTACT_ID +
            " ASC";

    /*
     * Returns a new CursorLoader. The arguments are similar to
     * ContentResolver.query(), except for the Context argument, which supplies the location of
     * the ContentResolver to use.
     */
    return new CursorLoader(
            getApplicationContext(),  // The activity's context
            mContactUri,              // The entity content URI for a single contact
            projection,               // The columns to retrieve
            null,                     // Retrieve all the raw contacts and their data rows.
            null,                     //
            sortOrder);               // Sort by the raw contact ID.
}
</pre>
<p>
    По завершении загрузки <code><a href="https://developer.android.com/reference/android/app/LoaderManager.html?hl=ru">LoaderManager</a></code> выполняет обратный вызов метода
<code><a href="https://developer.android.com/reference/android/app/LoaderManager.LoaderCallbacks.html?hl=ru#onLoadFinished(android.content.Loader<D>, D)">onLoadFinished()</a></code>. Одним их входящих аргументов для этого метода является
<code><a href="https://developer.android.com/reference/android/database/Cursor.html?hl=ru">Cursor</a></code> с результатом запроса. В своем приложении вы можете
получить данные из этого объекта <code><a href="https://developer.android.com/reference/android/database/Cursor.html?hl=ru">Cursor</a></code> для его отображения или дальнейшей работы с ним.
</p>
<h3 id="Transactions">Пакетное изменение</h3>
<p>
    При каждой возможности данные в поставщике контактов следует вставлять, обновлять и удалять в
«пакетном режиме» путем создания <code><a href="https://developer.android.com/reference/java/util/ArrayList.html?hl=ru">ArrayList</a></code> из объектов
<code><a href="https://developer.android.com/reference/android/content/ContentProviderOperation.html?hl=ru">ContentProviderOperation</a></code> и вызова метода
<code><a href="https://developer.android.com/reference/android/content/ContentResolver.html?hl=ru#applyBatch(java.lang.String, java.util.ArrayList<android.content.ContentProviderOperation>)">applyBatch()</a></code>. Поскольку
поставщик контактов выполняет все операции в методе
<code><a href="https://developer.android.com/reference/android/content/ContentResolver.html?hl=ru#applyBatch(java.lang.String, java.util.ArrayList<android.content.ContentProviderOperation>)">applyBatch()</a></code> за одну
транзакцию, ваши изменения всегда будут находиться в рамках репозитория контактов и
всегда будут согласованными. Пакетное изменение также упрощает вставку необработанного контакта одновременно с его подробными
данными.
</p>
<p class="note">
    <strong>Примечание.</strong> Чтобы изменить <em>отдельный</em> необработанный контакт, рекомендуется отправить намерение в
приложение для работы с контактами на устройстве вместо обработки изменения в вашем приложении.
Более подробно эта операция описана в разделе
<a href="#Intents">Получение и изменение данных с помощью намерений</a>.
</p>
<h4>Пределы</h4>
<p>
    Пакетное изменение большого количества операций может заблокировать выполнение других процессов,
что может негативно сказаться на работе пользователя с приложением. Чтобы упорядочить все необходимые изменения
в рамках как можно меньшего количества отдельных списков и при этом предотвратить
блокирование работы системы, следует задать <strong>пределы</strong> для одной или нескольких операций.
    Предел представляет собой объект <code><a href="https://developer.android.com/reference/android/content/ContentProviderOperation.html?hl=ru">ContentProviderOperation</a></code>, в качестве значения параметра
<code><a href="https://developer.android.com/reference/android/content/ContentProviderOperation.html?hl=ru#isYieldAllowed()">isYieldAllowed()</a></code> которого задано
<code>true</code>. При достижении поставщиком контактов предела он приостанавливает свою работу,
чтобы могли выполняться другие процессы, и закрывает текущую транзакцию. Когда поставщик запускается снова, он
выполняет следующую операцию в <code><a href="https://developer.android.com/reference/java/util/ArrayList.html?hl=ru">ArrayList</a></code> и запускает
новую транзакцию.
</p>
<p>
    Использование пределов позволяет за один вызов метода
<code><a href="https://developer.android.com/reference/android/content/ContentResolver.html?hl=ru#applyBatch(java.lang.String, java.util.ArrayList<android.content.ContentProviderOperation>)">applyBatch()</a></code> выполнять более одной транзакции. По этой причине
вам следует задать предел для последней операции с набором связанных строк.
    Например, необходимо задать предел для последней операции в наборе, которая
добавляет строки необработанного контакта и связанные с ним строки данных, или для последней операции с набором строк, связанных
с одним контактом.
</p>
<p>
    Пределы также являются единицами атомарных операций. Все операции доступа в промежутке между двумя пределами завершаются либо
успехом, либо сбоем в рамках одной единицы. Если любой из пределов не задан, наименьшей
атомарной операцией считается весь пакет операций. Использование пределов позволяет предотвратить
снижение производительности системы и одновременно обеспечить выполнение набора
операций на атомарном уровне.
</p>
<h4>Изменение обратных ссылок</h4>
<p>
    При вставке новой строки необработанного контакта и связанных с ним рядов данных в виде набора объектов
<code><a href="https://developer.android.com/reference/android/content/ContentProviderOperation.html?hl=ru">ContentProviderOperation</a></code> вам приходится связывать строки данных
со строкой необработанного контакта путем вставки значения
<code>android.provider.BaseColumns#_ID</code> необработанного контакта в виде значения
<code><a href="https://developer.android.com/reference/android/provider/ContactsContract.DataColumns.html?hl=ru#RAW_CONTACT_ID">RAW_CONTACT_ID</a></code>. Однако это значение
недоступно, когда вы создаете<code><a href="https://developer.android.com/reference/android/content/ContentProviderOperation.html?hl=ru">ContentProviderOperation</a></code>
для строки данных, поскольку вы еще не применили
<code><a href="https://developer.android.com/reference/android/content/ContentProviderOperation.html?hl=ru">ContentProviderOperation</a></code> для строки необработанного контакта. Чтобы обойти это ограничение,
в классе <code><a href="https://developer.android.com/reference/android/content/ContentProviderOperation.Builder.html?hl=ru">ContentProviderOperation.Builder</a></code> предусмотрен метод
<code><a href="https://developer.android.com/reference/android/content/ContentProviderOperation.Builder.html?hl=ru#withValueBackReference(java.lang.String, int)">withValueBackReference()</a></code>.
    С помощью этого метода можно вставлять или изменять столбец
с результатом предыдущей операции.
</p>
<p>
    В методе <code><a href="https://developer.android.com/reference/android/content/ContentProviderOperation.Builder.html?hl=ru#withValueBackReference(java.lang.String, int)">withValueBackReference()</a></code>
предусмотрено два аргумента:
</p>
    <dl>
        <dt>
            <code>key</code>
        </dt>
        <dd>
            Ключ для пары «ключ-значение». Значением этого аргумента должно быть имя столбца
в таблице, которую вы изменяете.
        </dd>
        <dt>
            <code>previousResult</code>
        </dt>
        <dd>
            Индекс значения, начинающийся с «0», в массиве объектов
<code><a href="https://developer.android.com/reference/android/content/ContentProviderResult.html?hl=ru">ContentProviderResult</a></code> из метода
<code><a href="https://developer.android.com/reference/android/content/ContentResolver.html?hl=ru#applyBatch(java.lang.String, java.util.ArrayList<android.content.ContentProviderOperation>)">applyBatch()</a></code>. По мере
выполнения пакетных операций результат каждой операции сохраняется в
промежуточном массиве результатов. Значением <code>previousResult</code> является индекс
одного из этих результатов, который извлекается и хранится со значением
<code>key</code>. Благодаря этому можно вставить новую запись необработанного контакта и получить обратно его значение
<code>android.provider.BaseColumns#_ID</code>, а затем создать «обратную ссылку» на
значение при добавлении строки <code><a href="https://developer.android.com/reference/android/provider/ContactsContract.Data.html?hl=ru">ContactsContract.Data</a></code>.
            <p>
                Целиком весь результат создается при первом вызове метода
<code><a href="https://developer.android.com/reference/android/content/ContentResolver.html?hl=ru#applyBatch(java.lang.String, java.util.ArrayList<android.content.ContentProviderOperation>)">applyBatch()</a></code>.
Размер результата равен размеру <code><a href="https://developer.android.com/reference/java/util/ArrayList.html?hl=ru">ArrayList</a></code> предоставленных вами объектов
<code><a href="https://developer.android.com/reference/android/content/ContentProviderOperation.html?hl=ru">ContentProviderOperation</a></code>. Однако для всех
элементов в массиве результатов присваивается значение <code>null</code>, и при попытке
воспользоваться обратной ссылкой на результат еще не выполненной операции метод
<code><a href="https://developer.android.com/reference/android/content/ContentProviderOperation.Builder.html?hl=ru#withValueBackReference(java.lang.String, int)">withValueBackReference()</a></code>
выдает <code><a href="https://developer.android.com/reference/java/lang/Exception.html?hl=ru">Exception</a></code>.

            </p>
        </dd>
    </dl>
<p>
    Ниже представлены фрагменты кода для вставки нового необработанного контакта и его данных в пакетном режиме. Они включают
код, который задает предел и использует обратную ссылку. Эти фрагменты
представляют собой расширенную версию метода <code>createContacEntry()</code>, который входит в класс
<code>ContactAdder</code> в примере приложения
<code><a href="https://developer.android.com/resources/samples/ContactManager/index.html?hl=ru">
    Contact Manager</a></code>.
</p>
<p>
    Первый фрагмент кода служит для извлечения данных контакта из пользовательского интерфейса. На этом этапе пользователь уже выбрал
аккаунт, для которого необходимо добавить новый необработанный контакт.
</p>
<pre>
// Creates a contact entry from the current UI values, using the currently-selected account.
protected void createContactEntry() {
    /*
     * Gets values from the UI
     */
    String name = mContactNameEditText.getText().toString();
    String phone = mContactPhoneEditText.getText().toString();
    String email = mContactEmailEditText.getText().toString();

    int phoneType = mContactPhoneTypes.get(
            mContactPhoneTypeSpinner.getSelectedItemPosition());

    int emailType = mContactEmailTypes.get(
            mContactEmailTypeSpinner.getSelectedItemPosition());
</pre>
<p>
    В следующем фрагменте кода создается операция для вставки строки необработанного контакта в таблицу
<code><a href="https://developer.android.com/reference/android/provider/ContactsContract.RawContacts.html?hl=ru">ContactsContract.RawContacts</a></code>:
</p>
<pre>
    /*
     * Prepares the batch operation for inserting a new raw contact and its data. Even if
     * the Contacts Provider does not have any data for this person, you can't add a Contact,
     * only a raw contact. The Contacts Provider will then add a Contact automatically.
     */

     // Creates a new array of ContentProviderOperation objects.
    ArrayList&lt;ContentProviderOperation&gt; ops =
            new ArrayList&lt;ContentProviderOperation&gt;();

    /*
     * Creates a new raw contact with its account type (server type) and account name
     * (user's account). Remember that the display name is not stored in this row, but in a
     * StructuredName data row. No other data is required.
     */
    ContentProviderOperation.Builder op =
            ContentProviderOperation.newInsert(ContactsContract.RawContacts.CONTENT_URI)
            .withValue(ContactsContract.RawContacts.ACCOUNT_TYPE, mSelectedAccount.getType())
            .withValue(ContactsContract.RawContacts.ACCOUNT_NAME, mSelectedAccount.getName());

    // Builds the operation and adds it to the array of operations
    ops.add(op.build());
</pre>
<p>
    Затем код создает строки данных для строк отображаемого имени, телефона и адреса эл. почты.
</p>
<p>
    Каждый объект компонента операции использует метод
<code><a href="https://developer.android.com/reference/android/content/ContentProviderOperation.Builder.html?hl=ru#withValueBackReference(java.lang.String, int)">withValueBackReference()</a></code>
для получения
<code><a href="https://developer.android.com/reference/android/provider/ContactsContract.DataColumns.html?hl=ru#RAW_CONTACT_ID">RAW_CONTACT_ID</a></code>. Ссылка возвращается
обратно к объекту <code><a href="https://developer.android.com/reference/android/content/ContentProviderResult.html?hl=ru">ContentProviderResult</a></code> из первой операции,
в результате чего добавляется строка необработанного контакта и возвращается его новое значение
<code>android.provider.BaseColumns#_ID</code>. После этого каждая строка данных автоматически связывается по своему
<code><a href="https://developer.android.com/reference/android/provider/ContactsContract.DataColumns.html?hl=ru#RAW_CONTACT_ID">RAW_CONTACT_ID</a></code>
с новой строкой <code><a href="https://developer.android.com/reference/android/provider/ContactsContract.RawContacts.html?hl=ru">ContactsContract.RawContacts</a></code>, которой она принадлежит.
</p>
<p>
    Объект <code><a href="https://developer.android.com/reference/android/content/ContentProviderOperation.Builder.html?hl=ru">ContentProviderOperation.Builder</a></code>, который добавляет строку адреса эл. почты,
помечается флагом с помощью метода <code><a href="https://developer.android.com/reference/android/content/ContentProviderOperation.Builder.html?hl=ru#withYieldAllowed(boolean)">withYieldAllowed()</a></code>, который задает предел:
</p>
<pre>
    // Creates the display name for the new raw contact, as a StructuredName data row.
    op =
            ContentProviderOperation.newInsert(ContactsContract.Data.CONTENT_URI)
            /*
             * withValueBackReference sets the value of the first argument to the value of
             * the ContentProviderResult indexed by the second argument. In this particular
             * call, the raw contact ID column of the StructuredName data row is set to the
             * value of the result returned by the first operation, which is the one that
             * actually adds the raw contact row.
             */
            .withValueBackReference(ContactsContract.Data.RAW_CONTACT_ID, 0)

            // Sets the data row's MIME type to StructuredName
            .withValue(ContactsContract.Data.MIMETYPE,
                    ContactsContract.CommonDataKinds.StructuredName.CONTENT_ITEM_TYPE)

            // Sets the data row's display name to the name in the UI.
            .withValue(ContactsContract.CommonDataKinds.StructuredName.DISPLAY_NAME, name);

    // Builds the operation and adds it to the array of operations
    ops.add(op.build());

    // Inserts the specified phone number and type as a Phone data row
    op =
            ContentProviderOperation.newInsert(ContactsContract.Data.CONTENT_URI)
            /*
             * Sets the value of the raw contact id column to the new raw contact ID returned
             * by the first operation in the batch.
             */
            .withValueBackReference(ContactsContract.Data.RAW_CONTACT_ID, 0)

            // Sets the data row's MIME type to Phone
            .withValue(ContactsContract.Data.MIMETYPE,
                    ContactsContract.CommonDataKinds.Phone.CONTENT_ITEM_TYPE)

            // Sets the phone number and type
            .withValue(ContactsContract.CommonDataKinds.Phone.NUMBER, phone)
            .withValue(ContactsContract.CommonDataKinds.Phone.TYPE, phoneType);

    // Builds the operation and adds it to the array of operations
    ops.add(op.build());

    // Inserts the specified email and type as a Phone data row
    op =
            ContentProviderOperation.newInsert(ContactsContract.Data.CONTENT_URI)
            /*
             * Sets the value of the raw contact id column to the new raw contact ID returned
             * by the first operation in the batch.
             */
            .withValueBackReference(ContactsContract.Data.RAW_CONTACT_ID, 0)

            // Sets the data row's MIME type to Email
            .withValue(ContactsContract.Data.MIMETYPE,
                    ContactsContract.CommonDataKinds.Email.CONTENT_ITEM_TYPE)

            // Sets the email address and type
            .withValue(ContactsContract.CommonDataKinds.Email.ADDRESS, email)
            .withValue(ContactsContract.CommonDataKinds.Email.TYPE, emailType);

    /*
     * Demonstrates a yield point. At the end of this insert, the batch operation's thread
     * will yield priority to other threads. Use after every set of operations that affect a
     * single contact, to avoid degrading performance.
     */
    op.withYieldAllowed(true);

    // Builds the operation and adds it to the array of operations
    ops.add(op.build());
</pre>
<p>
    В последнем фрагменте кода представлен вызов метода
<code><a href="https://developer.android.com/reference/android/content/ContentResolver.html?hl=ru#applyBatch(java.lang.String, java.util.ArrayList<android.content.ContentProviderOperation>)">applyBatch()</a></code>
для вставки нового необработанного контакта и его строк данных.
</p>
<pre>
    // Ask the Contacts Provider to create a new contact
    Log.d(TAG,"Selected account: " + mSelectedAccount.getName() + " (" +
            mSelectedAccount.getType() + ")");
    Log.d(TAG,"Creating contact: " + name);

    /*
     * Applies the array of ContentProviderOperation objects in batch. The results are
     * discarded.
     */
    try {

            getContentResolver().applyBatch(ContactsContract.AUTHORITY, ops);
    } catch (Exception e) {

            // Display a warning
            Context ctx = getApplicationContext();

            CharSequence txt = getString(R.string.contactCreationFailure);
            int duration = Toast.LENGTH_SHORT;
            Toast toast = Toast.makeText(ctx, txt, duration);
            toast.show();

            // Log exception
            Log.e(TAG, "Exception encountered while inserting contact: " + e);
    }
}
</pre>
<p>
    С помощью пакетных операций можно также реализовать<strong>оптимистическое управление параллелизмом</strong>.
Это метод применения транзакций изменения без необходимости блокировать базовый репозиторий.
    Чтобы воспользоваться этим методом, необходимо применить транзакцию и проверить наличие других изменений,
которые могли быть внесены в это же время. Если обнаружится, что имеется несогласованное изменение,
транзакцию можно откатить и выполнить повторно.
</p>
<p>
    Оптимистическое управление параллелизмом подходит для мобильных устройств, где с системой одновременно взаимодействует только один пользователь,
 а одновременный доступ к репозиторию данных нескольких пользователей — довольно редкое явление. Поскольку не применяется блокировка,
экономится ценное время, которое требуется на установку блокировок или ожидания того, когда другие транзакции отменят свои блокировки.
</p>
<p>
    Ниже представлен порядок использования оптимистического управления параллелизмом при обновлении одной строки
<code><a href="https://developer.android.com/reference/android/provider/ContactsContract.RawContacts.html?hl=ru">ContactsContract.RawContacts</a></code>.
</p>
<ol>
    <li>
        Извлеките столбец <code><a href="https://developer.android.com/reference/android/provider/ContactsContract.SyncColumns.html?hl=ru#VERSION">VERSION</a></code>
необработанного контакта, а также другие данные, которые необходимо извлечь.
    </li>
    <li>
        Создайте объект <code><a href="https://developer.android.com/reference/android/content/ContentProviderOperation.Builder.html?hl=ru">ContentProviderOperation.Builder</a></code>, подходящий для
применения ограничения, с помощью метода
<code><a href="https://developer.android.com/reference/android/content/ContentProviderOperation.html?hl=ru#newAssertQuery(android.net.Uri)">newAssertQuery(Uri)</a></code>. Для URI контента
используйте <code><a href="https://developer.android.com/reference/android/provider/ContactsContract.RawContacts.html?hl=ru#CONTENT_URI">RawContacts.CONTENT_URI</a></code>,
добавив к нему <code>android.provider.BaseColumns#_ID</code> необработанного контакта.
    </li>
    <li>
        Для объекта <code><a href="https://developer.android.com/reference/android/content/ContentProviderOperation.Builder.html?hl=ru">ContentProviderOperation.Builder</a></code> вызовите метод
<code><a href="https://developer.android.com/reference/android/content/ContentProviderOperation.Builder.html?hl=ru#withValue(java.lang.String, java.lang.Object)">withValue()</a></code>, чтобы сравнить столбец <code><a href="https://developer.android.com/reference/android/provider/ContactsContract.SyncColumns.html?hl=ru#VERSION">VERSION</a></code>
с номером версии, которую вы только что получили.
    </li>
    <li>
        Для того же объекта <code><a href="https://developer.android.com/reference/android/content/ContentProviderOperation.Builder.html?hl=ru">ContentProviderOperation.Builder</a></code> вызовите метод
<code><a href="https://developer.android.com/reference/android/content/ContentProviderOperation.Builder.html?hl=ru#withExpectedCount(int)">withExpectedCount()</a></code>, чтобы убедиться в том, что проверочное утверждение проверяет только одну строка.
    </li>
    <li>
        Вызовите метод <code><a href="https://developer.android.com/reference/android/content/ContentProviderOperation.Builder.html?hl=ru#build()">build()</a></code>, чтобы создать объект
<code><a href="https://developer.android.com/reference/android/content/ContentProviderOperation.html?hl=ru">ContentProviderOperation</a></code>, затем добавьте этот объект в качестве первого объекта в
<code><a href="https://developer.android.com/reference/java/util/ArrayList.html?hl=ru">ArrayList</a></code>, который вы передаете в метод
<code><a href="https://developer.android.com/reference/android/content/ContentResolver.html?hl=ru#applyBatch(java.lang.String, java.util.ArrayList<android.content.ContentProviderOperation>)">applyBatch()</a></code>.
    </li>
    <li>
        Примените пакетную транзакцию.
    </li>
</ol>
<p>
    Если в промежутке между считыванием строки и попыткой ее изменения строка необработанного контакта была обновлена другой
операцией, assert <code><a href="https://developer.android.com/reference/android/content/ContentProviderOperation.html?hl=ru">ContentProviderOperation</a></code>
завершится сбоем и в выполнении всего пакета операций будет отказано. Можно выбрать повторное выполнение
пакета или выполнить другое действие.
</p>
<p>
    В примере кода ниже демонстрируется, как создать assert
<code><a href="https://developer.android.com/reference/android/content/ContentProviderOperation.html?hl=ru">ContentProviderOperation</a></code> после запроса одного необработанного контакта с помощью
<code><a href="https://developer.android.com/reference/android/content/CursorLoader.html?hl=ru">CursorLoader</a></code>.
</p>
<pre>
/*
 * The application uses CursorLoader to query the raw contacts table. The system calls this method
 * when the load is finished.
 */
public void onLoadFinished(Loader&lt;Cursor&gt; loader, Cursor cursor) {

    // Gets the raw contact's _ID and VERSION values
    mRawContactID = cursor.getLong(cursor.getColumnIndex(BaseColumns._ID));
    mVersion = cursor.getInt(cursor.getColumnIndex(SyncColumns.VERSION));
}

...

// Sets up a Uri for the assert operation
Uri rawContactUri = ContentUris.withAppendedId(RawContacts.CONTENT_URI, mRawContactID);

// Creates a builder for the assert operation
ContentProviderOperation.Builder assertOp = ContentProviderOperation.netAssertQuery(rawContactUri);

// Adds the assertions to the assert operation: checks the version and count of rows tested
assertOp.withValue(SyncColumns.VERSION, mVersion);
assertOp.withExpectedCount(1);

// Creates an ArrayList to hold the ContentProviderOperation objects
ArrayList ops = new ArrayList&lt;ContentProviderOperationg&gt;;

ops.add(assertOp.build());

// You would add the rest of your batch operations to "ops" here

...

// Applies the batch. If the assert fails, an Exception is thrown
try
    {
        ContentProviderResult[] results =
                getContentResolver().applyBatch(AUTHORITY, ops);

    } catch (OperationApplicationException e) {

        // Actions you want to take if the assert operation fails go here
    }
</pre>
<h3 id="Intents">Получение и изменение данных с помощью намерений</h3>
<p>
    С помощью отправки намерения в приложение для работы с контактами, которое имеется на устройстве, можно в обход получить доступ
к поставщику контактов. Намерение запускает пользовательский интерфейс приложения на устройстве, посредством которого пользователь
может работать с контактами. Такой тип доступа позволяет пользователю выполнять следующие действия:
    <ul>
        <li>выбор контактов из списка и их возврат в приложение для дальнейшей работы;</li>
        <li>изменение данных существующего контакта;</li>
        <li>вставка нового необработанного контакта для любых других аккаунтов;</li>
        <li>удаление контакта или его данных.</li>
    </ul>
<p>
    Если пользователь вставляет или обновляет данные , вы можете сначала собрать эти данные, а затем отправить их вместе
с намерением.
</p>
<p>
    При использовании намерений для доступа к поставщику контактов посредством приложения для работы с контактами, имеющегося на устройстве, вам
не нужно создавать собственный пользовательский интерфейс или код для доступа к поставщику. Также вам
не нужно запрашивать разрешение на чтение или запись в поставщик. Приложение для работы с контактами, имеющееся на устройстве, может
делегировать вам разрешение на чтение контакта, и поскольку вы вносите изменения
в поставщик через другое приложение, вам не нужно разрешение на запись.
</p>
<p>
    Более подробно общий процесс отправки намерения для получения доступа к поставщику описан в руководстве
<a href="content-provider-basics9201.html?hl=ru">Основные сведения о поставщике контента</a>
в разделе «Доступ к данным посредством намерений». В таблице 4 ниже представлены сводные сведения об операциях,
типе MIME и значениях данных, которые используются для доступных задач. Значения
дополнительных данных, которые можно использовать для
<code><a href="https://developer.android.com/reference/android/content/Intent.html?hl=ru#putExtra(java.lang.String, java.lang.String)">putExtra()</a></code>, указаны в справочной
документации по <code><a href="https://developer.android.com/reference/android/provider/ContactsContract.Intents.Insert.html?hl=ru">ContactsContract.Intents.Insert</a></code>.
</p>
<p class="table-caption" id="table4">
  <strong>Таблица 4.</strong> Намерения в поставщике контактов.
</p>
<table style="width:75%">
    <tr>
        <th scope="col" style="width:10%">Задача</th>
        <th scope="col" style="width:5%">Действие</th>
        <th scope="col" style="width:10%">Данные</th>
        <th scope="col" style="width:10%">Тип MIME</th>
        <th scope="col" style="width:25%">Примечания</th>
    </tr>
    <tr>
        <td><strong>Выбор контакта из списка</strong></td>
        <td><code><a href="https://developer.android.com/reference/android/content/Intent.html?hl=ru#ACTION_PICK">ACTION_PICK</a></code></td>
        <td>
            Одно из следующего:
            <ul>
                <li>
<code><a href="https://developer.android.com/reference/android/provider/ContactsContract.Contacts.html?hl=ru#CONTENT_URI">Contacts.CONTENT_URI</a></code>
(отображение списка контактов);
                </li>
                <li>
<code><a href="https://developer.android.com/reference/android/provider/ContactsContract.CommonDataKinds.Phone.html?hl=ru#CONTENT_URI">Phone.CONTENT_URI</a></code>
(отображение номеров телефонов для необработанного контакта);
                </li>
                <li>
<code><a href="https://developer.android.com/reference/android/provider/ContactsContract.CommonDataKinds.StructuredPostal.html?hl=ru#CONTENT_URI">StructuredPostal.CONTENT_URI</a></code>
(отображение списка почтовых адресов для необработанного контакта);
                </li>
                <li>
<code><a href="https://developer.android.com/reference/android/provider/ContactsContract.CommonDataKinds.Email.html?hl=ru#CONTENT_URI">Email.CONTENT_URI</a></code>
(отображение адресов эл. почты для необработанного контакта).
                </li>
            </ul>
        </td>
        <td>
            Не используется
        </td>
        <td>
            Отображение списка необработанных контактов или списка данных необработанного контакта (в зависимости от
предоставленного URI контента).
            <p>
                Вызовите метод
<code><a href="https://developer.android.com/reference/android/app/Activity.html?hl=ru#startActivityForResult(android.content.Intent, int)">startActivityForResult()</a></code>,
который возвращает URI контента для выбранной строки. URI представлен в форме
URI контента таблицы, к которому добавлен <code>LOOKUP_ID</code> строки.
                Приложение для работы с контактами, установленное на устройстве, делегирует этому URI контента
разрешения на чтение и запись, которые действуют в течение всего жизненного цикла вашей операции. Дополнительные сведения представлены в статье
<a href="content-provider-basics9201.html?hl=ru">Основные
сведения о поставщике контента</a>.
            </p>
        </td>
    </tr>
    <tr>
        <td><strong>Вставка нового необработанного контакта</strong></td>
        <td><code><a href="https://developer.android.com/reference/android/provider/ContactsContract.Intents.Insert.html?hl=ru#ACTION">Insert.ACTION</a></code></td>
        <td>Н/Д</td>
        <td>
            <code><a href="https://developer.android.com/reference/android/provider/ContactsContract.RawContacts.html?hl=ru#CONTENT_TYPE">RawContacts.CONTENT_TYPE</a></code>, тип MIME для набора необработанных контактов.
        </td>
        <td>
            Отображение экрана <strong>Добавить контакт</strong> в приложении для работы с контактами, которое установлено на устройстве. Отображаются
значения дополнительных данных, добавленных вами в намерение. При отправке с помощью метода
<code><a href="https://developer.android.com/reference/android/app/Activity.html?hl=ru#startActivityForResult(android.content.Intent, int)">startActivityForResult()</a></code>
URI контента нового добавленного необработанного контакта передается обратно в метод обратного вызова
<code><a href="https://developer.android.com/reference/android/app/Activity.html?hl=ru#onActivityResult(int, int, android.content.Intent)">onActivityResult()</a></code>
вашей операции в аргументе <code><a href="https://developer.android.com/reference/android/content/Intent.html?hl=ru">Intent</a></code> в поле
data. Чтобы получить значение, вызовите метод <code><a href="https://developer.android.com/reference/android/content/Intent.html?hl=ru#getData()">getData()</a></code>.
        </td>
    </tr>
    <tr>
        <td><strong>Изменение контакта</strong></td>
        <td><code><a href="https://developer.android.com/reference/android/content/Intent.html?hl=ru#ACTION_EDIT">ACTION_EDIT</a></code></td>
        <td>
            <code><a href="https://developer.android.com/reference/android/provider/ContactsContract.Contacts.html?hl=ru#CONTENT_LOOKUP_URI">CONTENT_LOOKUP_URI</a></code>
контакта. Операция редактора разрешит пользователю изменить любые данные, связанные с
этим контактом.
        </td>
        <td>
            <code><a href="https://developer.android.com/reference/android/provider/ContactsContract.Contacts.html?hl=ru#CONTENT_ITEM_TYPE">Contacts.CONTENT_ITEM_TYPE</a></code>, один контакт.</td>
        <td>
            Отображение экрана редактирования контакта в приложении для работы с контактами. Отображаются
значения дополнительных данных, добавленных вами в намерение. Когда пользователь нажимает на кнопку <strong>Готово</strong> для сохранения
внесенных изменений, ваша операция возвращается на передний план.
        </td>
    </tr>
    <tr>
        <td><strong>Отображение средства выбора, в котором также можно добавлять данные</strong></td>
        <td><code><a href="https://developer.android.com/reference/android/content/Intent.html?hl=ru#ACTION_INSERT_OR_EDIT">ACTION_INSERT_OR_EDIT</a></code></td>
        <td>
            Н/Д
        </td>
        <td>
            <code><a href="https://developer.android.com/reference/android/provider/ContactsContract.Contacts.html?hl=ru#CONTENT_ITEM_TYPE">CONTENT_ITEM_TYPE</a></code>
        </td>
         <td>
            Это намерение также отображает экран средства выбора приложения для работы с контактами. Пользователь
может выбрать контакт для изменения или добавить новый контакт. В зависимости от выбора отображается экран редактирования или добавления контакта,
и отображаются дополнительные данные,
переданные вами в намерение. Если ваше приложение отображает такие данные контакта, как адрес эл. почты или номер телефона,
воспользуйтесь этим намерением, чтобы разрешить пользователю добавлять данные к существующему
контакту.
            <p class="note">
                <strong>Примечание.</strong> Вам не нужно отправлять значение имени в дополнительные данные этого намерения,
поскольку пользователь всегда выбирает существующее имя или добавляет новое. Кроме того,
если отправить имя, а пользователь решит внести изменения, приложение для работы с контактами
отобразит отправленное вами имя, перезаписав предыдущее значение. Если пользователь
не заметит этого и сохранит изменения, старое значение будет утеряно.
            </p>
         </td>
    </tr>
</table>
<p>
    Приложение для работы с контактами, имеющееся на устройстве, не разрешает вам удалять необработанные контакты или любые его данные с
помощью намерений. Вместо этого для обработки необработанного контакта используйте метод
<code><a href="https://developer.android.com/reference/android/content/ContentResolver.html?hl=ru#delete(android.net.Uri, java.lang.String, java.lang.String[])">ContentResolver.delete()</a></code>
или <code><a href="https://developer.android.com/reference/android/content/ContentProviderOperation.html?hl=ru#newDelete(android.net.Uri)">ContentProviderOperation.newDelete()</a></code>.
</p>
<p>
    Ниже представлен фрагмент кода для создания и отправки намерения, который вставляет новый
необработанный контакт и его данные.
</p>
<pre>
// Gets values from the UI
String name = mContactNameEditText.getText().toString();
String phone = mContactPhoneEditText.getText().toString();
String email = mContactEmailEditText.getText().toString();

String company = mCompanyName.getText().toString();
String jobtitle = mJobTitle.getText().toString();

// Creates a new intent for sending to the device's contacts application
Intent insertIntent = new Intent(ContactsContract.Intents.Insert.ACTION);

// Sets the MIME type to the one expected by the insertion activity
insertIntent.setType(ContactsContract.RawContacts.CONTENT_TYPE);

// Sets the new contact name
insertIntent.putExtra(ContactsContract.Intents.Insert.NAME, name);

// Sets the new company and job title
insertIntent.putExtra(ContactsContract.Intents.Insert.COMPANY, company);
insertIntent.putExtra(ContactsContract.Intents.Insert.JOB_TITLE, jobtitle);

/*
 * Demonstrates adding data rows as an array list associated with the DATA key
 */

// Defines an array list to contain the ContentValues objects for each row
ArrayList&lt;ContentValues&gt; contactData = new ArrayList&lt;ContentValues&gt;();


/*
 * Defines the raw contact row
 */

// Sets up the row as a ContentValues object
ContentValues rawContactRow = new ContentValues();

// Adds the account type and name to the row
rawContactRow.put(ContactsContract.RawContacts.ACCOUNT_TYPE, mSelectedAccount.getType());
rawContactRow.put(ContactsContract.RawContacts.ACCOUNT_NAME, mSelectedAccount.getName());

// Adds the row to the array
contactData.add(rawContactRow);

/*
 * Sets up the phone number data row
 */

// Sets up the row as a ContentValues object
ContentValues phoneRow = new ContentValues();

// Specifies the MIME type for this data row (all data rows must be marked by their type)
phoneRow.put(
        ContactsContract.Data.MIMETYPE,
        ContactsContract.CommonDataKinds.Phone.CONTENT_ITEM_TYPE
);

// Adds the phone number and its type to the row
phoneRow.put(ContactsContract.CommonDataKinds.Phone.NUMBER, phone);

// Adds the row to the array
contactData.add(phoneRow);

/*
 * Sets up the email data row
 */

// Sets up the row as a ContentValues object
ContentValues emailRow = new ContentValues();

// Specifies the MIME type for this data row (all data rows must be marked by their type)
emailRow.put(
        ContactsContract.Data.MIMETYPE,
        ContactsContract.CommonDataKinds.Email.CONTENT_ITEM_TYPE
);

// Adds the email address and its type to the row
emailRow.put(ContactsContract.CommonDataKinds.Email.ADDRESS, email);

// Adds the row to the array
contactData.add(emailRow);

/*
 * Adds the array to the intent's extras. It must be a parcelable object in order to
 * travel between processes. The device's contacts app expects its key to be
 * Intents.Insert.DATA
 */
insertIntent.putParcelableArrayListExtra(ContactsContract.Intents.Insert.DATA, contactData);

// Send out the intent to start the device's contacts app in its add contact activity.
startActivity(insertIntent);
</pre>
<h3 id="DataIntegrity">Целостность данных</h3>
<p>
    Поскольку в репозитории контактов содержится важная и конфиденциальная информация, которая, как ожидает пользователь, верна и
актуальна, в поставщике контактов предусмотрены четко определенные правила для обеспечения целостности данных. При изменении данных контактов вы обязаны
соблюдать эти правила. Вот наиболее
важные из этих правил:
</p>
<dl>
    <dt>
        Всегда добавляйте строку <code><a href="https://developer.android.com/reference/android/provider/ContactsContract.CommonDataKinds.StructuredName.html?hl=ru">ContactsContract.CommonDataKinds.StructuredName</a></code>
к каждой добавляемой вами строке <code><a href="https://developer.android.com/reference/android/provider/ContactsContract.RawContacts.html?hl=ru">ContactsContract.RawContacts</a></code>.
    </dt>
    <dd>
        Если в таблице <code><a href="https://developer.android.com/reference/android/provider/ContactsContract.Data.html?hl=ru">ContactsContract.Data</a></code> имеется строка <code><a href="https://developer.android.com/reference/android/provider/ContactsContract.RawContacts.html?hl=ru">ContactsContract.RawContacts</a></code>
без строки <code><a href="https://developer.android.com/reference/android/provider/ContactsContract.CommonDataKinds.StructuredName.html?hl=ru">ContactsContract.CommonDataKinds.StructuredName</a></code>,
то могут возникнуть
проблемы во время агрегирования.
    </dd>
    <dt>
        Всегда связывайте новые строки <code><a href="https://developer.android.com/reference/android/provider/ContactsContract.Data.html?hl=ru">ContactsContract.Data</a></code> с их
родительскими строками <code><a href="https://developer.android.com/reference/android/provider/ContactsContract.RawContacts.html?hl=ru">ContactsContract.RawContacts</a></code>.
    </dt>
    <dd>
        Строка <code><a href="https://developer.android.com/reference/android/provider/ContactsContract.Data.html?hl=ru">ContactsContract.Data</a></code>, которая не связана
с <code><a href="https://developer.android.com/reference/android/provider/ContactsContract.RawContacts.html?hl=ru">ContactsContract.RawContacts</a></code>, не будет отображаться в
приложении для работы с контактами, имеющемся на устройстве, а также может привести к проблемам с адаптерами синхронизации.
    </dd>
    <dt>
        Следует изменять данные только тех необработанных контактов, которыми вы владеете.
    </dt>
    <dd>
        Помните о том, что поставщик контактов обычно управляет данными из
нескольких аккаунтов различных типов или служб в Интернете. Необходимо убедиться в том, что ваше приложение изменяет
или удаляет данные только для тех строк, которые принадлежат вам, а также в том, что оно вставляет данные с использованием только тех типов и имени аккаунта,
которыми вы управляете.
    </dd>
    <dt>
        Всегда используйте
для центров, URI контента, путей URI, имен столбцов, типов MIME и значений
<code><a href="https://developer.android.com/reference/android/provider/ContactsContract.CommonDataKinds.CommonColumns.html?hl=ru#TYPE">TYPE</a></code> только те константы, которые определены в классе <code><a href="https://developer.android.com/reference/android/provider/ContactsContract.html?hl=ru">ContactsContract</a></code> и его подклассах.
    </dt>
    <dd>
        Это позволит избежать ошибок. Если какая либо константа устарела, компилятор сообщит об этом
с помощью соответствующего предупреждения.
    </dd>
</dl>
<h3 id="CustomData">Настраиваемые строки данных</h3>
<p>
    Создав и используя собственные типы MIME, вы можете вставлять, изменять, удалять и извлекать
в таблице<code><a href="https://developer.android.com/reference/android/provider/ContactsContract.Data.html?hl=ru">ContactsContract.Data</a></code> собственные строки данных. Ваши строки
ограничены использованием столбца, который определен в
<code><a href="https://developer.android.com/reference/android/provider/ContactsContract.DataColumns.html?hl=ru">ContactsContract.DataColumns</a></code>, однако вы можете сопоставить ваши собственные имена столбцов по типам строк
с именами столбцов по умолчанию. Данные для ваших строк отображаются в приложении для работы с контактами, которое имеется на устройстве,
однако их не удастся изменить или удалить, а также пользователи не смогут
добавить дополнительные данные. Чтобы разрешить пользователям изменять ваши настраиваемые строки данных, необходимо реализовать в вашем приложении операцию
редактора.
</p>
<p>
    Для отображения настраиваемых данных укажите файл <code>contacts.xml</code>, содержащий элемент
<code>&lt;ContactsAccountType&gt;</code> и один или несколько его
<code>&lt;ContactsDataKind&gt;</code> дочерних элементов. Дополнительные сведения об этом представлены в разделе
<a href="#SocialStreamDataKind"><code>&lt;ContactsDataKind&gt; element</code></a>.
</p>
<p>
    Дополнительные сведения о настраиваемых типах MIME представлены в руководстве
<a href="content-provider-creating9201.html?hl=ru">Создание
поставщика контента</a>.
</p>
<h2 id="SyncAdapters">Адаптеры синхронизации поставщика контактов</h2>
<p>
    Поставщик контактов разработан специально для обработки операций <strong>синхронизации</strong>
данных контактов между устройством и службой в Интернете. Благодаря этому пользователи
могут загружать существующие данные на новое устройство и отправлять их в новый аккаунт.
    Синхронизация также обеспечивает предоставление пользователю всегда актуальных сведений, независимо от
источника их добавления и внесенных в них изменений. Еще одно преимущество синхронизации заключается в том,
что данные контактов доступны даже в том случае, если устройство не подключено к сети.
</p>
<p>
    Несмотря на множество различных способов реализации синхронизации данных, в системе Android имеется
подключаемая платформа синхронизации, которая позволяет автоматизировать выполнение следующих задач:
    <ul>

    <li>
        проверка доступности сети;
    </li>
    <li>
        планирование и выполнение синхронизации на основе предпочтений пользователя;
    </li>
    <li>
        перезапуск остановленных процессов синхронизации.
    </li>
    </ul>
<p>
    Для использования этой платформы вы предоставляете подключаемый модуль адаптера синхронизации. Каждый адаптер синхронизации является уникальным
для службы и поставщика контента, однако способен работать с несколькими аккаунтами в одной службе. В платформе
также предусмотрена возможность использовать несколько адаптеров синхронизации для одной и той же службы или поставщика.
</p>
<h3 id="SyncClassesFiles">Классы и файлы адаптера синхронизации</h3>
<p>
    Адаптер синхронизации реализуется как подкласс класса
<code><a href="https://developer.android.com/reference/android/content/AbstractThreadedSyncAdapter.html?hl=ru">AbstractThreadedSyncAdapter</a></code> и устанавливается в составе приложения
Android. Система узнает о наличии адаптера синхронизации из элементов в манифесте
вашего приложения, а также из особого файла XML, на который имеется указание в манифесте. В файле XML определяются
тип аккаунта в онлайн-службе и центр поставщика контента, которые вместе служат уникальными
идентификаторами адаптера. Адаптер синхронизации находится в неактивном состоянии до тех пор, пока пользователь не добавит
тип аккаунта и не включит синхронизацию
с поставщиком контента.  На этом этапе система вступает в управление адаптером
, при необходимости вызывая его для синхронизации данных между поставщиком контента и сервером.
</p>
<p class="note">
    <strong>Примечание.</strong> Использование типа аккаунта для идентификации адаптера синхронизации
позволяет системе обнаруживать и группировать адаптеры синхронизации, которые обращаются к разным службам
из одной и той же организации. Например, у всех адаптеров синхронизации для онлайн-служб Google
один и тот же тип аккаунта — <code>com.google</code>. Когда пользователи добавляют на свои устройства аккаунт Google, все
установленные адаптеры синхронизации группируются вместе; каждый из адаптеров
синхронизируется только с отдельным поставщиком контента на устройстве.
</p>
<p>
    Поскольку в большинстве служб пользователям сначала необходимо подтвердить свою подлинность, прежде чем они смогут получить доступ к данным,
система Android предлагает платформу аутентификации, которая аналогична
платформе адаптера синхронизации и зачастую используется совместно с ней. Платформа аутентификации
использует подключаемые структуры проверки подлинности, которые представляют собой подклассы класса
<code><a href="https://developer.android.com/reference/android/accounts/AbstractAccountAuthenticator.html?hl=ru">AbstractAccountAuthenticator</a></code>. Такая структура проверяет
подлинность пользователя следующим образом:
    <ol>
        <li>
            Сначала собираются сведения об имени пользователя и его пароле или аналогичная информация (<strong>учетные данные</strong>
пользователя).
        </li>
        <li>
            Затем учетные данные оправляются в службу.
        </li>
        <li>
            Наконец, изучается ответ, полученный от службы.
        </li>
    </ol>
<p>
    Если служба приняла учетные данные, структура проверки подлинности может
сохранить их для использования в дальнейшем. Благодаря использованию структур проверки подлинности
<code><a href="https://developer.android.com/reference/android/accounts/AccountManager.html?hl=ru">AccountManager</a></code> может предоставить доступ к любым маркерам аутентификации, которые
поддерживает структура проверки подлинности и которые она решает предоставить, например, к маркерам аутентификации OAuth2.
</p>
<p>
    Несмотря на то что аутентификация не требуется, она используется большинством служб для работы с контактами.
    Тем не менее, вам не обязательно использовать платформу аутентификации Android для проверки подлинности.
</p>
<h3 id="SyncAdapterImplementing">Реализация адаптера синхронизации</h3>
<p>
    Чтобы реализовать адаптер синхронизации для поставщика контактов, начните с создания
приложения Android, которое содержит следующие компоненты.
</p>
    <dl>
        <dt>
            Компонент <code><a href="https://developer.android.com/reference/android/app/Service.html?hl=ru">Service</a></code>, который отвечает на запросы системы
для привязки к адаптеру синхронизации.
        </dt>
        <dd>
            Когда системе требуется запустить синхронизацию, она вызывает метод
<code><a href="https://developer.android.com/reference/android/app/Service.html?hl=ru#onBind(android.content.Intent)">onBind()</a></code> службы, чтобы получить объект
<code><a href="https://developer.android.com/reference/android/os/IBinder.html?hl=ru">IBinder</a></code> для адаптера синхронизации. Благодаря этому система
может вызывать методы адаптера между процессами.
            <p>
                В
<a href="https://developer.android.com/resources/samples/SampleSyncAdapter/index.html?hl=ru">примере адаптера синхронизации</a> именем класса этой службы является
<code>com.example.android.samplesync.syncadapter.SyncService</code>.
            </p>
        </dd>
        <dt>
            Адаптер синхронизации, фактически реализованный как конкретный подкласс
класса <code><a href="https://developer.android.com/reference/android/content/AbstractThreadedSyncAdapter.html?hl=ru">AbstractThreadedSyncAdapter</a></code>.
        </dt>
        <dd>
            Этот класс не подходит для загрузки данных с сервера, отправки данных
с устройства и разрешения конфликтов. Основную свою работу адаптер
выполняет в методе <code><a href="https://developer.android.com/reference/android/content/AbstractThreadedSyncAdapter.html?hl=ru#onPerformSync(android.accounts.Account, android.os.Bundle, java.lang.String, android.content.ContentProviderClient, android.content.SyncResult)">onPerformSync()</a></code>. Этот класс допускает создание только одного экземпляра.
            <p>
                В
<a href="https://developer.android.com/resources/samples/SampleSyncAdapter/index.html?hl=ru">примере адаптера синхронизации</a> адаптер определяется в классе
<code>com.example.android.samplesync.syncadapter.SyncAdapter</code>.
            </p>
        </dd>
        <dt>
            Подкласс класса <code><a href="https://developer.android.com/reference/android/app/Application.html?hl=ru">Application</a></code>.
        </dt>
        <dd>
            Этот класс выступает в роли фабрики для единственного экземпляра адаптера синхронизации. Воспользуйтесь методом
<code><a href="https://developer.android.com/reference/android/app/Application.html?hl=ru#onCreate()">onCreate()</a></code>, чтобы создать экземпляр адаптера синхронизации, а затем
предоставьте статический метод get, чтобы возвратить единственный экземпляр в метод
<code><a href="https://developer.android.com/reference/android/app/Service.html?hl=ru#onBind(android.content.Intent)">onBind()</a></code> службы
адаптера синхронизации.
        </dd>
        <dt>
            <strong>Необязательно:</strong> компонент <code><a href="https://developer.android.com/reference/android/app/Service.html?hl=ru">Service</a></code>, который отвечает на запросы
системы для аутентификации пользователей.
        </dt>
        <dd>
            <code><a href="https://developer.android.com/reference/android/accounts/AccountManager.html?hl=ru">AccountManager</a></code> запускает службу, чтобы начать процесс
аутентификации. Метод <code><a href="https://developer.android.com/reference/android/app/Service.html?hl=ru#onCreate()">onCreate()</a></code> службы создает экземпляр
объекта структуры проверки подлинности. Когда системе требуется запустить аутентификацию аккаунта пользователя для
адаптера синхронизации приложения, она вызывает метод
<code><a href="https://developer.android.com/reference/android/app/Service.html?hl=ru#onBind(android.content.Intent)">onBind()</a></code> службы, чтобы получить объект
<code><a href="https://developer.android.com/reference/android/os/IBinder.html?hl=ru">IBinder</a></code> для структуры проверки подлинности. Благодаря этому система
может вызывать методы структуры проверки подлинности между процессами.
            <p>
                В
<a href="https://developer.android.com/resources/samples/SampleSyncAdapter/index.html?hl=ru">примере адаптера синхронизации</a> именем класса этой службы является
<code>com.example.android.samplesync.authenticator.AuthenticationService</code>.
            </p>
        </dd>
        <dt>
            <strong>Необязательно:</strong> конкретный подкласс класса
<code><a href="https://developer.android.com/reference/android/accounts/AbstractAccountAuthenticator.html?hl=ru">AbstractAccountAuthenticator</a></code>, который обрабатывает запросы на
аутентификацию.
        </dt>
        <dd>
            В этом классе имеются методы, которые <code><a href="https://developer.android.com/reference/android/accounts/AccountManager.html?hl=ru">AccountManager</a></code> вызывает
для проверки подлинности учетных данных пользователя на сервере. Подробности процесса
аутентификации значительно различаются в зависимости от технологии, используемой на сервере. Чтобы узнать подробнее об аутентификации,
обратитесь к соответствующей документации к программному обеспечению используемого сервера.
            <p>
                В
<a href="https://developer.android.com/resources/samples/SampleSyncAdapter/index.html?hl=ru">примере адаптера синхронизации</a> структура проверки подлинности определяется в классе
<code>com.example.android.samplesync.authenticator.Authenticator</code>.
            </p>
        </dd>
        <dt>
            Файлы XML, в которых определяются адаптер синхронизация и структура проверки подлинности для системы.
        </dt>
        <dd>
            Описанные ранее компоненты службы адаптера синхронизации и структуры проверки подлинности определяются
в элементах
<code>&lt;<a href="../manifest/service-element9201.html?hl=ru">service</a>&gt;</code>
в манифесте приложения. Эти элементы
включают дочерние элементы
<code>&lt;<a href="../manifest/meta-data-element9201.html?hl=ru">meta-data</a>&gt;</code>
, в которых имеются определенные данные для
системы.
            <ul>
                <li>
                    Элемент
<code>&lt;<a href="../manifest/meta-data-element9201.html?hl=ru">meta-data</a>&gt;</code>
для службы адаптера синхронизации указывает на файл
XML <code>res/xml/syncadapter.xml</code>. В свою очередь, в этом файле задается
URI веб-службы для синхронизации с поставщиком контактов,
а также тип аккаунта для этой веб-службы.
                </li>
                <li>
                    <strong>Необязательно:</strong> элемент
<code>&lt;<a href="../manifest/meta-data-element9201.html?hl=ru">meta-data</a>&gt;</code>
для структуры проверки подлинности указывает на файл XML
<code>res/xml/authenticator.xml</code>. В свою очередь, в этом файле задается
тип аккаунта, который поддерживает структура проверки подлинности, а также ресурсы пользовательского интерфейса,
которые отображаются в процессе аутентификации. Тип аккаунта, указанный в этом
элементе, должен совпадать с типом аккаунта, который задан для
адаптера синхронизации.
                </li>
            </ul>
        </dd>
    </dl>
<h2 id="SocialStream">Потоки данных из социальных сетей</h2>
<p>
    Для управления входящими данными из социальных сетей используются таблицы <code>android.provider.ContactsContract.StreamItems</code>
и
<code>android.provider.ContactsContract.StreamItemPhotos</code>. Можно создать адаптер синхронизации, который добавляет поток данных
из вашей собственной сети в эти таблицы, либо вы можете считывать поток данных из этих таблиц и отображать
их в собственном приложении. Можно также реализовать оба этих способа. С помощью этих функций вы можете интегрировать службы социальных сетей
в компоненты Android для работы с социальными сетями.
</p>
<h3 id="StreamText">Текст из потока данных из социальных сетей</h3>
<p>
    Элементы потока всегда ассоциируются с необработанным контактом. Идентификатор
<code>android.provider.ContactsContract.StreamItemsColumns#RAW_CONTACT_ID</code> связывается со значением
<code>_ID</code> необработанного контакта. Тип аккаунта и его имя для необработанного
контакта также хранятся в строке элемента потока.
</p>
<p>
    Данные из потока следует хранить в следующих столбцах:
</p>
<dl>
    <dt>
        <code>android.provider.ContactsContract.StreamItemsColumns#ACCOUNT_TYPE</code>
    </dt>
    <dd>
        <strong>Обязательный.</strong> Тип аккаунта пользователя для необработанного контакта, связанного с
этим элементом потока. Не забудьте задать это значение при вставке элемента потока.
    </dd>
    <dt>
        <code>android.provider.ContactsContract.StreamItemsColumns#ACCOUNT_NAME</code>
    </dt>
    <dd>
        <strong>Обязательный.</strong> Имя аккаунта пользователя для необработанного контакта, связанного с
этим элементом потока. Не забудьте задать это значение при вставке элемента потока.
    </dd>
    <dt>
        Столбцы идентификатора
    </dt>
    <dd>
        <strong>Обязательный.</strong> При вставке элемента потока необходимо вставить
указанные ниже столбцы идентификатора.
        <ul>
            <li>
                <code>android.provider.ContactsContract.StreamItemsColumns#CONTACT_ID</code>: значение
<code>android.provider.BaseColumns#_ID</code> для контакта, с которым ассоциирован
этот элемент потока.
            </li>
            <li>
                <code>android.provider.ContactsContract.StreamItemsColumns#CONTACT_LOOKUP_KEY</code>: значение
<code>android.provider.ContactsContract.ContactsColumns#LOOKUP_KEY</code> для контакта, с которым ассоциирован
этот элемент потока.
            </li>
            <li>
                <code>android.provider.ContactsContract.StreamItemsColumns#RAW_CONTACT_ID</code>: значение
<code>android.provider.BaseColumns#_ID</code> для необработанного контакта, с которым ассоциирован
этот элемент потока.
            </li>
        </ul>
    </dd>
    <dt>
        <code>android.provider.ContactsContract.StreamItemsColumns#COMMENTS</code>
    </dt>
    <dd>
        Необязательный. В нем хранится сводная информация, которую можно отобразить в начале элемента потока.
    </dd>
    <dt>
        <code>android.provider.ContactsContract.StreamItemsColumns#TEXT</code>
    </dt>
    <dd>
        Текст элемента потока: либо контент, опубликованный источником элемента,
либо описание некоторого действия, сгенерировавшего элемент потока. В этом столбце могут содержаться
любое форматирование и встроенные изображения ресурсов, рендеринг которых можно выполнить с помощью метода
<code><a href="https://developer.android.com/reference/android/text/Html.html?hl=ru#fromHtml(java.lang.String)">fromHtml()</a></code>. Поставщик может обрезать слишком длинный контент
или заменить его часть многоточием, однако он попытается избежать нарушения тегов.
    </dd>
    <dt>
        <code>android.provider.ContactsContract.StreamItemsColumns#TIMESTAMP</code>
    </dt>
    <dd>
        Текстовая строка с информацией о времени вставки или обновления элемента в
<em>миллисекундах</em> от начала отсчета времени. Обслуживанием этого столбца занимаются приложения, которые вставляют или
обновляют элементы потока; поставщик контактов не выполняет
это автоматически.
    </dd>
</dl>
<p>
    Для отображения идентификационной информации для элементов потока воспользуйтесь
<code>android.provider.ContactsContract.StreamItemsColumns#RES_ICON</code>,
<code>android.provider.ContactsContract.StreamItemsColumns#RES_LABEL</code> и
<code>android.provider.ContactsContract.StreamItemsColumns#RES_PACKAGE</code> для связывания с ресурсами
в вашем приложении.
</p>
<p>
    В таблице <code>android.provider.ContactsContract.StreamItems</code> также имеются столбцы
<code>android.provider.ContactsContract.StreamItemsColumns#SYNC1</code>—<code>android.provider.ContactsContract.StreamItemsColumns#SYNC4</code>,
которые предназначены исключительно для
адаптеров синхронизации.
</p>
<h3 id="StreamPhotos">Фотографии из потока данных из социальных сетей</h3>
<p>
   Фотографии, связанные с элементом потока, хранятся в таблице
<code>android.provider.ContactsContract.StreamItemPhotos</code>. Столбец
<code>android.provider.ContactsContract.StreamItemPhotosColumns#STREAM_ITEM_ID</code>
в этой таблице связан со столбцом <code>android.provider.BaseColumns#_ID</code>
в таблице <code>android.provider.ContactsContract.StreamItems</code>. Ссылки на фотографии хранятся в следующих столбцах
таблицы:
</p>
<dl>
    <dt>
        Столбец <code>android.provider.ContactsContract.StreamItemPhotos#PHOTO</code> (объект BLOB).
    </dt>
    <dd>
        Представление фотографии в двоичном формате и с измененным поставщиком размером для ее хранения и отображения.
        Этот столбец доступен для обеспечения обратной совместимости с предыдущими версиями поставщика
контактов, которые использовались для хранения фотографий. Однако в текущей версии
поставщика мы не рекомендуем использовать этот столбец для хранения фотографий. Вместо этого воспользуйтесь столбцом
<code>android.provider.ContactsContract.StreamItemPhotosColumns#PHOTO_FILE_ID</code> или
<code>android.provider.ContactsContract.StreamItemPhotosColumns#PHOTO_URI</code> (или обоими
столбцами, как описано далее) для хранения фотографий в файле. В этом
столбце теперь хранятся миниатюры фотографий, доступных для чтения.
    </dd>
    <dt>
        <code>android.provider.ContactsContract.StreamItemPhotosColumns#PHOTO_FILE_ID</code>
    </dt>
    <dd>
        Числовой идентификатор фотографии для необработанного контакта. Добавьте это значение к константе
<code><a href="https://developer.android.com/reference/android/provider/ContactsContract.DisplayPhoto.html?hl=ru#CONTENT_URI">DisplayPhoto.CONTENT_URI</a></code>,
чтобы получить URI контента для одного файла фотографии, а затем вызовите метод
<code><a href="https://developer.android.com/reference/android/content/ContentResolver.html?hl=ru#openAssetFileDescriptor(android.net.Uri, java.lang.String)">openAssetFileDescriptor()</a></code>, чтобы получить средство обработки файла фотографии.
    </dd>
    <dt>
        <code>android.provider.ContactsContract.StreamItemPhotosColumns#PHOTO_URI</code>
    </dt>
    <dd>
        URI контента, указывающий на файл фотографии, для фотографии, которая представлена этой строкой.
        Вызовите метод <code><a href="https://developer.android.com/reference/android/content/ContentResolver.html?hl=ru#openAssetFileDescriptor(android.net.Uri, java.lang.String)">openAssetFileDescriptor()</a></code>, передав в него этот URI, чтобы получить средство обработки файла фотографии.
    </dd>
</dl>
<h3 id="SocialStreamTables">Использование таблиц из потока данных из социальных сетей</h3>
<p>
    Эти таблицы работают аналогично другим основным таблицам в поставщике контактов, за исключением указанных ниже моментов.
</p>
    <ul>
        <li>
            Для работы с этими таблицами требуются дополнительные разрешения на доступ. Для чтения данных из них вашему приложению
должно быть предоставлено разрешение <code>android.Manifest.permission#READ_SOCIAL_STREAM</code>. Для
изменения таблиц ваше приложение должно иметь разрешение
<code>android.Manifest.permission#WRITE_SOCIAL_STREAM</code>.
        </li>
        <li>
            Для таблицы <code>android.provider.ContactsContract.StreamItems</code> существует ограничение на количество строк,
которое можно хранить для каждого необработанного контакта. При достижении этого ограничения
поставщик контактов освобождает место для новых строк элементов потока путем автоматического удаления
строк со самой старой меткой
<code>android.provider.ContactsContract.StreamItemsColumns#TIMESTAMP</code>. Чтобы получить это ограничение,
запросите URI контента
<code>android.provider.ContactsContract.StreamItems#CONTENT_LIMIT_URI</code>. Для всех аргументов,
отличных от URI контента, можно оставить значение <code>null</code>. Запрос возвращает
объект Cursor, в котором содержится одна строка с одним столбцом
<code>android.provider.ContactsContract.StreamItems#MAX_ITEMS</code>.
        </li>
    </ul>

<p>
    Класс <code>android.provider.ContactsContract.StreamItems.StreamItemPhotos</code> определяет
дочернюю таблицу объектов <code>android.provider.ContactsContract.StreamItemPhotos</code>, в которой содержатся
строки для одного элемента потока.
</p>
<h3 id="SocialStreamInteraction">Взаимодействие с потоками данных из социальных сетей</h3>
<p>
    Управление потоком данных из социальных сетей осуществляется поставщиком контактов совместно с приложением для управления контактами, имеющимся на устройстве.
Такой подход позволяет организовать эффективное использование данных из социальных сетей
с данными о существующих контактах. Доступны указанные ниже функции.
</p>
    <ul>
        <li>
            Организовав синхронизацию данных из социальной службы с поставщиком контактов посредством
адаптера синхронизации, вы можете получать данные о недавней активности контактов пользователя и хранить такие данные в таблицах
,<code>android.provider.ContactsContract.StreamItems</code>
и <code>android.provider.ContactsContract.StreamItemPhotos</code> для использования в дальнейшем.
        </li>
        <li>
            Помимо регулярной синхронизации, адаптер синхронизации можно настроить на получение
дополнительных данных при выборе пользователем контакта для просмотра. Благодаря этому ваш адаптер синхронизации
может получать фотографии высокого разрешения и самые актуальные элементы потока для контакта.
        </li>
        <li>
            Регистрируя уведомление в приложении для работы с контактами и в поставщике
контактов, вы можете<em>получать</em> намерения при просмотре контакта и обновлять на этом этапе
данные о состоянии контакта из вашей службы. Такой подход может обеспечить большее быстродействие и меньший объем
использования полосы пропускания, чем выполнение полной синхронизации с помощью адаптера синхронизации.
        </li>
        <li>
            Пользователи могут добавить контакт в вашу службу социальной сети, обратившись к контакту
в приложении для работы с контактами, которое имеется на устройстве. Это реализуется с помощью функции «пригласить контакт»,
для включения которой используется сочетание операции,
которая добавляет существующий контакт в вашу сеть, и файла XML, в котором представлены сведения о вашем приложении для поставщика контактов и приложения для работы с
контактами.
        </li>
    </ul>
<p>
    Регулярная синхронизация элементов потока с помощью поставщика контактов выполняется так же,
как и любая другая синхронизация. Дополнительные сведения о синхронизации представлены в разделе
<a href="#SyncAdapters">Адаптеры синхронизации поставщика контактов</a>. Регистрация уведомлений
и приглашение контактов рассматриваются в следующих двух разделах.
</p>
<h4>Регистрация для обработки просмотров контактов в социальных сетях</h4>
<p>
    Чтобы зарегистрировать адаптер синхронизации для получения уведомлений о просмотрах пользователями контакта,
управление которым осуществляется вашим адаптером синхронизации, выполните указанные ниже действия.
</p>
<ol>
    <li>
        В каталоге <code>res/xml/</code> своего проекта создайте файл
<code>contacts.xml</code>. Если у вас уже есть этот файл, переходите к следующему действию.
    </li>
    <li>
        В этом файле добавьте элемент
<code>&lt;ContactsAccountType xmlns:android="http://schemas.android.com/apk/res/android"&gt;</code>.
        Если этот элемент уже существует, можете переходить к следующему действию.
    </li>
    <li>
        Чтобы зарегистрировать службу, которой отправляется уведомление при открытии пользователем страницы со сведениями о контакте
в приложении для работы с контактами, которое имеется на устройстве, добавьте атрибут
<code>viewContactNotifyService="<em>serviceclass</em>"</code> к элементу, где
<code><em>serviceclass</em></code> — это полное имя класса службы,
которая должна получить намерение из приложения для работы с контактами. Для службы-уведомителя
используйте класс, который является расширением класса <code><a href="https://developer.android.com/reference/android/app/IntentService.html?hl=ru">IntentService</a></code>, чтобы разрешить службе
получать намерения. Данные во входящем намерении содержат URI контента необработанного
контакта, выбранного пользователем. В службе-уведомителе можно привязать адаптер синхронизации, а затем вызвать его
для обновления данных для необработанного контакта.
    </li>
</ol>
<p>
    Чтобы зарегистрировать операцию, которую следует вызвать при выборе пользователем элемента потока или фотографии (или обоих элементов), выполните указанные ниже действия.
</p>
<ol>
    <li>
        В каталоге <code>res/xml/</code> своего проекта создайте файл
<code>contacts.xml</code>. Если у вас уже есть этот файл, переходите к следующему действию.
    </li>
    <li>
        В этом файле добавьте элемент
<code>&lt;ContactsAccountType xmlns:android="http://schemas.android.com/apk/res/android"&gt;</code>.
        Если этот элемент уже существует, можете переходить к следующему действию.
    </li>
    <li>
        Чтобы зарегистрировать одну из ваших операций для обработки выбора пользователем элемента потока
в приложении для работы с контактами, которое имеется на устройстве, добавьте атрибут
<code>viewStreamItemActivity="<em>activityclass</em>"</code> к элементу, где
<code><em>activityclass</em></code> — это полное имя класса операции,
которая должна получить намерение из приложения для работы с контактами.
    </li>
    <li>
        Чтобы зарегистрировать одну из ваших операций для обработки выбора пользователем фотографии в потоке
в приложении для работы с контактами, которое имеется на устройстве, добавьте атрибут
<code>viewStreamItemPhotoActivity="<em>activityclass</em>"</code> к элементу, где
<code><em>activityclass</em></code> — это полное имя класса операции,
которая должна получить намерение из приложения для работы с контактами.
    </li>
</ol>
<p>
    Дополнительные сведения об элементе <code>&lt;ContactsAccountType&gt;</code> представлены в разделе
<a href="#SocialStreamAcctType">элемент &lt;ContactsAccountType&gt;</a>.
</p>
<p>
    Данные во входящем намерении содержат URI контента элемента или фотографии, выбранных пользователем.
    Чтобы использовать разные операции для текстовых элементов и фотографий, используйте оба атрибута в одном файле.
</p>
<h4>Взаимодействие со службой социальной сети</h4>
<p>
    Пользователям не обязательно выходить из приложения для работы с контактами, которое имеется на устройстве, чтобы пригласить контакт на сайт
социальной сети. Вместо этого приложение для работы с контактами может отправить намерение для приглашения
контакта в одну из ваших операций. Для этого выполните указанные ниже действия.
</p>
<ol>
    <li>
        В каталоге <code>res/xml/</code> своего проекта создайте файл
<code>contacts.xml</code>. Если у вас уже есть этот файл, переходите к следующему действию.
    </li>
    <li>
        В этом файле добавьте элемент
<code>&lt;ContactsAccountType xmlns:android="http://schemas.android.com/apk/res/android"&gt;</code>.
        Если этот элемент уже существует, можете переходить к следующему действию.
    </li>
    <li>
        Добавьте следующие атрибуты:
        <ul>
            <li><code>inviteContactActivity="<em>activityclass</em>"</code>;</li>
            <li>
                <code>inviteContactActionLabel="&#64;string/<em>invite_action_label</em>"</code>.
            </li>
        </ul>
        Значение <code><em>activityclass</em></code> представляет собой полное имя класса операции,
которая должна получить намерение. Значение<code><em>invite_action_label</em></code>
— это текстовая строка, которая отображается в меню <strong>Добавить подключение</strong>
в приложении для работы с контактами.
    </li>
</ol>
<p class="note">
    <strong>Примечание.</strong> <code>ContactsSource</code> — это устаревшее имя тега для
<code>ContactsAccountType</code>, которое больше не используется.
</p>
<h3 id="ContactsFile">Ссылка contacts.xml</h3>
<p>
    В файле <code>contacts.xml</code> содержатся элементы XML, которые управляют взаимодействием вашего
адаптера синхронизации и вашего приложения с поставщиком контактов и приложением для работы с контактами. Эти
элементы описаны в следующих разделах.
</p>
<h4 id="SocialStreamAcctType">Элемент &lt;ContactsAccountType&gt;</h4>
<p>
    Элемент <code>&lt;ContactsAccountType&gt;</code> управляет взаимодействием вашего
приложения с приложением для работы с контактами. Ниже представлен его синтаксис.
</p>
<pre>
&lt;ContactsAccountType
        xmlns:android="http://schemas.android.com/apk/res/android"
        inviteContactActivity="<em>activity_name</em>"
        inviteContactActionLabel="<em>invite_command_text</em>"
        viewContactNotifyService="<em>view_notify_service</em>"
        viewGroupActivity="<em>group_view_activity</em>"
        viewGroupActionLabel="<em>group_action_text</em>"
        viewStreamItemActivity="<em>viewstream_activity_name</em>"
        viewStreamItemPhotoActivity="<em>viewphotostream_activity_name</em>"&gt;
</pre>
<p>
    <strong>находится в:</strong>
</p>
<p>
    <code>res/xml/contacts.xml</code>
</p>
<p>
    <strong>может содержать:</strong>
</p>
<p>
    <strong><code>&lt;ContactsDataKind&gt;</code></strong>
</p>
<p>
    <strong>Описание</strong>
</p>
<p>
    Этот элемент объявляет компоненты и элементы пользовательского интерфейса, с помощью которых пользователи могут приглашать свои контакты
в социальную сеть, уведомлять пользователей при обновлении одного из их потоков данных из социальных сетей и
др.
</p>
<p>
    Обратите внимание, что префикс атрибута <code>android:</code> необязательно использовать для атрибутов
<code>&lt;ContactsAccountType&gt;</code>.
</p>
<p>
    <strong>Атрибуты</strong>
</p>
<dl>
    <dt><code>inviteContactActivity</code></dt>
    <dd>
        Полное имя класса операции в вашем приложении, которую необходимо активировать
при выборе пользователем элемента <strong>Добавить подключение</strong> в приложении
для работы с контактами, которое имеется на устройстве.
    </dd>
    <dt><code>inviteContactActionLabel</code></dt>
    <dd>
        Текстовая строка, которая отображается для операции, заданной в
<code>inviteContactActivity</code>, в меню <strong>Добавить подключение</strong>.
        Например, можно указать фразу «Следите за новостями в моей сети». Для этого элемента можно использовать
идентификатор строкового ресурса.
    </dd>
    <dt><code>viewContactNotifyService</code></dt>
    <dd>
        Полное имя класса службы в вашем приложении, которая должна получать
уведомления при просмотре контакта пользователем. Такое уведомление отправляется приложением для работы с контактами,
которое имеется на устройстве; благодаря этому ваше приложение может отложить выполнение операций, требующих обработки большого объема данных, до тех пор
, пока это не потребуется. Например, ваше приложение может реагировать на такое уведомление
путем считывания и отображения фотографии контакта в высоком разрешении и самых актуальных
элементов потока данных из социальной сети. Дополнительные сведения об этой функции представлены в разделе
<a href="#SocialStreamInteraction">Взаимодействие с потоками данных из социальных сетей</a>. Пример
службы уведомлений представлен в файле
<code>NotifierService.java</code> в
образце приложения<a href="https://developer.android.com/resources/samples/SampleSyncAdapter/index.html?hl=ru">SampleSyncAdapter</a>.
    </dd>
    <dt><code>viewGroupActivity</code></dt>
    <dd>
        Полное имя класса операции в вашем приложении, которая может отобразить
информацию о группе. При нажатии пользователем на метку группы в приложении для работы с данными,
которое имеется на устройстве, отображается пользовательский интерфейс для этой операции.
    </dd>
    <dt><code>viewGroupActionLabel</code></dt>
    <dd>
        Метка, отображаемая приложением для работы с контактами для элемента пользовательского интерфейса, с помощью которой
пользователь может просмотреть группы в вашем приложении.
        <p>
            Например, если вы установили приложение Google+ на ваше устройство и выполняете синхронизацию
данных в Google+ с приложением для работы с контактами, то круги Google+ будут обозначены в приложении для работы с контактами как
группы на вкладке <strong>Группы</strong>. При нажатии на на круг
Google+ участники крга отобразятся как группа контактов. В верхней части экрана
находится значок Google+; если нажать на него, управление перейдет в приложение
Google+. В приложении для управления контактами это реализовано с помощью
<code>viewGroupActivity</code>, в которой значок Google+ используется в качестве значения
<code>viewGroupActionLabel</code>.
        </p>
        <p>
            Для этого атрибута можно использовать идентификатор строкового ресурса.
        </p>
    </dd>
    <dt><code>viewStreamItemActivity</code></dt>
    <dd>
        Полное имя класса операции в вашем приложении, которую запускает
приложение для работы с контактами, когда пользователь выбирает элемент потока для необработанного контакта.
    </dd>
    <dt><code>viewStreamItemPhotoActivity</code></dt>
    <dd>
        Полное имя класса операции в вашем приложении, которую запускает
приложение для работы с контактами, когда пользователь выбирает фотографию в элементе
потока для необработанного контакта.
    </dd>
</dl>
<h4 id="SocialStreamDataKind">Элемент &lt;ContactsDataKind&gt;</h4>
<p>
    Элемент <code>&lt;ContactsDataKind&gt;</code> управляет отображением настраиваемых строк данных вашего
приложения в интерфейсе приложения для работы с контактами, которое имеется на устройстве. Ниже представлен его синтаксис.
</p>
<pre>
&lt;ContactsDataKind
        android:mimeType="<em>MIMEtype</em>"
        android:icon="<em>icon_resources</em>"
        android:summaryColumn="<em>column_name</em>"
        android:detailColumn="<em>column_name</em>"&gt;
</pre>
<p>
    <strong>находится в:</strong>
</p>
<code>&lt;ContactsAccountType&gt;</code>
<p>
    <strong>Описание</strong>
</p>
<p>
    Используйте этот элемент для отображения содержимого настраиваемой строки данных в приложении для работы с контактами как части
сведений о необработанном контакте. Каждый дочерний элемент <code>&lt;ContactsDataKind&gt;</code>
элемента <code>&lt;ContactsAccountType&gt;</code> представляет собой тип настраиваемой строки данных, который
адаптер синхронизации добавляет в таблицу <code><a href="https://developer.android.com/reference/android/provider/ContactsContract.Data.html?hl=ru">ContactsContract.Data</a></code>. Для каждого используемого вами настраиваемого типа MIME необходимо добавить один элемент
<code>&lt;ContactsDataKind&gt;</code>. Вам не нужно добавлять элемент
, если у вас имеется настраиваемая строка данных, для которой не требуется отображать данные.
</p>
<p>
    <strong>Атрибуты</strong>
</p>
<dl>
    <dt><code>android:mimeType</code></dt>
    <dd>
        Определенные вами настраиваемые типы MIME для одного из ваших типов настраиваемых строк данных в таблице
<code><a href="https://developer.android.com/reference/android/provider/ContactsContract.Data.html?hl=ru">ContactsContract.Data</a></code>. Например, значение
<code>vnd.android.cursor.item/vnd.example.locationstatus</code> может быть настраиваемым
типом MIME для строки данных, в которой находятся записи о последнем известном местоположении контакта.
    </dd>
    <dt><code>android:icon</code></dt>
    <dd>
        <a href="../resources/drawable-resource9201.html?hl=ru">Графический ресурс </a>
Android,
который приложение для работы с контактами отображает рядом с вашими данными. Используйте его для обозначения того,
что эти данные получены из вашей службы.
    </dd>
    <dt><code>android:summaryColumn</code></dt>
    <dd>
        Имя столбца для первого из двух значений, полученных из строки данных. Значение
отображается в виде первой строки записи в этой строке данных. Первая строка
предназначена для использования в качестве сводных данных, однако она необязательна. См. также
<a href="#detailColumn">android:detailColumn</a>.
    </dd>
    <dt><code>android:detailColumn</code></dt>
    <dd>
        Имя столбца для второго из двух значений, полученных из строки данных. Значение
отображается в виде второй строки записи в этой строке данных. См. также
<code>android:summaryColumn</code>.
    </dd>
</dl>
<h2 id="AdditionalFeatures">Дополнительные возможности поставщика контактов</h2>
<p>
    Помимо основных функций, описанных разделах выше, в поставщике
контактов предусмотрены указанные ниже полезные функции для работы с данными контактов.
</p>
    <ul>
       <li>Группы контактов</li>
       <li>Функции работы с фотографиями</li>
    </ul>
<h3 id="Groups">Группы контактов</h3>
<p>
    Поставщик контактов может дополнительно отметить коллекции связанных контактов с данными о
<strong>группе</strong>. Если серверу, который связан с учетной записью пользователя,
требуется сохранить группы, адаптеру синхронизации для типа этого аккаунта следует передать
данные о группах из поставщика контактов на сервер. При добавлении пользователем нового контакта на сервер
и последующем помещении этого контакта в новую группу адаптер синхронизации должен добавить эту новую группу в таблицу
<code><a href="https://developer.android.com/reference/android/provider/ContactsContract.Groups.html?hl=ru">ContactsContract.Groups</a></code>. Группа или группы, в которые входит необработанный контакт,
хранятся в таблице <code><a href="https://developer.android.com/reference/android/provider/ContactsContract.Data.html?hl=ru">ContactsContract.Data</a></code> с использованием типа MIME
<code><a href="https://developer.android.com/reference/android/provider/ContactsContract.CommonDataKinds.GroupMembership.html?hl=ru">ContactsContract.CommonDataKinds.GroupMembership</a></code>.
</p>
<p>
    Если необходимо создать адаптер синхронизации, который будет добавлять данные необработанного контакта с сервера
в поставщик контактов, а вы не используете группы, то вам необходимо указать для поставщика,
чтобы он сделал ваши данные видимыми. В коде, который выполняется при добавлении пользователем
аккаунта на устройство, обновите строку <code><a href="https://developer.android.com/reference/android/provider/ContactsContract.Settings.html?hl=ru">ContactsContract.Settings</a></code>,
которую поставщик контактов добавляет для этого аккаунта. В этой строке укажите в столбце
<code><a href="https://developer.android.com/reference/android/provider/ContactsContract.SettingsColumns.html?hl=ru#UNGROUPED_VISIBLE">Settings.UNGROUPED_VISIBLE</a></code> значение «1». После этого поставщик контактов всегда будет
делать ваши данные видимыми, даже если вы не используете группы.
</p>
<h3 id="Photos">Фотографии контактов</h3>
<p>
    В таблице <code><a href="https://developer.android.com/reference/android/provider/ContactsContract.Data.html?hl=ru">ContactsContract.Data</a></code> хранятся фотографии в виде строк
<code><a href="https://developer.android.com/reference/android/provider/ContactsContract.CommonDataKinds.Photo.html?hl=ru#CONTENT_ITEM_TYPE">Photo.CONTENT_ITEM_TYPE</a></code> типа MIME. Столбец
<code><a href="https://developer.android.com/reference/android/provider/ContactsContract.RawContactsColumns.html?hl=ru#CONTACT_ID">CONTACT_ID</a></code> в строке связан со столбцом
<code>android.provider.BaseColumns#_ID</code> необработанного контакта, которому он принадлежит.
    Класс <code><a href="https://developer.android.com/reference/android/provider/ContactsContract.Contacts.Photo.html?hl=ru">ContactsContract.Contacts.Photo</a></code> определяет вложенную таблицу
<code><a href="https://developer.android.com/reference/android/provider/ContactsContract.Contacts.html?hl=ru">ContactsContract.Contacts</a></code>, в которой содержится информация об основной фотографии
контакта (которая является основной фотографией основного необработанного контакта этого контакта). Аналогичным образом класс
<code><a href="https://developer.android.com/reference/android/provider/ContactsContract.RawContacts.DisplayPhoto.html?hl=ru">ContactsContract.RawContacts.DisplayPhoto</a></code> определяет вложенную таблицу
<code><a href="https://developer.android.com/reference/android/provider/ContactsContract.RawContacts.html?hl=ru">ContactsContract.RawContacts</a></code>, в которой содержится информация об основной фотографии
необработанного контакта.
</p>
<p>
    В справочной документации по <code><a href="https://developer.android.com/reference/android/provider/ContactsContract.Contacts.Photo.html?hl=ru">ContactsContract.Contacts.Photo</a></code> и
<code><a href="https://developer.android.com/reference/android/provider/ContactsContract.RawContacts.DisplayPhoto.html?hl=ru">ContactsContract.RawContacts.DisplayPhoto</a></code> содержатся примеры
получения информации о фотографии. К сожалению, отсутствует класс для удобного извлечения миниатюры
основной фотографии необработанного контакта, однако вы можете отправить запрос в таблицу
<code><a href="https://developer.android.com/reference/android/provider/ContactsContract.Data.html?hl=ru">ContactsContract.Data</a></code>, выбрать
<code>android.provider.BaseColumns#_ID</code> необработанного контакта,
<code><a href="https://developer.android.com/reference/android/provider/ContactsContract.CommonDataKinds.Photo.html?hl=ru#CONTENT_ITEM_TYPE">Photo.CONTENT_ITEM_TYPE</a></code> и столбец <code><a href="https://developer.android.com/reference/android/provider/ContactsContract.DataColumns.html?hl=ru#IS_PRIMARY">IS_PRIMARY</a></code>,
чтобы найти строку основной фотографии необработанного контакта.
</p>
<p>
    Потоки данных из социальных сетей также могут включать фотографии. Они находятся в таблице
<code>android.provider.ContactsContract.StreamItemPhotos</code>, дополнительные сведения о которой представлены в разделе
<a href="#StreamPhotos">Фотографии из потока данных из социальных сетей</a>.
</p>



    </div>

    

  
    
  
    



<div class="wrap">
  <footer class="dac-footer ">
    <div class="cols dac-footer-main">
      <div class="col-1of2">
        <div class="dac-footer-contact">
          <a class="dac-footer-contact-link" href="https://developer.android.com/newsletter/index.html?hl=ru" title="Newsletter">Newsletter</a>
          <a class="dac-footer-contact-link" href="https://android-developers.blogspot.com/" title="Блог" target="_blank">Блог</a>
          <a class="dac-footer-contact-link" href="https://developer.android.com/support.html?hl=ru" title="Поддержка">Поддержка</a>
        </div>
      </div>
      <div class="col-1of2 dac-footer-reachout">
        <div class="dac-footer-social">
          <a class="dac-button-social dac-youtube dac-footer-social-link" href="https://www.youtube.com/user/androiddevelopers" title="Android Developers on YouTube" target="_blank"><i class="dac-sprite dac-youtube"></i><span class="hide-text">Android Developers on YouTube</span></a>
          <a class="dac-button-social dac-gplus dac-footer-social-link" href="https://plus.google.com/+AndroidDevelopers" title="Android Developers on Google+" target="_blank"><i class="dac-sprite dac-gplus"></i><span class="hide-text">Android Developers on Google+</span></a>
          <a class="dac-button-social dac-twitter dac-footer-social-link" href="https://twitter.com/AndroidDev" title="Android Developers on Twitter" target="_blank"><i class="dac-sprite dac-twitter"></i><span class="hide-text">Android Developers on Twitter</span></a>
        </div>
      </div>
    </div>

    <hr class="dac-footer-separator"/>
      
      <p class="dac-footer-copyright">
        
        Except as noted, this content is licensed under <a href="http://creativecommons.org/licenses/by/2.5/" target="_blank">Creative Commons Attribution 2.5</a>. For details and restrictions, see the <a href="https://developer.android.com/license.html">Content License</a>.
      </p>
    

    <p class="dac-footer-links">
      <a href="https://www.android.com/" title="Android.com" target="_blank">Android.com</a>
      <a href="https://developer.android.com/?hl=ru" title="Android Developers">Android Developers</a>
      <a href="https://developer.android.com/studio/index.html?hl=ru" title="Android Studio">Android Studio</a>
      <a href="https://developer.android.com/distribute/console/index.html?hl=ru" title="Google Play Console">Google Play Console</a>
      <a href="https://developer.android.com/legal.html?hl=ru" title="Legal Notice">Legal Notice</a>
    </p>

    <!-- TODO(akassay) Update all DAC js to use the class instead of the id b/30368561 -->
    <form class="devsite-utility-footer-language" id="setlang" action="https://developer.android.com/i18n/setlang/" method="post">
      <input type="hidden" name="xsrf_token" value="e-8bz1jY5EGxMTVua6DEj0po3O4S7Ee9nDs1TpjLOC06MTQ5NzUxNjM0NTI4Mzk3MA" />
      <input type="hidden" name="next" value="contacts-provider.html">
      <span id="language" class="locales">
        <select class="devsite-utility-footer-language-select" name="language">
          
          <option value="id"
            >
            Bahasa Indonesia
          </option>
          
          <option value="de"
            >
            Deutsch
          </option>
          
          <option value="en"
            >
            English
          </option>
          
          <option value="es"
            >
            español
          </option>
          
          <option value="es-419"
            >
            Español (América Latina)
          </option>
          
          <option value="fr"
            >
            français
          </option>
          
          <option value="pt-br"
            >
            Português Brasileiro
          </option>
          
          <option value="vi"
            >
            Tiếng Việt
          </option>
          
          <option value="tr"
            >
            Türkçe
          </option>
          
          <option value="ru"
             selected="selected" >
            Русский
          </option>
          
          <option value="th"
            >
            ภาษาไทย
          </option>
          
          <option value="ja"
            >
            日本語
          </option>
          
          <option value="zh-cn"
            >
            简体中文
          </option>
          
          <option value="zh-tw"
            >
            繁體中文
          </option>
          
          <option value="ko"
            >
            한국어
          </option>
          
        </select>
      </span>
    </form>
  </footer>
</div><!--/.wrap -->

<div class="dac-toast-group">
  <div class="dac-toast" data-toast>
    <div class="dac-toast-wrap">
      This site uses cookies to store your preferences for site-specific language and display options.
    </div>
  </div>
</div>

<div data-modal="newsletter" data-newsletter-fb data-swap class="dac-modal newsletter">
  <div class="dac-modal-container">
    <div class="dac-modal-window">
      <header class="dac-modal-header">
        <div class="dac-modal-header-actions">
          <button class="dac-modal-header-close" data-modal-toggle></button>
        </div>
        <div class="dac-swap" data-swap-container>
          <section class="dac-swap-section dac-active dac-down">
            <h2 class="norule dac-modal-header-title" data-t="newsletter.title">Get the latest Android developer news and tips that will help you find success on Google Play.</h2>
            <p class="dac-modal-header-subtitle" data-t="newsletter.requiredHint">* Required Fields</p>
          </section>
          <section class="dac-swap-section dac-up">
            
            <h2 class="norule dac-modal-header-title" data-t="newsletter.successTitle">Hooray!</h2>
          </section>
        </div>
      </header>
      <div class="dac-swap" data-swap-container>
        <section class="dac-swap-section dac-active dac-left">
          <form action="https://services.google.com/fb/submissions/android-developer-mailing-list/" class="dac-form" method="post">
            <section class="dac-modal-content">
              <fieldset class="dac-form-fieldset">
                <div class="cols">
                  <div class="col-1of2 newsletter-leftCol">
                    <div class="dac-form-input-group">
                      <label for="newsletter-full-name" class="dac-form-floatlabel" data-t="newsletter.name">Full name</label>
                      <input type="text" class="dac-form-input" name="fullname" id="newsletter-full-name" required>
                      <span class="dac-form-required">*</span>
                    </div>
                    <div class="dac-form-input-group">
                      <label for="newsletter-email" class="dac-form-floatlabel" data-t="newsletter.email">Адрес электронной почты</label>
                      <input type="email" class="dac-form-input" name="emailaddress" id="newsletter-email" required>
                      <span class="dac-form-required">*</span>
                    </div>
                  </div>
                  <div class="col-1of2 newsletter-rightCol">
                    <div class="dac-form-input-group">
                      <label for="newsletter-company" class="dac-form-floatlabel" data-t="newsletter.company">Company / developer name</label>
                      <input type="text" class="dac-form-input" name="companydevelopername" id="newsletter-company">
                    </div>
                    <div class="dac-form-input-group">
                      <label for="newsletter-play-store" class="dac-form-floatlabel" data-t="newsletter.appUrl">One of your Play Store app URLs</label>
                      <input type="url" class="dac-form-input" name="playstoreappurls" id="newsletter-play-store">
                    </div>
                  </div>
                </div>
              </fieldset>
              <fieldset class="dac-form-fieldset">
                <div class="cols">
                  <div class="col-1of2 newsletter-leftCol newsletter-interested" data-validation-message="Please check at least one item.">
                    <legend class="dac-form-legend">What are you interested in?<span class="dac-form-required">*</span></legend>
                    <div class="dac-form-radio-group">
                      <input type="checkbox" class="dac-form-checkbox" name="interested" id="interested-whats-new" value="whats-new">
                      <label for="interested-whats-new" class="dac-form-checkbox-button"></label>
                      <label for="interested-whats-new" class="dac-form-label">What's new</label>
                    </div>
                    <div class="dac-form-radio-group">
                      <input type="checkbox" class="dac-form-checkbox" name="interested" id="interested-games-updates" value="games-updates">
                      <label for="interested-games-updates" class="dac-form-checkbox-button"></label>
                      <label for="interested-games-updates" class="dac-form-label">Games updates</label>
                    </div>
                    <div class="dac-form-radio-group">
                      <input type="checkbox" class="dac-form-checkbox" name="interested" id="interested-android-development" value="android-development">
                      <label for="interested-android-development" class="dac-form-checkbox-button"></label>
                      <label for="interested-android-development" class="dac-form-label">Android development</label>
                    </div>
                  </div>
                  <div class="col-1of2 newsletter-rightCol newsletter-checkboxes">
                    <div class="dac-form-input-group">
                      <label for="newsletter-receive-in">Receive newsletter in</label>
                      <select name="language" class="dac-form-select" id="newsletter-receive-in">
                        <option value="en-US" selected>English</option>
                        <option value="ar">Arabic</option>
                        <option value="zh">Chinese (Simplified)</option>
                        <option value="zh-TW">Chinese (Traditional)</option>
                        <option value="fr">French</option>
                        <option value="de">German</option>
                        <option value="id">Indonesian (Bahasa)</option>
                        <option value="ja">Japanese</option>
                        <option value="ko">Korean</option>
                        <option value="pt-BR">Portuguese (Brazilian)</option>
                        <option value="ru">Russian</option>
                        <option value="es-419">Spanish (Latin American)</option>
                        <option value="th">Thai</option>
                        <option value="tr">Turkish</option>
                        <option value="vi">Vietnamese</option>
                      </select>
                    </div>
                    <div class="dac-form-radio-group">
                      <div class="dac-media">
                        <div class="dac-media-figure">
                          <input type="checkbox" class="dac-form-checkbox" name="marketingoptin" id="newsletter-add" required value="Add me to the mailing list.">
                          <label for="newsletter-add" class="dac-form-checkbox-button"></label>
                        </div>
                        <div class="dac-media-body">
                          <label for="newsletter-add" class="dac-form-label dac-form-aside">
                            Add me to the mailing list.
                            <span class="dac-form-required">*</span>
                          </label>
                        </div>
                      </div>
                    </div>
                    <div class="dac-form-radio-group">
                      <div class="dac-media">
                        <div class="dac-media-figure">
                          <input type="checkbox" class="dac-form-checkbox" name="privacystatement" id="newsletter-terms" required value="I acknowledge that the information provided in this form will be subject to Google's privacy policy (https://www.google.com/policies/privacy/).">
                          <label for="newsletter-terms" class="dac-form-checkbox-button"></label>
                        </div>
                        <div class="dac-media-body">
                          <label for="newsletter-terms" class="dac-form-label dac-form-aside"><span data-t="newsletter.privacyPolicy" data-t-html>
                            
                            I acknowledge that the information provided in this form will be subject to <a href="https://www.google.com/policies/privacy/">Google's privacy policy</a>.
                          </span>
                          <span class="dac-form-required">*</span></label>
                        </div>
                      </div>
                    </div>
                  </div>
                </div>
              </fieldset>
            </section>
            <input type="hidden" name="referrer" value="dac">
            <footer class="dac-modal-footer">
              <div class="cols">
                <div class="col-2of5">
                </div>
              </div>
              <button type="submit" value="Submit" class="dac-fab dac-primary dac-large dac-modal-action"><i class="dac-sprite dac-arrow-right"></i></button>
            </footer>
          </form>
        </section>
        <section class="dac-swap-section dac-right">
          <div class="dac-modal-content">
            <p class="newsletter-success-message" data-t="newsletter.successDetails">
              You have successfully signed up for the latest Android developer news and tips.
            </p>
          </div>
        </section>
      </div>
    </div>
  </div>
</div><!--/.dac-modal.newsletter-->


<div data-modal="langform" class="dac-modal" id="langform">
  <div class="dac-modal-container">
    <div class="dac-modal-window">
      <header class="dac-modal-header">
        <div class="dac-modal-header-actions">
          <button class="dac-modal-header-close" data-modal-toggle></button>
        </div>
        <section class="dac-swap-section dac-active dac-down">
          <h2 class="norule dac-modal-header-title">
            Browse this site in <span class="span-target-lang"></span>?
          </h2>
        </section>
      </header>
      <section class="dac-swap-section dac-active dac-left">
          <section class="dac-modal-content">
            <fieldset class="dac-form-fieldset">
              <div class="cols">
                <div class="col-2of2 langform-leftCol">
                  <p id="resetLangText">
                    You requested a page in <span class="span-target-lang"></span>, but your language preference for this site is <span class="span-current-lang"></span>.
                  </p>
                  <p id="resetLangCta">
                    Would you like to change your language preference and browse this site in <span class="span-target-lang"></span>? If you want to change your language preference later, use the language menu at the bottom of each page.
                  </p>
                </div>
              </div>
            </fieldset>
          </section>
          <footer class="dac-modal-footer" id="langfooter">
            <div class="cols">
              <div class="col-2of5">
              </div>
            </div>
            <a href="#" class="yes" onclick="return false;">
              <button class="button dac-primary dac-modal-action lang yes" data-t="newsletter.resetLangButtonYes" data-modal-toggle>
                Change Language
              </button>
            </a>
            <a href="#" class="" onclick="return false;">
              <button class="button dac-primary dac-modal-action lang no" data-t="newsletter.resetLangButtonNo" data-modal-toggle>
                Not Now
              </button>
            </a>
          </footer>
        </form>
      </section>
    </div>
  </div>
</div><!--/.dac-modal-->


<div data-modal="api-unavailable" class="dac-modal" id="api-unavailable">
  <div class="dac-modal-container">
    <div class="dac-modal-window">
      <header class="dac-modal-header">
        <div class="dac-modal-header-actions">
          <button class="dac-modal-header-close" data-modal-toggle></button>
        </div>
        <section class="dac-swap-section dac-active dac-down">
          <h2 class="norule dac-modal-header-title">
            This class requires API level <span class="api-level"></span> or higher
          </h2>
        </section>
      </header>
      <section class="dac-swap-section dac-active dac-left">
          <section class="dac-modal-content">
            <p>
              This doc is hidden because your selected API level for the documentation is <span class="api-level"></span>. You can change the documentation API level with the selector above the left navigation.
            </p>
            
            <p>For more information about specifying the API level your app requires, read <a href="https://developer.android.com/training/basics/supporting-devices/platforms.html">Supporting Different Platform Versions</a>.</p>
          </section>
          <footer class="dac-modal-footer" id="langfooter">
            <div class="cols">
              <div class="col-2of5">
              </div>
            </div>
            <a href="#" class="ok" onclick="return false;">
              <button class="button dac-primary dac-modal-action ok"
              data-modal-toggle>
                OK, make this page visible
              </button>
            </a>
          </footer>
        </form>
      </section>
    </div>
  </div>
</div><!--/.dac-modal#api-unavailable-->

    
  </div><!--/#body-content-->

  <!-- Nav Setup -->
  <script>$('[data-dac-nav]').dacNav();</script>
  <script type="text/javascript">
    $('.slideshow-container').dacSlideshow({
        btnPrev: '.slideshow-prev',
        btnNext: '.slideshow-next',
        btnPause: '#pauseButton'
    });

    $(".feed").dacTabbedList({
      nav_id: '.feed-nav',
      frame_id: '.feed-frame'
    });
  </script>
  
  <script src="../../../ytblogger_lists_unified05ec.js?hl=ru?v=2017061508" defer></script>
  <script src="../../../android_metadata_en05ec.js?hl=ru?v=2017061508" defer></script>
  
  <script src="../../../reference/lists05ec.js?hl=ru?v=2017061508" defer></script>
  <script src="../../../reference/gms_lists05ec.js?hl=ru?v=2017061508" defer></script>
  <script src="../../../reference/android/support/wearable/lists05ec.js?hl=ru?v=2017061508" defer></script>
  <script src="../../../reference/android/support/test/lists05ec.js?hl=ru?v=2017061508" defer></script>
  <script src="../../../reference/android/support/constraint/lists05ec.js?hl=ru?v=2017061508" defer></script>
  <script src="https://developer.android.com/_static2/f304fc21fa/jsi18n/?hl=ru"></script>
  <script>
    // Load localized metadata.
    (function(lang) {
      if (lang === 'en') { return; }
      document.write('<script src="https://developer.android.com/android_metadata_ru.js?hl=ru?v=2017061508" defer></' + 'script>');
    })(getLangPref())

    // Add skip to content for accessibility.
    $('#skip-to-main').click(function() {
      $('a[name=top]').focus();
    });

    $('.devsite-utility-footer-language-select').each(function() {
      $(this).change(function() {
        changeLangPref(this.value, true)
        $('.devsite-utility-footer-language').submit();
      });
    });
  </script>

  <script>
    (function($) {
      devsite.analytics.InitAnalytics();
    })(jQuery);
  </script>

  


<div id="survey-box-wrapper">
  <div class="material-dialog" style="width:270px">
    <div class="material-dialog-title">
      Take a one-minute survey?
    </div>
    <div class="material-dialog-description">
      Help us improve Android tools and documentation.
    </div>
    <div class="material-button-bar">
      <a class="dac-button dac-primary dac-raised" target="_blank"
          href="https://goo.gl/forms/kV7MoyD2dvcWkd5N2">Sure</a>
      <a class="dac-button" href="#">No thanks</a>
    </div>
  </div>
</div>

</body>

<!-- Mirrored from developer.android.com/guide/topics/providers/contacts-provider.html?hl=ru by HTTrack Website Copier/3.x [XR&CO'2014], Thu, 15 Jun 2017 09:06:46 GMT -->
</html>
