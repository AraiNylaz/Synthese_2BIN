





<!DOCTYPE html>
<html lang="zh-cn">

<!-- Mirrored from developer.android.com/guide/topics/ui/settings.html?hl=zh-cn by HTTrack Website Copier/3.x [XR&CO'2014], Thu, 15 Jun 2017 09:14:58 GMT -->
<!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=utf-8" /><!-- /Added by HTTrack -->
<head>

  



<meta name="viewport" content="width=device-width,initial-scale=1.0,minimum-scale=1.0,maximum-scale=1.0,user-scalable=no">
<meta content="IE=edge" http-equiv="X-UA-Compatible">





<script>var a=window.devsite||{};window.devsite=a;a.readyCallbacks=[];window.devsite.readyCallbacks=a.readyCallbacks;a.ready=function(b){a.readyCallbacks.push(b)};window.devsite.ready=a.ready;
</script>

<meta charset="utf-8">



<meta name="xsrf_token" content="Oi48BqMwBJSlX47UxS85gPKgz1lKxXcWiG6R06v-JbQ6MTQ5NzUxNzAzNDIwNzMwMA" />

  
    <link rel="canonical" href="settings0b8e.html?hl=zh-cn">
  

  
    <link rel="alternate" href="settings9201.html?hl=ru" hreflang="ru">
  
    <link rel="alternate" href="settingsf854.html?hl=zh-tw" hreflang="zh-Hant">
  
    <link rel="alternate" href="settings327f.html?hl=vi" hreflang="vi">
  
    <link rel="alternate" href="settings0b8e.html?hl=zh-cn" hreflang="zh-Hans">
  
    <link rel="alternate" href="settings7554.html?hl=es-419" hreflang="es-419">
  
    <link rel="alternate" href="settings232e.html?hl=ko" hreflang="ko">
  
    <link rel="alternate" href="settings0cf2.html?hl=id" hreflang="id">
  
    <link rel="alternate" href="settings9e29.html?hl=ja" hreflang="ja">
  
    <link rel="alternate" href="settings6dd3.html?hl=pt-br" hreflang="pt-br">
  
    <link rel="alternate" href="settings.html" hreflang="en">
  
    <link rel="alternate" href="https://developer.android.google.cn/guide/topics/ui/settings.html?hl=ru" hreflang="ru-cn">
  
    <link rel="alternate" href="https://developer.android.google.cn/guide/topics/ui/settings.html?hl=zh-tw" hreflang="zh-Hant-cn">
  
    <link rel="alternate" href="https://developer.android.google.cn/guide/topics/ui/settings.html?hl=vi" hreflang="vi-cn">
  
    <link rel="alternate" href="https://developer.android.google.cn/guide/topics/ui/settings.html?hl=zh-cn" hreflang="zh-Hans-cn">
  
    <link rel="alternate" href="https://developer.android.google.cn/guide/topics/ui/settings.html?hl=es-419" hreflang="es-419-cn">
  
    <link rel="alternate" href="https://developer.android.google.cn/guide/topics/ui/settings.html?hl=ko" hreflang="ko-cn">
  
    <link rel="alternate" href="https://developer.android.google.cn/guide/topics/ui/settings.html?hl=id" hreflang="id-cn">
  
    <link rel="alternate" href="https://developer.android.google.cn/guide/topics/ui/settings.html?hl=ja" hreflang="ja-cn">
  
    <link rel="alternate" href="https://developer.android.google.cn/guide/topics/ui/settings.html?hl=pt-br" hreflang="pt-br-cn">
  
    <link rel="alternate" href="https://developer.android.google.cn/guide/topics/ui/settings.html" hreflang="en-cn">
  

  <link rel="alternate" href="settings.html" hreflang="x-default">




<link rel="shortcut icon" href="../../../_static/f304fc21fa/images/android/favicon0b8e.png?hl=zh-cn">

<link rel="apple-touch-icon" href="../../../_static/f304fc21fa/images/android/touchicon-1800b8e.png?hl=zh-cn">


<title>

  设置 | Android Developers

</title>

  <meta name="description" content="Applications often include settings that allow users to modify app features and behaviors. For example, some apps allow users to specify whether notifications are enabled or specify how often the application syncs data with the cloud. If you want to provide…">


<!-- STYLESHEETS -->
<link rel="stylesheet" href="http://fonts.googleapis.com/css?family=Roboto+Condensed">
<link rel="stylesheet"
    href="http://fonts.googleapis.com/css?family=Roboto:light,regular,medium,thin,italic,mediumitalic,bold"
    title="roboto">







<link href="../../../static/css/default414d.css?hl=zh-cn?v=2017061508" rel="stylesheet" type="text/css">
<!-- JAVASCRIPT -->
<script src="../../../_static/f304fc21fa/js/android_3p-bundle0b8e.js?hl=zh-cn" type="text/javascript"></script>
<script src="../../../_static/f304fc21fa/js/script_foot_closure_android__zh_cn0b8e.js?hl=zh-cn"></script>
<script src="../../../_static/f304fc21fa/js/script_foot_android0b8e.js?hl=zh-cn"></script>

<script type="text/javascript">
  var toRoot = 'https://developer.android.com/';
  devsite.permissions.init({"039e5d84b87fd75807ffb37b7f1bbf2c": true, "098dafe57affddc137df300142652cfd": false, "cb025a64a50094835616312f4774a53d": true, "51470233c56fc1fde50f00b73c52b216": false, "752953480de00a336d911a46966cc16d": false, "700def1a83e356c06c0925afb05de4b0": false, "6749dcb526ce9bde6993550c7d928d24": true});

  var replaceBlog = false;
  var replaceYouTube = false;
  var siteDefaultLocale = 'en';

  var ANDROID_LANGUAGES = [
      'id','de','en','es','es-419','fr','pt-br','vi','tr','ru','th','ja','zh-cn','zh-tw','ko'
  ];
</script>
<script src="../../../static/js/docs414d.js?hl=zh-cn?v=2017061508" type="text/javascript"></script>


</head>

<body class="gc-documentation
            
            
              develop
              guide
            
            "
      itemscope itemtype="http://schema.org/Article">
  


  
    <input class="google-analytics-id-json" type="hidden" value="{&quot;dimensions&quot;: {&quot;dimension6&quot;: &quot;zh-cn&quot;, &quot;dimension4&quot;: &quot;API Guides&quot;, &quot;dimension5&quot;: &quot;zh-cn&quot;, &quot;dimension3&quot;: false, &quot;dimension1&quot;: &quot;Signed out&quot;, &quot;dimension8&quot;: null}, &quot;gaid&quot;: &quot;UA-49880327-2&quot;}">
  
    <input class="google-analytics-id-json" type="hidden" value="{&quot;dimensions&quot;: {&quot;dimension6&quot;: &quot;zh-cn&quot;, &quot;dimension4&quot;: &quot;API Guides&quot;, &quot;dimension5&quot;: &quot;zh-cn&quot;, &quot;dimension3&quot;: false, &quot;dimension1&quot;: &quot;Signed out&quot;, &quot;dimension8&quot;: null}, &quot;gaid&quot;: &quot;UA-5831155-1&quot;}">
  



  
  
    <script>
      var dataLayer = [{"freeTrialEligibleUser": "False", "userCountry": "BE", "language": {"requested": "zh-cn", "served": "zh-cn"}, "projectName": "API Guides", "scriptsafe": null, "signedIn": "False", "internalUser": "False"}];
    </script>
  



  
  <a href="#top" id="skip-to-main">Skip to content</a>
  <header id="header-wrapper">
    <div class="dac-header" id="header">
      <div class="dac-header-inner">
        <a class="dac-nav-toggle" data-dac-toggle-nav href="#" title="Open navigation">
          <span class="dac-nav-hamburger">
            <span class="dac-nav-hamburger-top"></span>
            <span class="dac-nav-hamburger-mid"></span>
            <span class="dac-nav-hamburger-bot"></span>
          </span>
        </a>
        
        <a class="dac-header-logo" href="https://developer.android.com/index.html?hl=zh-cn">
          <img class="dac-header-logo-image" src="../../../static/images/android_logo0b8e.png?hl=zh-cn"
              srcset="https://developer.android.com/static/images/android_logo_2x.png 2x?hl=zh-cn"
              width="32" height="36" alt="Android"> Developers</a>
        <ul class="dac-header-tabs">
          <li>
            <a class="dac-header-tab" href="https://developer.android.com/design/index.html?hl=zh-cn"
               zh-tw-lang="設計"
               zh-cn-lang="设计"
               ru-lang="Проектирование"
               ko-lang="디자인"
               ja-lang="設計"
               es-lang="Diseñar">Design</a>
          </li>
          <li>
            <a class="dac-header-tab" href="https://developer.android.com/develop/index.html?hl=zh-cn"
               zh-tw-lang="開發"
               zh-cn-lang="开发"
               ru-lang="Разработка"
               ko-lang="개발"
               ja-lang="開発"
               es-lang="Desarrollar">Develop</a>
          </li>
          <li>
            <a class="dac-header-tab" href="https://developer.android.com/distribute/index.html?hl=zh-cn"
               zh-tw-lang="發佈"
               zh-cn-lang="分发"
               ru-lang="Распространение"
               ko-lang="배포"
               ja-lang="配布"
               es-lang="Distribuir">Distribute</a>
          </li>
        </ul>


        

        <a class="dac-header-console-btn gc-analytics-event" href="https://play.google.com/apps/publish/"
           data-category="User" data-action="Console" data-label="Clicked">
          <img src="https://developer.android.com/static/images/developer-console-icon.svg?hl=zh-cn" width="18" height="19" alt="Play 控制台">Play Console</a>

        

<form data-search="" class="dac-header-search">
  <button class="dac-header-search-close" data-search-close="">
    <i class="dac-sprite dac-back-arrow"></i>
  </button>

  <div class="dac-header-search-inner">
    <i class="dac-sprite dac-search-white dac-header-search-icon"></i>
    
    <input id="search_autocomplete" type="text" value="" autocomplete="off" name="q" class="dac-header-search-input" placeholder="搜索">
    <button class="dac-header-search-clear dac-hidden" data-search-clear="">
      <i class="dac-sprite dac-close-black"></i>
    </button>
  </div>
</form>

        
      </div><!--/.header-wrap.wrap-->
    </div><!--/.header-->

    

<div id="search-results" class="dac-search-results">
  <div id="dac-search-results-history" class="dac-search-results-history">
    <div class="wrap dac-search-results-history-wrap">
      <div class="cols">
        <div class="col-1of2 col-tablet-1of2 col-mobile-1of1">
          <h2>Most visited</h2>
          <div class="resource-flow-layout" data-history-query="history:most/visited" data-maxresults="3" data-cardsizes="18x2"></div>
        </div>

        <div class="col-1of2 col-tablet-1of2 col-mobile-1of1">
          <h2>Recently visited</h2>
          <div class="resource-flow-layout cols" data-history-query="history:recent" data-allow-duplicates="true" data-maxresults="3" data-cardsizes="18x2"></div>
        </div>
      </div>
    </div>
  </div>

  <div id="dac-search-results-content" class="dac-search-results-content">
    <div class="dac-search-results-metadata wrap">
      <div class="dac-search-results-for">
        
          <h2>
          Results for <span id="search-results-for"></span>
          </h2>
      </div>

      <div id="dac-search-results-hero"></div>

      <div class="dac-search-results-hero cols">
        <div id="dac-search-results-reference" class="col-6of6 col-tablet-2of2 col-mobile-1of1">
          <div class="suggest-card reference no-display">
            <ul class="dac-search-results-reference">
            </ul>
          </div>
        </div>
      </div>

      <div class="cols dac-search-results-cse">
        <script src="../../../../cse.google.com/f4116.txt?cx=000521750095050289010:zpcpi1ea4s8" async></script>
        <gcse:searchresults-only linkTarget="_self"></gcse:searchresults-only>
      </div>
    </div>
  </div>
</div>

  </header>

  <a name="navigation" tabindex=0 class="nav-start-marker">navigation</a>
  <nav class="dac-nav">
    <div class="dac-nav-dimmer" data-dac-toggle-nav></div>
    <div class="dac-nav-sidebar" data-swap data-dynamic="false" data-transition-speed="300" data-dac-nav>
      <div data-swap-container>
        
        <a class="dac-nav-back-button dac-swap-section dac-up dac-no-anim" tabindex=0 data-swap-button>
          
          <i class="dac-sprite dac-nav-back"></i> <span class="dac-nav-back-title">返回</span>
        </a>

        <div class="dac-nav-sub dac-swap-section dac-right dac-active" itemscope
            itemtype="http://schema.org/SiteNavigationElement">
          
          
            
            <ul id="nav">
              <li class="nav-section"><div class="nav-section-header"><a href="../../index0b8e.html?hl=zh-cn" >简介</a><span class="toggle-icon" tabindex="0"></span></div><ul><li><a href="../../components/fundamentals0b8e.html?hl=zh-cn" >应用基础知识</a></li><li><a href="../../practices/compatibility0b8e.html?hl=zh-cn" >设备兼容性</a></li><li><a href="../security/permissions0b8e.html?hl=zh-cn" >系统权限</a></li></ul></li><li class="nav-section"><div class="nav-section-header"><a href="../../platform/index0b8e.html?hl=zh-cn" >平台架构</a><span class="toggle-icon" tabindex="0"></span></div><ul><li><a href="../../platform/j8-jack0b8e.html?hl=zh-cn"  es-lang="Funciones del lenguaje Java 8" in-lang="Fitur Bahasa Java 8" ja-lang="Java 8 の機能" ko-lang="Java 8 언어 기능" pt-br-lang="Recursos de linguagem do Java 8" ru-lang="Возможности языка Java 8" vi-lang="Tính năng của Ngôn ngữ Java 8" zh-cn-lang="Java 8 の機能" zh-tw-lang="Java 8 の機能">使用 Java 8 语言功能</a></li><li><a href="../../practices/verifying-apps-art0b8e.html?hl=zh-cn" >在 Android Runtime (ART) 上验证应用行为</a></li></ul></li><li class="nav-section"><div class="nav-section-header"><a href="../../components/index0b8e.html?hl=zh-cn" >应用组件</a><span class="toggle-icon" tabindex="0"></span></div><ul><li class="nav-section"><div class="nav-section-header"><a href="../../components/intents-filters0b8e.html?hl=zh-cn" >Intent 和 Intent 过滤器</a><span class="toggle-icon" tabindex="0"></span></div><ul><li><a href="../../components/intents-common0b8e.html?hl=zh-cn" >通用 Intent</a></li></ul></li><li class="nav-section"><div class="nav-section-header"><a href="../../components/activities0b8e.html?hl=zh-cn" >Activity</a><span class="toggle-icon" tabindex="0"></span></div><ul><li><a href="../../components/fragments0b8e.html?hl=zh-cn" >片段</a></li><li><a href="../../components/loaders0b8e.html?hl=zh-cn" >加载器</a></li><li><a href="../../components/tasks-and-back-stack0b8e.html?hl=zh-cn" >任务和返回栈</a></li><li><a href="../../components/recents0b8e.html?hl=zh-cn" >概览屏幕</a></li></ul></li><li class="nav-section"><div class="nav-section-header"><a href="../../components/services0b8e.html?hl=zh-cn" >服务</a><span class="toggle-icon" tabindex="0"></span></div><ul><li><a href="../../components/bound-services0b8e.html?hl=zh-cn" >绑定服务</a></li><li><a href="../../components/aidl0b8e.html?hl=zh-cn" >AIDL</a></li></ul></li><li class="nav-section"><div class="nav-section-header"><a href="../providers/content-providers0b8e.html?hl=zh-cn" >内容提供程序</a><span class="toggle-icon" tabindex="0"></span></div><ul><li><a href="../providers/content-provider-basics0b8e.html?hl=zh-cn" >内容提供程序基础知识</a></li><li><a href="../providers/content-provider-creating0b8e.html?hl=zh-cn" >创建内容提供程序</a></li><li><a href="../providers/calendar-provider0b8e.html?hl=zh-cn" >日历提供程序</a></li><li><a href="../providers/contacts-provider0b8e.html?hl=zh-cn" >联系人提供程序</a></li><li><a href="../providers/document-provider0b8e.html?hl=zh-cn" >存储访问框架</a></li></ul></li><li class="nav-section"><div class="nav-section-header"><a href="../appwidgets/index0b8e.html?hl=zh-cn" >应用小部件</a><span class="toggle-icon" tabindex="0"></span></div><ul><li><a href="../appwidgets/host0b8e.html?hl=zh-cn" >应用小部件主机</a></li></ul></li><li><a href="../../components/processes-and-threads0b8e.html?hl=zh-cn" >进程和线程</a></li></ul></li><li class="nav-section"><div class="nav-section-header"><a href="../resources/index0b8e.html?hl=zh-cn" >应用资源</a><span class="toggle-icon" tabindex="0"></span></div><ul><li><a href="../resources/overview0b8e.html?hl=zh-cn" >概览</a></li><li><a href="../resources/providing-resources0b8e.html?hl=zh-cn" >提供资源</a></li><li><a href="../resources/accessing-resources0b8e.html?hl=zh-cn" >访问资源</a></li><li><a href="../resources/runtime-changes0b8e.html?hl=zh-cn" >处理运行时变更</a></li><li class="nav-section"><div class="nav-section-header"><a href="../resources/localization0b8e.html?hl=zh-cn" >本地化</a><span class="toggle-icon" tabindex="0"></span></div><ul><li><a href="../resources/icu4j-framework0b8e.html?hl=zh-cn" >ICU4J Android 框架 API</a></li><li><a href="../resources/multilingual-support0b8e.html?hl=zh-cn" >语言和语言区域</a></li></ul></li><li class="nav-section"><div class="nav-section-header"><a href="../resources/available-resources0b8e.html?hl=zh-cn" >资源类型</a><span class="toggle-icon" tabindex="0"></span></div><ul><li><a href="../resources/animation-resource0b8e.html?hl=zh-cn" >动画</a></li><li><a href="../resources/color-list-resource0b8e.html?hl=zh-cn" >颜色状态列表</a></li><li><a href="../resources/drawable-resource0b8e.html?hl=zh-cn" >可绘制对象</a></li><li><a href="../resources/layout-resource0b8e.html?hl=zh-cn" >布局</a></li><li><a href="../resources/menu-resource0b8e.html?hl=zh-cn" >菜单</a></li><li><a href="../resources/string-resource0b8e.html?hl=zh-cn" >字符串</a></li><li><a href="../resources/style-resource0b8e.html?hl=zh-cn" >样式</a></li><li><a href="../resources/more-resources0b8e.html?hl=zh-cn" >其他类型</a></li></ul></li></ul></li><li class="nav-section"><div class="nav-section-header"><a href="../manifest/manifest-intro0b8e.html?hl=zh-cn" >应用清单</a><span class="toggle-icon" tabindex="0"></span></div><ul><li><a href="../manifest/action-element0b8e.html?hl=zh-cn" >&lt;action&gt;</a></li><li><a href="../manifest/activity-element0b8e.html?hl=zh-cn" >&lt;activity&gt;</a></li><li><a href="../manifest/activity-alias-element0b8e.html?hl=zh-cn" >&lt;activity-alias&gt;</a></li><li><a href="../manifest/application-element0b8e.html?hl=zh-cn" >&lt;application&gt;</a></li><li><a href="../manifest/category-element0b8e.html?hl=zh-cn" >&lt;category&gt;</a></li><li><a href="../manifest/compatible-screens-element0b8e.html?hl=zh-cn" >&lt;compatible-screens&gt;</a></li><li><a href="../manifest/data-element0b8e.html?hl=zh-cn" >&lt;data&gt;</a></li><li><a href="../manifest/grant-uri-permission-element0b8e.html?hl=zh-cn" >&lt;grant-uri-permission&gt;</a></li><li><a href="../manifest/instrumentation-element0b8e.html?hl=zh-cn" >&lt;instrumentation&gt;</a></li><li><a href="../manifest/intent-filter-element0b8e.html?hl=zh-cn" >&lt;intent-filter&gt;</a></li><li><a href="../manifest/manifest-element0b8e.html?hl=zh-cn" >&lt;manifest&gt;</a></li><li><a href="../manifest/meta-data-element0b8e.html?hl=zh-cn" >&lt;meta-data&gt;</a></li><li><a href="../manifest/path-permission-element0b8e.html?hl=zh-cn" >&lt;path-permission&gt;</a></li><li><a href="../manifest/permission-element0b8e.html?hl=zh-cn" >&lt;permission&gt;</a></li><li><a href="../manifest/permission-group-element0b8e.html?hl=zh-cn" >&lt;permission-group&gt;</a></li><li><a href="../manifest/permission-tree-element0b8e.html?hl=zh-cn" >&lt;permission-tree&gt;</a></li><li><a href="../manifest/provider-element0b8e.html?hl=zh-cn" >&lt;provider&gt;</a></li><li><a href="../manifest/receiver-element0b8e.html?hl=zh-cn" >&lt;receiver&gt;</a></li><li><a href="../manifest/service-element0b8e.html?hl=zh-cn" >&lt;service&gt;</a></li><li><a href="../manifest/supports-gl-texture-element0b8e.html?hl=zh-cn" >&lt;supports-gl-texture&gt;</a></li><li><a href="../manifest/supports-screens-element0b8e.html?hl=zh-cn" >&lt;supports-screens&gt;</a></li><li><a href="../manifest/uses-configuration-element0b8e.html?hl=zh-cn" >&lt;uses-configuration&gt;</a></li><li><a href="../manifest/uses-feature-element0b8e.html?hl=zh-cn" >&lt;uses-feature&gt;</a></li><li><a href="../manifest/uses-library-element0b8e.html?hl=zh-cn" >&lt;uses-library&gt;</a></li><li><a href="../manifest/uses-permission-element0b8e.html?hl=zh-cn" >&lt;uses-permission&gt;</a></li><li><a href="../manifest/uses-permission-sdk-23-element0b8e.html?hl=zh-cn" >&lt;uses-permission-sdk-23&gt;</a></li><li><a href="../manifest/uses-sdk-element0b8e.html?hl=zh-cn" >&lt;uses-sdk&gt;</a></li></ul></li><li class="nav-section"><div class="nav-section-header"><a href="index0b8e.html?hl=zh-cn" >用户界面</a><span class="toggle-icon" tabindex="0"></span></div><ul><li><a href="overview0b8e.html?hl=zh-cn" >概览</a></li><li class="nav-section"><div class="nav-section-header"><a href="declaring-layout0b8e.html?hl=zh-cn" >布局</a><span class="toggle-icon" tabindex="0"></span></div><ul><li><a href="layout/linear0b8e.html?hl=zh-cn" >线性布局</a></li><li><a href="layout/relative0b8e.html?hl=zh-cn" >相对布局</a></li><li><a href="layout/listview0b8e.html?hl=zh-cn" >列表视图</a></li><li><a href="layout/gridview0b8e.html?hl=zh-cn" >网格视图</a></li></ul></li><li class="nav-section"><div class="nav-section-header"><a href="controls0b8e.html?hl=zh-cn" >输入控件</a><span class="toggle-icon" tabindex="0"></span></div><ul><li><a href="controls/button0b8e.html?hl=zh-cn" >按钮</a></li><li><a href="https://developer.android.com/training/keyboard-input/style.html?hl=zh-cn" >文本字段</a></li><li><a href="controls/checkbox0b8e.html?hl=zh-cn" >复选框</a></li><li><a href="controls/radiobutton0b8e.html?hl=zh-cn" >单选按钮</a></li><li><a href="controls/togglebutton0b8e.html?hl=zh-cn" >切换按钮</a></li><li><a href="controls/spinner0b8e.html?hl=zh-cn" >微调框</a></li><li><a href="controls/pickers0b8e.html?hl=zh-cn" >选取器</a></li></ul></li><li><a href="ui-events0b8e.html?hl=zh-cn" >输入事件</a></li><li><a href="menus0b8e.html?hl=zh-cn" >菜单</a></li><li><a href="settings0b8e.html?hl=zh-cn" >设置</a></li><li><a href="dialogs0b8e.html?hl=zh-cn" >对话框</a></li><li><a href="notifiers/notifications0b8e.html?hl=zh-cn" >通知</a></li><li><a href="notifiers/toasts0b8e.html?hl=zh-cn" >Toast</a></li><li class="nav-section"><div class="nav-section-header"><a href="../search/index0b8e.html?hl=zh-cn" >搜索</a><span class="toggle-icon" tabindex="0"></span></div><ul><li><a href="../search/search-dialog0b8e.html?hl=zh-cn" >创建搜索界面</a></li><li><a href="../search/adding-recent-query-suggestions0b8e.html?hl=zh-cn" >添加近期查询建议</a></li><li><a href="../search/adding-custom-suggestions0b8e.html?hl=zh-cn" >添加自定义建议</a></li><li><a href="../search/searchable-config0b8e.html?hl=zh-cn" >可搜索配置</a></li></ul></li><li><a href="multi-window0b8e.html?hl=zh-cn" >多窗口支持</a></li><li><a href="drag-drop0b8e.html?hl=zh-cn" >拖放</a></li><li class="nav-section"><div class="nav-section-header"><a href="accessibility/index0b8e.html?hl=zh-cn" >无障碍功能</a><span class="toggle-icon" tabindex="0"></span></div><ul><li><a href="accessibility/apps0b8e.html?hl=zh-cn" >为应用设置无障碍功能</a></li><li><a href="accessibility/checklist0b8e.html?hl=zh-cn" >无障碍功能开发者检查单</a></li><li><a href="accessibility/services0b8e.html?hl=zh-cn" >构建无障碍服务</a></li></ul></li><li><a href="themes0b8e.html?hl=zh-cn" >样式和主题</a></li><li><a href="custom-components0b8e.html?hl=zh-cn" >自定义组件</a></li></ul></li><li class="nav-section"><div class="nav-section-header"><a href="../graphics/index0b8e.html?hl=zh-cn" >动画和图形</a><span class="toggle-icon" tabindex="0"></span></div><ul><li><a href="../graphics/overview0b8e.html?hl=zh-cn" >概览</a></li><li><a href="../graphics/prop-animation0b8e.html?hl=zh-cn" >属性动画</a></li><li><a href="../graphics/view-animation0b8e.html?hl=zh-cn" >视图动画</a></li><li><a href="../graphics/drawable-animation0b8e.html?hl=zh-cn" >可绘制动画</a></li><li><a href="../graphics/2d-graphics0b8e.html?hl=zh-cn" >画布和可绘制对象</a></li><li><a href="../graphics/opengl0b8e.html?hl=zh-cn" >OpenGL ES</a></li><li><a href="../graphics/hardware-accel0b8e.html?hl=zh-cn" >硬件加速</a></li></ul></li><li class="nav-section"><div class="nav-section-header"><a href="../renderscript/index0b8e.html?hl=zh-cn" >计算</a><span class="toggle-icon" tabindex="0"></span></div><ul><li><a href="../renderscript/compute0b8e.html?hl=zh-cn" >RenderScript</a></li><li><a href="../renderscript/advanced0b8e.html?hl=zh-cn" >高级 RenderScript</a></li><li class="nav-section"><div class="nav-section-header"><a href="../renderscript/reference/overview0b8e.html?hl=zh-cn" >Runtime API 参考</a><span class="toggle-icon" tabindex="0"></span></div><ul><li><a href="../renderscript/reference/rs_value_types0b8e.html?hl=zh-cn" >数字类型</a></li><li><a href="../renderscript/reference/rs_object_types0b8e.html?hl=zh-cn" >对象类型</a></li><li><a href="../renderscript/reference/rs_convert0b8e.html?hl=zh-cn" >转换函数</a></li><li><a href="../renderscript/reference/rs_math0b8e.html?hl=zh-cn" >数学常量和函数</a></li><li><a href="../renderscript/reference/rs_vector_math0b8e.html?hl=zh-cn" >矢量数学函数</a></li><li><a href="../renderscript/reference/rs_matrix0b8e.html?hl=zh-cn" >矩阵函数</a></li><li><a href="../renderscript/reference/rs_quaternion0b8e.html?hl=zh-cn" >四元数函数</a></li><li><a href="../renderscript/reference/rs_atomic0b8e.html?hl=zh-cn" >原子更新函数</a></li><li><a href="../renderscript/reference/rs_time0b8e.html?hl=zh-cn" >时间函数和类型</a></li><li><a href="../renderscript/reference/rs_allocation_data0b8e.html?hl=zh-cn" >分配数据访问函数</a></li><li><a href="../renderscript/reference/rs_object_info0b8e.html?hl=zh-cn" >对象特性函数</a></li><li><a href="../renderscript/reference/rs_for_each0b8e.html?hl=zh-cn" >内核调用函数和类型</a></li><li><a href="../renderscript/reference/rs_io0b8e.html?hl=zh-cn" >输入/输出函数</a></li><li><a href="../renderscript/reference/rs_debug0b8e.html?hl=zh-cn" >调试函数</a></li><li><a href="../renderscript/reference/rs_graphics0b8e.html?hl=zh-cn" >图形函数和类型</a></li><li><a href="../renderscript/reference/index0b8e.html?hl=zh-cn" >索引</a></li></ul></li></ul></li><li class="nav-section"><div class="nav-section-header"><a href="../media/index0b8e.html?hl=zh-cn" >媒体和相机</a><span class="toggle-icon" tabindex="0"></span></div><ul><li><a href="../media/mediaplayer0b8e.html?hl=zh-cn" >媒体回放</a></li><li><a href="../media/mediarouter0b8e.html?hl=zh-cn" >媒体路由器</a></li><li><a href="../media/mediarouteprovider0b8e.html?hl=zh-cn" >媒体路由提供程序</a></li><li><a href="../media/exoplayer0b8e.html?hl=zh-cn" >ExoPlayer</a></li><li><a href="../media/media-formats0b8e.html?hl=zh-cn" >支持的媒体格式</a></li><li><a href="../media/mediarecorder0b8e.html?hl=zh-cn" >音频采集</a></li><li><a href="../media/jetplayer0b8e.html?hl=zh-cn" >JetPlayer</a></li><li><a href="../media/camera0b8e.html?hl=zh-cn" >相机</a></li></ul></li><li class="nav-section"><div class="nav-section-header"><a href="../sensors/index0b8e.html?hl=zh-cn" >位置和传感器</a><span class="toggle-icon" tabindex="0"></span></div><ul><li><a href="../location/index0b8e.html?hl=zh-cn" >位置和地图</a></li><li><a href="../location/strategies0b8e.html?hl=zh-cn" >位置策略</a></li><li><a href="../sensors/sensors_overview0b8e.html?hl=zh-cn" >传感器概览</a></li><li><a href="../sensors/sensors_motion0b8e.html?hl=zh-cn" >运动传感器</a></li><li><a href="../sensors/sensors_position0b8e.html?hl=zh-cn" >位置传感器</a></li><li><a href="../sensors/sensors_environment0b8e.html?hl=zh-cn" >环境传感器</a></li></ul></li><li class="nav-section"><div class="nav-section-header"><a href="../connectivity/index0b8e.html?hl=zh-cn" >连接</a><span class="toggle-icon" tabindex="0"></span></div><ul><li class="nav-section"><div class="nav-section-header"><a href="../connectivity/bluetooth0b8e.html?hl=zh-cn" >蓝牙</a><span class="toggle-icon" tabindex="0"></span></div><ul><li><a href="../connectivity/bluetooth-le0b8e.html?hl=zh-cn" >蓝牙低功耗</a></li></ul></li><li class="nav-section"><div class="nav-section-header"><a href="../connectivity/nfc/index0b8e.html?hl=zh-cn" >NFC</a><span class="toggle-icon" tabindex="0"></span></div><ul><li><a href="../connectivity/nfc/nfc0b8e.html?hl=zh-cn" >NFC 基础知识</a></li><li><a href="../connectivity/nfc/advanced-nfc0b8e.html?hl=zh-cn" >高级 NFC</a></li><li><a href="../connectivity/nfc/hce0b8e.html?hl=zh-cn" >基于主机的卡模拟</a></li></ul></li><li><a href="../connectivity/wifip2p0b8e.html?hl=zh-cn" >Wi-Fi P2P</a></li><li class="nav-section"><div class="nav-section-header"><a href="../connectivity/usb/index0b8e.html?hl=zh-cn" >USB</a><span class="toggle-icon" tabindex="0"></span></div><ul><li><a href="../connectivity/usb/accessory0b8e.html?hl=zh-cn" >配件</a></li><li><a href="../connectivity/usb/host0b8e.html?hl=zh-cn" >主机</a></li></ul></li><li><a href="../connectivity/sip0b8e.html?hl=zh-cn" >SIP</a></li></ul></li><li class="nav-section"><div class="nav-section-header"><a href="../text/index0b8e.html?hl=zh-cn" >文本和输入</a><span class="toggle-icon" tabindex="0"></span></div><ul><li><a href="../text/copy-paste0b8e.html?hl=zh-cn" >复制和粘贴</a></li><li><a href="../text/creating-input-method0b8e.html?hl=zh-cn" >创建 IME</a></li><li><a href="../text/spell-checker-framework0b8e.html?hl=zh-cn" >拼写检查程序</a></li></ul></li><li class="nav-section"><div class="nav-section-header"><a href="../data/index0b8e.html?hl=zh-cn" >数据存储</a><span class="toggle-icon" tabindex="0"></span></div><ul><li><a href="../data/data-storage0b8e.html?hl=zh-cn" >存储选项</a></li><li><a href="../data/backup0b8e.html?hl=zh-cn" >数据备份</a></li><li><a href="../data/install-location0b8e.html?hl=zh-cn" >应用安装位置</a></li></ul></li><li class="nav-section"><div class="nav-section-header"><a href="https://developer.android.com/topic/libraries/index.html?hl=zh-cn" >库</a><span class="toggle-icon" tabindex="0"></span></div><ul><li class="nav-section"><div class="nav-section-header"><a href="https://developer.android.com/topic/libraries/support-library/index.html?hl=zh-cn" >支持库</a><span class="toggle-icon" tabindex="0"></span></div><ul><li><a href="https://developer.android.com/topic/libraries/support-library/features.html?hl=zh-cn" >功能</a></li><li><a href="https://developer.android.com/topic/libraries/support-library/setup.html?hl=zh-cn" >设置</a></li><li><a href="https://developer.android.com/topic/libraries/support-library/revisions.html?hl=zh-cn" >修订历史记录</a></li></ul></li><li><a href="https://developer.android.com/topic/libraries/data-binding/index.html?hl=zh-cn" >数据绑定库</a></li><li class="nav-section"><div class="nav-section-header"><a href="https://developer.android.com/topic/libraries/testing-support-library/index.html?hl=zh-cn" >测试支持库</a><span class="toggle-icon" tabindex="0"></span></div><ul><li><a href="https://developer.android.com/reference/android/support/test/package-summary.html?hl=zh-cn" >API 参考</a></li></ul></li></ul></li><li class="nav-section"><div class="nav-section-header"><a href="../admin/index0b8e.html?hl=zh-cn" >管理</a><span class="toggle-icon" tabindex="0"></span></div><ul><li><a href="../admin/device-admin0b8e.html?hl=zh-cn" >设备政策</a></li></ul></li><li class="nav-section"><div class="nav-section-header"><a href="../../webapps/index0b8e.html?hl=zh-cn" >网络应用</a><span class="toggle-icon" tabindex="0"></span></div><ul><li><a href="../../webapps/targeting0b8e.html?hl=zh-cn" >在网络应用中支持不同屏幕</a></li><li><a href="../../webapps/webview0b8e.html?hl=zh-cn" >在 WebView 中构建网络应用</a></li><li><a href="../../webapps/migrating0b8e.html?hl=zh-cn" >迁移到 Android 4.4 中的 WebView</a></li><li><a href="../../webapps/debugging0b8e.html?hl=zh-cn" >调试网络应用</a></li><li><a href="../../webapps/best-practices0b8e.html?hl=zh-cn" >网络应用最佳做法</a></li></ul></li><li class="nav-section"><div class="nav-section-header"><a href="../../practices/index0b8e.html?hl=zh-cn"  de-lang="Bewährte Verfahren" es-lang="Prácticas recomendadas" fr-lang="Meilleures pratiques" it-lang="最佳做法" ja-lang="ベスト プラクティス" zh-cn-lang="最佳实践" zh-tw-lang="最佳實務">最佳做法</a><span class="toggle-icon" tabindex="0"></span></div><ul><li class="nav-section"><div class="nav-section-header"><a href="../../practices/screens_support0b8e.html?hl=zh-cn" >支持多种屏幕</a><span class="toggle-icon" tabindex="0"></span></div><ul><li><a href="../../practices/screens-distribution0b8e.html?hl=zh-cn" >分配到特定屏幕</a></li><li><a href="../../practices/screen-compat-mode0b8e.html?hl=zh-cn" >屏幕兼容性模式</a></li></ul></li><li><a href="../../practices/tablets-and-handsets0b8e.html?hl=zh-cn" >支持平板电脑和手机</a></li></ul></li>
            </ul>
            
          
        </div>
        
        
          



<ul id="dac-main-navigation" class="dac-nav-list dac-swap-section dac-left dac-no-anim" tabindex=0>
  <li class="dac-nav-item home">
    <a class="dac-nav-link" href="https://developer.android.com/index.html?hl=zh-cn">首页</a>
    <i class="dac-sprite dac-expand-more-black dac-nav-sub-slider" tabindex=0></i>
    <ul class="dac-nav-secondary about">
      <li class="dac-nav-item versions">
        <a class="dac-nav-link" href="https://developer.android.com/about/versions/nougat/index.html?hl=zh-cn">Android</a>
      </li>
      <li class="dac-nav-item wear">
        <a class="dac-nav-link" href="https://developer.android.com/wear/index.html?hl=zh-cn">Wear</a>
      </li>
      <li class="dac-nav-item tv">
        <a class="dac-nav-link" href="https://developer.android.com/tv/index.html?hl=zh-cn">TV</a>
      </li>
      <li class="dac-nav-item auto">
        <a class="dac-nav-link" href="https://developer.android.com/auto/index.html?hl=zh-cn">Auto</a>
      </li>
      <li class="dac-nav-item things">
        <a class="dac-nav-link" href="https://developer.android.com/things/index.html?hl=zh-cn">Things</a>
      </li>
    </ul>
  </li>
  <li class="dac-nav-item design">
    <a class="dac-nav-link" href="https://developer.android.com/design/index.html?hl=zh-cn"
       zh-tw-lang="設計"
       zh-cn-lang="设计"
       ru-lang="Проектирование"
       ko-lang="디자인"
       ja-lang="設計"
       es-lang="Diseñar">Design</a>
  </li>
  <li class="dac-nav-item develop">
    <a class="dac-nav-link" href="https://developer.android.com/develop/index.html?hl=zh-cn"
       zh-tw-lang="開發"
       zh-cn-lang="开发"
       ru-lang="Разработка"
       ko-lang="개발"
       ja-lang="開発"
       es-lang="Desarrollar">Develop</a>
    <i class="dac-sprite dac-expand-more-black dac-nav-sub-slider" tabindex=0></i>
    <ul class="dac-nav-secondary develop">
      <li class="dac-nav-item training">
        <a class="dac-nav-link" href="https://developer.android.com/training/index.html?hl=zh-cn"
           zh-tw-lang="訓練課程"
           zh-cn-lang="培训"
           ru-lang="Курсы"
           ko-lang="교육"
           ja-lang="トレーニング"
           es-lang="Capacitación">培训</a>
      </li>
      <li class="dac-nav-item guide">
        <a class="dac-nav-link" href="../../index0b8e.html?hl=zh-cn"
           zh-tw-lang="API 指南"
           zh-cn-lang="API 指南"
           ru-lang="Руководства по API"
           ko-lang="API 가이드"
           ja-lang="API ガイド"
           es-lang="Guías de la API">API Guides</a>
      </li>
      <li class="dac-nav-item reference">
        <a class="dac-nav-link" href="https://developer.android.com/reference/packages.html?hl=zh-cn"
           zh-tw-lang="參考資源"
           zh-cn-lang="参考"
           ru-lang="Справочник"
           ko-lang="참조문서"
           ja-lang="リファレンス"
           es-lang="Referencia">参考网页</a>
      </li>
      <li class="dac-nav-item samples">
        <a class="dac-nav-link" href="https://developer.android.com/samples/index.html?hl=zh-cn">示例</a>
      </li>
      <li class="dac-nav-item libraries">
        <a class="dac-nav-link" href="https://developer.android.com/topic/libraries/index.html?hl=zh-cn"
           >库</a></li>
      <li class="dac-nav-item studio">
        <a class="dac-nav-link" href="https://developer.android.com/studio/index.html?hl=zh-cn"
           >Android Studio</a></li>
      <li class="dac-nav-item ndk">
        <a class="dac-nav-link" href="https://developer.android.com/ndk/index.html?hl=zh-cn"
           >Android NDK</a></li>
      <li class="dac-nav-item google">
        <a class="dac-nav-link" href="https://developer.android.com/google/index.html?hl=zh-cn">Google Services</a>
      </li>
      <li class="dac-nav-item quality-guidelines">
        <a class="dac-nav-link" href="https://developer.android.com/develop/quality-guidelines/index.html?hl=zh-cn">Quality Guidelines</a>
      </li>
      <li class="dac-nav-item kotlin">
        <a class="dac-nav-link" href="https://developer.android.com/kotlin/index.html?hl=zh-cn">Kotlin</a>
       </li>
    </ul>
  </li>
  <li class="dac-nav-item distribute">
    <a class="dac-nav-link" href="https://developer.android.com/distribute/index.html?hl=zh-cn"
       zh-tw-lang="發佈"
       zh-cn-lang="分发"
       ru-lang="Распространение"
       ko-lang="배포"
       ja-lang="配布"
       de-lang="Vertrieb"
       es-lang="Distribuir"
       es-419-lang="Distribuye"
       fr-lang="Distribuer"
       id-lang="Distribusikan"
       pt-br-lang="Distribuição"
       th-lang="จัดจำหน่าย"
       tr-lang="Dağıtma"
       vi-lang="Phân phối">Distribute</a>
    <i class="dac-sprite dac-expand-more-black dac-nav-sub-slider" tabindex=0></i>
    <ul class="dac-nav-secondary distribute">
      <li class="dac-nav-item google-play">
        <a class="dac-nav-link" href="https://developer.android.com/distribute/google-play/index.html?hl=zh-cn">Google Play</a>
      </li>
      <li class="dac-nav-item console">
        <a class="dac-nav-link" href="https://developer.android.com/distribute/console/index.html?hl=zh-cn">Play 控制台</a>
      </li>
      <li class="dac-nav-item best-practices">
        <a class="dac-nav-link" href="https://developer.android.com/distribute/best-practices/index.html?hl=zh-cn"
          es-419-lang="Recomendaciones"
          fr-lang="Bonnes pratiques"
          id-lang="Praktik terbaik"
          ja-lang="おすすめの方法"
          ko-lang="권장사항"
          pt-br-lang="Práticas recomendadas"
          ru-lang="Рекомендации"
          th-lang="จัดจำหน่าย"
          tr-lang="En iyi uygulamalar"
          vi-lang="Các phương pháp hay nhất"
          zh-cn-lang="最佳做法"
          zh-tw-lang="最佳做法">Best practices</a>
      </li>
      <li class="dac-nav-item marketing-tools">
        <a class="dac-nav-link" href="https://developer.android.com/distribute/marketing-tools/index.html?hl=zh-cn"
          de-lang="Marketing-Tools"
          es-419-lang="Herramientas de marketing"
          fr-lang="Outils marketing"
          id-lang="Fitur pemasaran"
          ja-lang="マーケティング ツール"
          ko-lang="마케팅 도구"
          pt-br-lang="Ferramentas de marketing"
          ru-lang="Маркетинговые инструменты"
          th-lang="เครื่องมือการตลาด"
          tr-lang="Pazarlama araçları"
          vi-lang="Công cụ tiếp thị"
          zh-cn-lang="营销工具"
          zh-tw-lang="行銷工具">Marketing tools</a>
      </li>
      <li class="dac-nav-item policy-center">
        <a class="dac-nav-link" href="https://play.google.com/about/developer-content-policy/" target="_blank">Policy center</a>
      </li>
    </ul>
  </li>
  <li class="dac-nav-item stories">
    <a class="dac-nav-link" href="https://developer.android.com/stories/index.html?hl=zh-cn">Stories</a>
  </li>
  
  <li class="dac-nav-item preview">
    <a class="dac-nav-link" href="https://developer.android.com/preview/index.html?hl=zh-cn">Preview</a>
  </li>
  
</ul>

        
      </div>
    </div>
  </nav>

  <a name="top" tabindex="0"></a>
  
  <div class="wrap clearfix" id="body-content">
  
    
      
      <div class="content-header">
        <ul class="dac-header-crumbs"></ul>
        <!-- Breadcrumb Setup -->
        <script>$('.dac-nav-list').dacCurrentPage().dacCrumbs();</script>
        <h1 itemprop="name">设置</h1>
      
        
      
      </div>
      
    
    <div class="jd-descr " itemprop="articleBody">
      

<div id="qv-wrapper">
<div id="qv">

<h2>本文内容</h2>
<ol>
  <li><a href="#Overview">概览</a>
    <ol>
      <li><a href="#SettingTypes">首选项</a></li>
    </ol>
  </li>
  <li><a href="#DefiningPrefs">使用 XML 定义首选项</a>
    <ol>
      <li><a href="#Groups">创建设置组</a></li>
      <li><a href="#Intents">使用 Intent</a></li>
    </ol>
  </li>
  <li><a href="#Activity">创建首选项 Activity</a></li>
  <li><a href="#Fragment">使用首选项片段</a></li>
  <li><a href="#Defaults">设置默认值</a></li>
  <li><a href="#PreferenceHeaders">使用首选项标头</a>
    <ol>
      <li><a href="#CreateHeaders">创建标头文件</a></li>
      <li><a href="#DisplayHeaders">显示标头</a></li>
      <li><a href="#BackCompatHeaders">使用首选项标头支持旧版本</a></li>
    </ol>
  </li>
  <li><a href="#ReadingPrefs">读取首选项</a>
    <ol>
      <li><a href="#Listening">侦听首选项变更</a></li>
    </ol>
  </li>
  <li><a href="#NetworkUsage">管理网络使用情况</a></li>
  <li><a href="#Custom">构建自定义首选项</a>
    <ol>
      <li><a href="#CustomSelected">指定用户界面</a></li>
      <li><a href="#CustomSave">保存设置的值</a></li>
      <li><a href="#CustomInitialize">初始化当前值</a></li>
      <li><a href="#CustomDefault">提供默认值</a></li>
      <li><a href="#CustomSaveState">保存和恢复首选项的状态</a></li>
    </ol>
  </li>
</ol>

<h2>关键类</h2>
<ol>
  <li><code><a href="https://developer.android.com/reference/android/preference/Preference.html?hl=zh-cn">Preference</a></code></li>
  <li><code><a href="https://developer.android.com/reference/android/preference/PreferenceActivity.html?hl=zh-cn">PreferenceActivity</a></code></li>
  <li><code><a href="https://developer.android.com/reference/android/preference/PreferenceFragment.html?hl=zh-cn">PreferenceFragment</a></code></li>
</ol>


<h2>另请参阅</h2>
<ol>
  <li><a href="https://developer.android.com/design/patterns/settings.html?hl=zh-cn">设置设计指南</a></li>
</ol>
</div>
</div>




<p>应用通常包括允许用户修改应用特性和行为的设置。例如，有些应用允许用户指定是否启用通知，或指定应用与云端同步数据的频率。

</p>

<p>若要为应用提供设置，您应该使用
Android 的 <code><a href="https://developer.android.com/reference/android/preference/Preference.html?hl=zh-cn">Preference</a></code> API
构建一个与其他 Android 应用中的用户体验一致的界面（包括系统设置）。本文旨在介绍如何使用
<code><a href="https://developer.android.com/reference/android/preference/Preference.html?hl=zh-cn">Preference</a></code> API 构建应用设置。</p>

<div class="note design">
<p><strong>设置设计</strong></p>
  <p>有关如何设计设置的信息，请阅读<a href="https://developer.android.com/design/patterns/settings.html?hl=zh-cn">设置</a>设计指南。</p>
</div>


<img src="../../../images/ui/settings/settings0b8e.png?hl=zh-cn" alt="" width="435" />
<p class="img-caption"><strong>图 1.</strong> 来自 Android 信息应用的设置的屏幕截图。
选择由 <code><a href="https://developer.android.com/reference/android/preference/Preference.html?hl=zh-cn">Preference</a></code> 定义的项目将打开一个用于更改设置的界面。
</p>




<h2 id="Overview">概览</h2>

<p>设置是使用您在 XML 文件中声明的
<code><a href="https://developer.android.com/reference/android/preference/Preference.html?hl=zh-cn">Preference</a></code>
类的各种子类构建而成，而不是使用 <code><a href="https://developer.android.com/reference/android/view/View.html?hl=zh-cn">View</a></code> 对象构建用户界面。</p>

<p><code><a href="https://developer.android.com/reference/android/preference/Preference.html?hl=zh-cn">Preference</a></code>
对象是单个设置的构建基块。每个 <code><a href="https://developer.android.com/reference/android/preference/Preference.html?hl=zh-cn">Preference</a></code> 均作为项目显示在列表中，并提供适当的
UI 供用户修改设置。例如，<code><a href="https://developer.android.com/reference/android/preference/CheckBoxPreference.html?hl=zh-cn">CheckBoxPreference</a></code> 可创建一个列表项用于显示复选框，<code><a href="https://developer.android.com/reference/android/preference/ListPreference.html?hl=zh-cn">ListPreference</a></code> 可创建一个项目用于打开包含选择列表的对话框。</p>

<p>您添加的每个 <code><a href="https://developer.android.com/reference/android/preference/Preference.html?hl=zh-cn">Preference</a></code> 都有一个相应的键值对，可供系统用来将设置保存在应用设置的默认
<code><a href="https://developer.android.com/reference/android/content/SharedPreferences.html?hl=zh-cn">SharedPreferences</a></code>
文件中。当用户更改设置时，系统会为您更新
<code><a href="https://developer.android.com/reference/android/content/SharedPreferences.html?hl=zh-cn">SharedPreferences</a></code> 文件中的相应值。您只应在需要读取值以根据用户设置确定应用的行为时，才与关联的
<code><a href="https://developer.android.com/reference/android/content/SharedPreferences.html?hl=zh-cn">SharedPreferences</a></code>
文件直接交互。</p>

<p>为每个设置保存在 <code><a href="https://developer.android.com/reference/android/content/SharedPreferences.html?hl=zh-cn">SharedPreferences</a></code>
中的值可能是以下数据类型之一：</p>

<ul>
  <li>布尔值</li>
  <li>浮点型</li>
  <li>整型</li>
  <li>长整型</li>
  <li>字符串</li>
  <li>字符串 <code><a href="https://developer.android.com/reference/java/util/Set.html?hl=zh-cn">Set</a></code></li>
</ul>

<p>由于应用的设置 UI 是使用 <code><a href="https://developer.android.com/reference/android/preference/Preference.html?hl=zh-cn">Preference</a></code>
对象（而非
<code><a href="https://developer.android.com/reference/android/view/View.html?hl=zh-cn">View</a></code> 对象）构建而成，因此您需要使用专门的 <code><a href="https://developer.android.com/reference/android/app/Activity.html?hl=zh-cn">Activity</a></code> 或
<code><a href="https://developer.android.com/reference/android/app/Fragment.html?hl=zh-cn">Fragment</a></code> 子类显示列表设置：</p>

<ul>
  <li>如果应用支持早于 3.0（API 级别 10 及更低级别）的 Android 版本，则您必须将 Activity 构建为
<code><a href="https://developer.android.com/reference/android/preference/PreferenceActivity.html?hl=zh-cn">PreferenceActivity</a></code> 类的扩展。</li>
  <li>对于 Android 3.0 及更高版本，您应改用传统
<code><a href="https://developer.android.com/reference/android/app/Activity.html?hl=zh-cn">Activity</a></code>，以托管可显示应用设置的 <code><a href="https://developer.android.com/reference/android/preference/PreferenceFragment.html?hl=zh-cn">PreferenceFragment</a></code>。但是，如果您拥有多组设置，则还可以使用
<code><a href="https://developer.android.com/reference/android/preference/PreferenceActivity.html?hl=zh-cn">PreferenceActivity</a></code>
为大屏幕创建双窗格布局。</li>
</ul>

<p><a href="#Activity">创建首选项 Activity</a> 和<a href="#Fragment">使用首选项片段</a>部分将讨论如何设置 <code><a href="https://developer.android.com/reference/android/preference/PreferenceActivity.html?hl=zh-cn">PreferenceActivity</a></code> 以及 <code><a href="https://developer.android.com/reference/android/preference/PreferenceFragment.html?hl=zh-cn">PreferenceFragment</a></code> 实例。
</p>


<h3 id="SettingTypes">首选项</h3>

<p>所有应用设置均由 <code><a href="https://developer.android.com/reference/android/preference/Preference.html?hl=zh-cn">Preference</a></code> 类的特定子类表示。每个子类均包括一组核心属性，允许您指定设置标题和默认值等内容。
此外，每个子类还提供自己的专用属性和用户界面。
例如，图 1 显示的是“信息”
应用的设置屏幕截图。设置屏幕中的每个列表项均由不同的 <code><a href="https://developer.android.com/reference/android/preference/Preference.html?hl=zh-cn">Preference</a></code> 对象提供支持。</p>

<p>一些最常用的首选项如下：</p>

<dl>
  <dt><code><a href="https://developer.android.com/reference/android/preference/CheckBoxPreference.html?hl=zh-cn">CheckBoxPreference</a></code></dt>
  <dd>显示一个包含已启用或已停用设置复选框的项目。保存的值是布尔型（如果选中则为
<code>true</code>）。</dd>

  <dt><code><a href="https://developer.android.com/reference/android/preference/ListPreference.html?hl=zh-cn">ListPreference</a></code></dt>
  <dd>打开一个包含单选按钮列表的对话框。保存的值可以是任一受支持的值类型（如上所列）。
</dd>

  <dt><code><a href="https://developer.android.com/reference/android/preference/EditTextPreference.html?hl=zh-cn">EditTextPreference</a></code></dt>
  <dd>打开一个包含 <code><a href="https://developer.android.com/reference/android/widget/EditText.html?hl=zh-cn">EditText</a></code> 小部件的对话框。保存的值是 <code><a href="https://developer.android.com/reference/java/lang/String.html?hl=zh-cn">String</a></code>。</dd>
</dl>

<p>有关所有其他子类及其对应属性的列表，请参阅 <code><a href="https://developer.android.com/reference/android/preference/Preference.html?hl=zh-cn">Preference</a></code>
类。</p>

<p>当然，内置类不能满足所有需求，您的应用可能需要更专业化的内容。
例如，该平台目前不提供用于选取数字或日期的 <code><a href="https://developer.android.com/reference/android/preference/Preference.html?hl=zh-cn">Preference</a></code> 类。因此，您可能需要定义自己的
<code><a href="https://developer.android.com/reference/android/preference/Preference.html?hl=zh-cn">Preference</a></code> 子类。如需有关执行此操作的帮助，请参阅<a href="#Custom">构建自定义首选项</a>部分。</p>



<h2 id="DefiningPrefs">使用 XML 定义首选项</h2>

<p>虽然您可以在运行时实例化新的 <code><a href="https://developer.android.com/reference/android/preference/Preference.html?hl=zh-cn">Preference</a></code>
对象，不过您还是应该使用 <code><a href="https://developer.android.com/reference/android/preference/Preference.html?hl=zh-cn">Preference</a></code>
对象的层次结构在 XML 中定义设置列表。使用 XML
文件定义设置的集合是首选方法，因为该文件提供了一个便于更新的易读结构。此外，应用的设置通常是预先确定的，不过您仍可在运行时修改此集合。
</p>

<p>每个 <code><a href="https://developer.android.com/reference/android/preference/Preference.html?hl=zh-cn">Preference</a></code> 子类均可以使用与类名（如 <code>&lt;CheckBoxPreference&gt;</code>）匹配的 XML 元素来声明。
</p>

<p>您必须将 XML 文件保存在 <code>res/xml/</code> 目录中。尽管您可以随意命名该文件，但它通常命名为 <code>preferences.xml</code>。
您通常只需一个文件，因为层次结构中的分支（可打开各自的设置列表）是使用
<code><a href="https://developer.android.com/reference/android/preference/PreferenceScreen.html?hl=zh-cn">PreferenceScreen</a></code>
的嵌套实例声明的。</p>

<p class="note"><strong>注：</strong>若要为设置创建多窗格布局，则需要为每个片段提供单独的
XML 文件。</p>

<p>XML 文件的根节点必须是一个 <code><a href="https://developer.android.com/reference/android/preference/PreferenceScreen.html?hl=zh-cn">PreferenceScreen</a></code>
<PreferenceScreen>元素。您可以在此元素内添加每个 <code><a href="https://developer.android.com/reference/android/preference/Preference.html?hl=zh-cn">Preference</a></code>。在
<code><a href="https://developer.android.com/reference/android/preference/PreferenceScreen.html?hl=zh-cn">&lt;PreferenceScreen&gt;</a></code>
元素内添加的每个子项均将作为单独的项目显示在设置列表中。</p>

<p>例如：</p>

<pre>
&lt;?xml version="1.0" encoding="utf-8"?>
&lt;PreferenceScreen xmlns:android="http://schemas.android.com/apk/res/android">
    &lt;CheckBoxPreference
        android:key="pref_sync"
        android:title="@string/pref_sync"
        android:summary="@string/pref_sync_summ"
        android:defaultValue="true" />
    &lt;ListPreference
        android:dependency="pref_sync"
        android:key="pref_syncConnectionType"
        android:title="@string/pref_syncConnectionType"
        android:dialogTitle="@string/pref_syncConnectionType"
        android:entries="@array/pref_syncConnectionTypes_entries"
        android:entryValues="@array/pref_syncConnectionTypes_values"
        android:defaultValue="@string/pref_syncConnectionTypes_default" />
&lt;/PreferenceScreen>
</pre>

<p>在此示例中，有一个 <code><a href="https://developer.android.com/reference/android/preference/CheckBoxPreference.html?hl=zh-cn">CheckBoxPreference</a></code> 和 <code><a href="https://developer.android.com/reference/android/preference/ListPreference.html?hl=zh-cn">ListPreference</a></code>。这两项均包括以下三个属性：</p>

<dl>
  <dt><code>android:key</code></dt>
  <dd>对于要保留数据值的首选项，必须拥有此属性。它指定系统在将此设置的值保存在 <code><a href="https://developer.android.com/reference/android/content/SharedPreferences.html?hl=zh-cn">SharedPreferences</a></code> 中时所用的唯一键（字符串）。

  <p>不需要此属性的唯一情形是：首选项是
<code><a href="https://developer.android.com/reference/android/preference/PreferenceCategory.html?hl=zh-cn">PreferenceCategory</a></code> 或<code><a href="https://developer.android.com/reference/android/preference/PreferenceScreen.html?hl=zh-cn">PreferenceScreen</a></code>，或者首选项指定要调用的
<code><a href="https://developer.android.com/reference/android/content/Intent.html?hl=zh-cn">Intent</a></code>（使用 <a href="#Intents"><code>&lt;intent&gt;</code></a> 元素）或要显示的 <code><a href="https://developer.android.com/reference/android/app/Fragment.html?hl=zh-cn">Fragment</a></code>（使用 <a href="https://developer.android.com/reference/android/preference/Preference.html?hl=zh-cn#attr_android:fragment"><code>android:fragment</code></a> 属性）。<em></em></p>
  </dd>
  <dt><code>android:title</code></dt>
  <dd>此属性为设置提供用户可见的名称。</dd>
  <dt><code>android:defaultValue</code></dt>
  <dd>此属性指定系统应该在 <code><a href="https://developer.android.com/reference/android/content/SharedPreferences.html?hl=zh-cn">SharedPreferences</a></code> 文件中设置的初始值。您应该为所有设置提供默认值。
</dd>
</dl>

<p>有关所有其他受支持属性的信息，请参阅 <code><a href="https://developer.android.com/reference/android/preference/Preference.html?hl=zh-cn">Preference</a></code>（和相应子类）文档。</p>


<div class="figure" style="width:300px">
  <img src="../../../images/ui/settings/settings-titles0b8e.png?hl=zh-cn" alt="" />
  <p class="img-caption"><strong>图 2.</strong> 带标题的设置类别。
 <br/><b>1.</b> 类别由 <code><a href="https://developer.android.com/reference/android/preference/PreferenceCategory.html?hl=zh-cn">&lt;PreferenceCategory&gt;</a></code> 元素指定。 <br/><b>2.</b> 标题由 <code>android:title</code> 属性指定。
</p>
</div>


<p>当设置列表超过 10 项时，您可能需要添加标题来定义设置组或在单独的屏幕中显示这些组。

下文将介绍这些选项。</p>


<h3 id="Groups">创建设置组</h3>

<p>如果您提供的列表包含 10
项或更多设置，则用户可能难以浏览、理解和处理这些设置。若要弥补这一点，您可以将部分或全部设置分成若干组，从而有效地将一个长列表转化为多个短列表。

可以通过下列两种方法之一提供一组相关设置：</p>

<ul>
  <li><a href="#Titles">使用标题</a></li>
  <li><a href="#Subscreens">使用子屏幕</a></li>
</ul>

<p>您可以使用其中一种或两种分组方法来组织应用的设置。决定要使用的方法以及如何拆分设置时，应遵循 Android 设计的<a href="https://developer.android.com/design/patterns/settings.html?hl=zh-cn">设置</a>指南中的准则。

</p>


<h4 id="Titles">使用标题</h4>

<p>若要以分隔线分隔两组设置并为其提供标题（如图 2 所示），请将每组
<code><a href="https://developer.android.com/reference/android/preference/Preference.html?hl=zh-cn">Preference</a></code> 对象放入 <code><a href="https://developer.android.com/reference/android/preference/PreferenceCategory.html?hl=zh-cn">PreferenceCategory</a></code> 内。</p>

<p>例如：</p>

<pre>
&lt;PreferenceScreen xmlns:android="http://schemas.android.com/apk/res/android">
    &lt;PreferenceCategory
        android:title="&#64;string/pref_sms_storage_title"
        android:key="pref_key_storage_settings">
        &lt;CheckBoxPreference
            android:key="pref_key_auto_delete"
            android:summary="&#64;string/pref_summary_auto_delete"
            android:title="&#64;string/pref_title_auto_delete"
            android:defaultValue="false"... />
        &lt;Preference
            android:key="pref_key_sms_delete_limit"
            android:dependency="pref_key_auto_delete"
            android:summary="&#64;string/pref_summary_delete_limit"
            android:title="&#64;string/pref_title_sms_delete"... />
        &lt;Preference
            android:key="pref_key_mms_delete_limit"
            android:dependency="pref_key_auto_delete"
            android:summary="&#64;string/pref_summary_delete_limit"
            android:title="&#64;string/pref_title_mms_delete" ... />
    &lt;/PreferenceCategory>
    ...
&lt;/PreferenceScreen>
</pre>


<h4 id="Subscreens">使用子屏幕</h4>

<p>若要将设置组放入子屏幕（如图 3 所示），请将
<code><a href="https://developer.android.com/reference/android/preference/Preference.html?hl=zh-cn">Preference</a></code> 对象组放入 <code><a href="https://developer.android.com/reference/android/preference/PreferenceScreen.html?hl=zh-cn">PreferenceScreen</a></code> 内。</p>

<img src="../../../images/ui/settings/settings-subscreen0b8e.png?hl=zh-cn" alt="" />
<p class="img-caption"><strong>图 3.</strong> 设置子屏幕。<code>&lt;PreferenceScreen&gt;</code> 元素创建的项目选中后，即会打开一个单独的列表来显示嵌套设置。
</p>

<p>例如：</p>

<pre>
&lt;PreferenceScreen  xmlns:android="http://schemas.android.com/apk/res/android">
    &lt;!-- opens a subscreen of settings -->
    &lt;PreferenceScreen
        android:key="button_voicemail_category_key"
        android:title="&#64;string/voicemail"
        android:persistent="false">
        &lt;ListPreference
            android:key="button_voicemail_provider_key"
            android:title="&#64;string/voicemail_provider" ... />
        &lt;!-- opens another nested subscreen -->
        &lt;PreferenceScreen
            android:key="button_voicemail_setting_key"
            android:title="&#64;string/voicemail_settings"
            android:persistent="false">
            ...
        &lt;/PreferenceScreen>
        &lt;RingtonePreference
            android:key="button_voicemail_ringtone_key"
            android:title="&#64;string/voicemail_ringtone_title"
            android:ringtoneType="notification" ... />
        ...
    &lt;/PreferenceScreen>
    ...
&lt;/PreferenceScreen>
</pre>


<h3 id="Intents">使用 Intent</h3>

<p>在某些情况下，您可能需要首选项来打开不同的 Activity（而不是网络浏览器等设置屏幕）或查看网页。
要在用户选择首选项时调用 <code><a href="https://developer.android.com/reference/android/content/Intent.html?hl=zh-cn">Intent</a></code>，请将<code>&lt;intent&gt;</code>
元素添加为相应 <code>&lt;Preference&gt;</code> 元素的子元素。</p>

<p>例如，您可以按如下方法使用首选项打开网页：</p>

<pre>
&lt;Preference android:title="@string/prefs_web_page" >
    &lt;intent android:action="android.intent.action.VIEW"
            android:data="http://www.example.com" />
&lt;/Preference>
</pre>

<p>您可以使用以下属性创建隐式和显式 Intent：</p>

<dl>
  <dt><code>android:action</code></dt>
    <dd>要分配的操作（按照 <code><a href="https://developer.android.com/reference/android/content/Intent.html?hl=zh-cn#setAction(java.lang.String)">setAction()</a></code>
方法）。</dd>
  <dt><code>android:data</code></dt>
    <dd>要分配的数据（按照 <code><a href="https://developer.android.com/reference/android/content/Intent.html?hl=zh-cn#setData(android.net.Uri)">setData()</a></code> 方法）。</dd>
  <dt><code>android:mimeType</code></dt>
    <dd>要分配的 MIME 类型（按照 <code><a href="https://developer.android.com/reference/android/content/Intent.html?hl=zh-cn#setType(java.lang.String)">setType()</a></code>
方法）。</dd>
  <dt><code>android:targetClass</code></dt>
    <dd>组件名称的类部分（按照 <code><a href="https://developer.android.com/reference/android/content/Intent.html?hl=zh-cn#setComponent(android.content.ComponentName)">setComponent()</a></code> 方法）。</dd>
  <dt><code>android:targetPackage</code></dt>
    <dd>组件名称的软件包部分（按照 <code><a href="https://developer.android.com/reference/android/content/Intent.html?hl=zh-cn#setComponent(android.content.ComponentName)">setComponent()</a></code> 方法）。</dd>
</dl>



<h2 id="Activity">创建首选项 Activity</h2>

<p>要在 Activity 中显示您的设置，请扩展 <code><a href="https://developer.android.com/reference/android/preference/PreferenceActivity.html?hl=zh-cn">PreferenceActivity</a></code> 类。这是传统 <code><a href="https://developer.android.com/reference/android/app/Activity.html?hl=zh-cn">Activity</a></code> 类的扩展，该类根据 <code><a href="https://developer.android.com/reference/android/preference/Preference.html?hl=zh-cn">Preference</a></code> 对象的层次结构显示设置列表。当用户进行更改时，<code><a href="https://developer.android.com/reference/android/preference/PreferenceActivity.html?hl=zh-cn">PreferenceActivity</a></code>
会自动保留与每个 <code><a href="https://developer.android.com/reference/android/preference/Preference.html?hl=zh-cn">Preference</a></code> 相关的设置。</p>

<p class="note"><strong>注：</strong>如果您在开发针对 Android 3.0 及
更高版本的应用，则应改为使用 <code><a href="https://developer.android.com/reference/android/preference/PreferenceFragment.html?hl=zh-cn">PreferenceFragment</a></code>。转到下文有关<a href="#Fragment">使用首选项片段</a>的部分。
</p>

<p>请记住最重要的一点，就是不要在 <code><a href="https://developer.android.com/reference/android/preference/PreferenceActivity.html?hl=zh-cn#onCreate(android.os.Bundle)">onCreate()</a></code> 回调期间加载视图的布局。相反，请调用 <code><a href="https://developer.android.com/reference/android/preference/PreferenceActivity.html?hl=zh-cn#addPreferencesFromResource(int)">addPreferencesFromResource()</a></code> 以将在 XML 文件中声明的首选项添加到 Activity。
例如，一个能够正常工作的
<code><a href="https://developer.android.com/reference/android/preference/PreferenceActivity.html?hl=zh-cn">PreferenceActivity</a></code> 至少需要如下代码：</p>

<pre>
public class SettingsActivity extends PreferenceActivity {
    &#64;Override
    public void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        addPreferencesFromResource(R.xml.preferences);
    }
}
</pre>

<p>实际上，对于某些应用而言，此代码就已足够，因为用户修改某首选项后，系统会立即将所做的更改保存到默认 <code><a href="https://developer.android.com/reference/android/content/SharedPreferences.html?hl=zh-cn">SharedPreferences</a></code> 文件中，如需检查用户的设置，可以使用您的其他应用组件读取该文件。

不过，许多应用需要的代码要稍微多一点，以侦听首选项发生的变化。有关侦听
<code><a href="https://developer.android.com/reference/android/content/SharedPreferences.html?hl=zh-cn">SharedPreferences</a></code>
文件变化的信息，请参阅<a href="#ReadingPrefs">读取首选项</a>部分。
</p>




<h2 id="Fragment">使用首选项片段</h2>

<p>如果您在开发针对 Android 3.0（API 级别 11）及更高版本的应用，则应使用 <code><a href="https://developer.android.com/reference/android/preference/PreferenceFragment.html?hl=zh-cn">PreferenceFragment</a></code> 显示 <code><a href="https://developer.android.com/reference/android/preference/Preference.html?hl=zh-cn">Preference</a></code>
对象的列表。您可以将 <code><a href="https://developer.android.com/reference/android/preference/PreferenceFragment.html?hl=zh-cn">PreferenceFragment</a></code> 添加到任何 Activity，而不必使用
<code><a href="https://developer.android.com/reference/android/preference/PreferenceActivity.html?hl=zh-cn">PreferenceActivity</a></code>。</p>

<p>与仅使用上述 Activity 相比，无论您在构建何种 Activity，<a href="../../components/fragments0b8e.html?hl=zh-cn">片段</a>都可为应用提供一个更加灵活的体系结构。

因此，我们建议您尽可能使用 <code><a href="https://developer.android.com/reference/android/preference/PreferenceFragment.html?hl=zh-cn">PreferenceFragment</a></code> 控制设置的显示，而不是使用 <code><a href="https://developer.android.com/reference/android/preference/PreferenceActivity.html?hl=zh-cn">PreferenceActivity</a></code>。</p>

<p><code><a href="https://developer.android.com/reference/android/preference/PreferenceFragment.html?hl=zh-cn">PreferenceFragment</a></code> 的实现就像定义
<code><a href="https://developer.android.com/reference/android/preference/PreferenceFragment.html?hl=zh-cn#onCreate(android.os.Bundle)">onCreate()</a></code> 方法以使用
<code><a href="https://developer.android.com/reference/android/preference/PreferenceFragment.html?hl=zh-cn#addPreferencesFromResource(int)">addPreferencesFromResource()</a></code> 加载首选项文件一样简单。例如：</p>

<pre>
public static class SettingsFragment extends PreferenceFragment {
    &#64;Override
    public void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);

        // Load the preferences from an XML resource
        addPreferencesFromResource(R.xml.preferences);
    }
    ...
}
</pre>

<p>然后，正如您对其他任何
<code><a href="https://developer.android.com/reference/android/app/Fragment.html?hl=zh-cn">Fragment</a></code> 的处理一样，您可以将此片段添加到 <code><a href="https://developer.android.com/reference/android/app/Activity.html?hl=zh-cn">Activity</a></code>。例如：</p>

<pre>
public class SettingsActivity extends Activity {
    &#64;Override
    protected void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);

        // Display the fragment as the main content.
        getFragmentManager().beginTransaction()
                .replace(android.R.id.content, new SettingsFragment())
                .commit();
    }
}
</pre>

<p class="note"><strong>注：</strong><code><a href="https://developer.android.com/reference/android/preference/PreferenceFragment.html?hl=zh-cn">PreferenceFragment</a></code> 没有自己的
<code><a href="https://developer.android.com/reference/android/content/Context.html?hl=zh-cn">Context</a></code> 对象。如需 <code><a href="https://developer.android.com/reference/android/content/Context.html?hl=zh-cn">Context</a></code>
对象，您可以调用 <code><a href="https://developer.android.com/reference/android/app/Fragment.html?hl=zh-cn#getActivity()">getActivity()</a></code>。但请注意，只应在该片段附加到 Activity 时才调用
<code><a href="https://developer.android.com/reference/android/app/Fragment.html?hl=zh-cn#getActivity()">getActivity()</a></code>。如果片段尚未附加，或在其生命周期结束期间分离，则<code><a href="https://developer.android.com/reference/android/app/Fragment.html?hl=zh-cn#getActivity()">getActivity()</a></code> 将返回 null。
</p>


<h2 id="Defaults">设置默认值</h2>

<p>您创建的首选项可能会为应用定义一些重要行为，因此在用户首次打开应用时，您有必要使用每个 <code><a href="https://developer.android.com/reference/android/preference/Preference.html?hl=zh-cn">Preference</a></code>
的默认值初始化相关的
<code><a href="https://developer.android.com/reference/android/content/SharedPreferences.html?hl=zh-cn">SharedPreferences</a></code>
文件。</p>

<p>首先，您必须使用 <code>android:defaultValue</code> 属性为 XML 文件中的每个 <code><a href="https://developer.android.com/reference/android/preference/Preference.html?hl=zh-cn">Preference</a></code>
对象指定默认值。该值可以是适合相应
<code><a href="https://developer.android.com/reference/android/preference/Preference.html?hl=zh-cn">Preference</a></code> 对象的任意数据类型。例如：
</p>

<pre>
&lt;!-- default value is a boolean -->
&lt;CheckBoxPreference
    android:defaultValue="true"
    ... />

&lt;!-- default value is a string -->
&lt;ListPreference
    android:defaultValue="@string/pref_syncConnectionTypes_default"
    ... />
</pre>

<p>然后，通过应用的主 Activity（以及用户首次进入应用所藉由的任何其他 Activity）中的 <code><a href="https://developer.android.com/reference/android/app/Activity.html?hl=zh-cn#onCreate(android.os.Bundle)">onCreate()</a></code>
方法调用 <code><a href="https://developer.android.com/reference/android/preference/PreferenceManager.html?hl=zh-cn#setDefaultValues(android.content.Context, int, boolean)">setDefaultValues()</a></code>：
</p>

<pre>
PreferenceManager.setDefaultValues(this, R.xml.advanced_preferences, false);
</pre>

<p>在
<code><a href="https://developer.android.com/reference/android/app/Activity.html?hl=zh-cn#onCreate(android.os.Bundle)">onCreate()</a></code>
期间调用此方法可确保使用默认设置正确初始化应用，而应用可能需要读取这些设置以确定某些行为（例如，是否在蜂窝网络中下载数据）。
</p>

<p>此方法采用三个参数：</p>
<ul>
  <li>应用 <code><a href="https://developer.android.com/reference/android/content/Context.html?hl=zh-cn">Context</a></code>。</li>
  <li>要为其设置默认值的首选项 XML 文件的资源 ID。</li>
  <li>一个布尔值，用于指示是否应该多次设置默认值。
<p>如果该值为 <code>false</code>，则仅当过去从未调用此方法时（或者默认值共享首选项文件中的
<code><a href="https://developer.android.com/reference/android/preference/PreferenceManager.html?hl=zh-cn#KEY_HAS_SET_DEFAULT_VALUES">KEY_HAS_SET_DEFAULT_VALUES</a></code>为
false 时），系统才会设置默认值。</p></li>
</ul>

<p>只要将第三个参数设置为
<code>false</code>，您便可在每次启动 Activity 时安全地调用此方法，而不必通过重置为默认值来替代用户已保存的首选项。
但是，如果将它设置为
<code>true</code>，则需要使用默认值替代之前的所有值。</p>



<h2 id="PreferenceHeaders">使用首选项标头</h2>

<p>在极少数情况下，您可能需要设计设置，使第一个屏幕仅显示<a href="#Subscreens">子屏幕</a>的列表（例如在系统“设置”应用中，如图 4 和图 5 所示）。

在开发针对 Android 3.0 及更高版本的此类设计时，您应该使用“标头”功能，而非使用嵌套的
<code><a href="https://developer.android.com/reference/android/preference/PreferenceScreen.html?hl=zh-cn">PreferenceScreen</a></code> 元素构建子屏幕。
</p>

<p>要使用标头构建设置，您需要：</p>
<ol>
  <li>将每组设置分成单独的 <code><a href="https://developer.android.com/reference/android/preference/PreferenceFragment.html?hl=zh-cn">PreferenceFragment</a></code> 实例。即，每组设置均需要一个单独的 XML
文件。</li>
  <li>创建 XML
标头文件，其中列出每个设置组并声明哪个片段包含对应的设置列表。</li>
  <li>扩展 <code><a href="https://developer.android.com/reference/android/preference/PreferenceActivity.html?hl=zh-cn">PreferenceActivity</a></code> 类以托管设置。</li>
  <li>实现 <code><a href="https://developer.android.com/reference/android/preference/PreferenceActivity.html?hl=zh-cn#onBuildHeaders(java.util.List<android.preference.PreferenceActivity.Header>)">onBuildHeaders()</a></code> 回调以指定标头文件。
</li>
</ol>

<p>使用此设计的一大好处是，在大屏幕上运行时，<code><a href="https://developer.android.com/reference/android/preference/PreferenceActivity.html?hl=zh-cn">PreferenceActivity</a></code>
会自动提供双窗格布局（如图 4 所示）。</p>

<p>即使您的应用支持早于 3.0 的 Android 版本，您仍可将应用设计为使用
<code><a href="https://developer.android.com/reference/android/preference/PreferenceFragment.html?hl=zh-cn">PreferenceFragment</a></code>
在较新版本的设备上呈现双窗格布局，同时仍支持较旧版本设备上传统的多屏幕层次结构（请参阅<a href="#BackCompatHeaders">使用首选项标头支持旧版本</a>部分）。

</p>

<img src="../../../images/ui/settings/settings-headers-tablet0b8e.png?hl=zh-cn" alt="" />
<p class="img-caption"><strong>图 4.</strong> 带标头的双窗格布局。 <br/><b>1.</b> 标头用 XML 标头文件定义。
 <br/><b>2.</b> 每组设置均由
<code><a href="https://developer.android.com/reference/android/preference/PreferenceFragment.html?hl=zh-cn">PreferenceFragment</a></code>（通过标头文件中的 <code>&lt;header&gt;</code>
元素指定）定义。</p>

<img src="../../../images/ui/settings/settings-headers-handset0b8e.png?hl=zh-cn" alt="" />
<p class="img-caption"><strong>图 5.</strong> 带设置标头的手机设备。选择项目后，相关的
<code><a href="https://developer.android.com/reference/android/preference/PreferenceFragment.html?hl=zh-cn">PreferenceFragment</a></code>
将替换标头。</p>


<h3 id="CreateHeaders" style="clear:left">创建标头文件</h3>

<p>标头列表中的每组设置均由根 <code>&lt;preference-headers&gt;</code> 元素内的单个 <code>&lt;header&gt;</code>
元素指定。例如：</p>

<pre>
&lt;?xml version="1.0" encoding="utf-8"?>
&lt;preference-headers xmlns:android="http://schemas.android.com/apk/res/android">
    &lt;header
        android:fragment="com.example.prefs.SettingsActivity$SettingsFragmentOne"
        android:title="@string/prefs_category_one"
        android:summary="@string/prefs_summ_category_one" />
    &lt;header
        android:fragment="com.example.prefs.SettingsActivity$SettingsFragmentTwo"
        android:title="@string/prefs_category_two"
        android:summary="@string/prefs_summ_category_two" >
        &lt;!-- key/value pairs can be included as arguments for the fragment. -->
        &lt;extra android:name="someKey" android:value="someHeaderValue" />
    &lt;/header>
&lt;/preference-headers>
</pre>

<p>每个标头均可使用 <code>android:fragment</code> 属性声明在用户选择该标头时应打开的 <code><a href="https://developer.android.com/reference/android/preference/PreferenceFragment.html?hl=zh-cn">PreferenceFragment</a></code> 实例。</p>

<p><code>&lt;extras&gt;</code> 元素允许您使用 <code><a href="https://developer.android.com/reference/android/os/Bundle.html?hl=zh-cn">Bundle</a></code> 将键值对传递给片段。该片段可以通过调用 <code><a href="https://developer.android.com/reference/android/app/Fragment.html?hl=zh-cn#getArguments()">getArguments()</a></code> 检索参数。您向该片段传递参数的原因可能有很多，不过一个重要原因是，要对每个组重复使用 <code><a href="https://developer.android.com/reference/android/preference/PreferenceFragment.html?hl=zh-cn">PreferenceFragment</a></code> 的相同子类，而且要使用参数来指定该片段应加载哪些首选项 XML 文件。

</p>

<p>例如，当每个标头均使用 <code>"settings"</code> 键定义 <code>&lt;extra&gt;</code> 参数时，则可以对多个设置组重复使用以下片段：
</p>

<pre>
public static class SettingsFragment extends PreferenceFragment {
    &#64;Override
    public void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);

        String settings = getArguments().getString("settings");
        if ("notifications".equals(settings)) {
            addPreferencesFromResource(R.xml.settings_wifi);
        } else if ("sync".equals(settings)) {
            addPreferencesFromResource(R.xml.settings_sync);
        }
    }
}
</pre>



<h3 id="DisplayHeaders">显示标头</h3>

<p>要显示首选项标头，您必须实现 <code><a href="https://developer.android.com/reference/android/preference/PreferenceActivity.html?hl=zh-cn#onBuildHeaders(java.util.List<android.preference.PreferenceActivity.Header>)">onBuildHeaders()</a></code> 回调方法并调用
<code><a href="https://developer.android.com/reference/android/preference/PreferenceActivity.html?hl=zh-cn#loadHeadersFromResource(int, java.util.List<android.preference.PreferenceActivity.Header>)">loadHeadersFromResource()</a></code>。例如：</p>

<pre>
public class SettingsActivity extends PreferenceActivity {
    &#64;Override
    public void onBuildHeaders(List&lt;Header> target) {
        loadHeadersFromResource(R.xml.preference_headers, target);
    }
}
</pre>

<p>当用户从标头列表中选择一个项目时，系统会打开相关的 <code><a href="https://developer.android.com/reference/android/preference/PreferenceFragment.html?hl=zh-cn">PreferenceFragment</a></code>。</p>

<p class="note"><strong>注：</strong>使用首选项标头时，<code><a href="https://developer.android.com/reference/android/preference/PreferenceActivity.html?hl=zh-cn">PreferenceActivity</a></code> 的子类无需实现 <code><a href="https://developer.android.com/reference/android/preference/PreferenceActivity.html?hl=zh-cn#onCreate(android.os.Bundle)">onCreate()</a></code> 方法，因为 Activity 唯一所需执行的任务就是加载标头。
</p>


<h3 id="BackCompatHeaders">使用首选项标头支持旧版本</h3>

<p>如果您的应用支持早于 3.0 的 Android
版本，则在 Android 3.0 及更高版本系统上运行时，您仍可使用标头提供双窗格数据。为此，您只需另外创建
一个使用基本 <code><a href="https://developer.android.com/reference/android/preference/Preference.html?hl=zh-cn">&lt;Preference&gt;</a></code> 元素的首选项 XML 文件即可，这些基本元素的行为方式与标头项目类似（供较旧版本的 Android
 系统使用）。</p>

<p>但是，每个 <code><a href="https://developer.android.com/reference/android/preference/Preference.html?hl=zh-cn">&lt;Preference&gt;</a></code> 元素均会向 <code><a href="https://developer.android.com/reference/android/preference/PreferenceActivity.html?hl=zh-cn">PreferenceActivity</a></code> 发送一个 <code><a href="https://developer.android.com/reference/android/content/Intent.html?hl=zh-cn">Intent</a></code>，指定要加载哪个首选项 XML 文件，而不是打开新的
<code><a href="https://developer.android.com/reference/android/preference/PreferenceScreen.html?hl=zh-cn">PreferenceScreen</a></code>。
</p>

<p>例如，下面就是一个用于 Android 3.0
及更高版本系统的首选项标头 XML 文件 (<code>res/xml/preference_headers.xml</code>)：</p>

<pre>
&lt;preference-headers xmlns:android="http://schemas.android.com/apk/res/android">
    &lt;header
        android:fragment="com.example.prefs.SettingsFragmentOne"
        android:title="@string/prefs_category_one"
        android:summary="@string/prefs_summ_category_one" />
    &lt;header
        android:fragment="com.example.prefs.SettingsFragmentTwo"
        android:title="@string/prefs_category_two"
        android:summary="@string/prefs_summ_category_two" />
&lt;/preference-headers>
</pre>

<p>下面是为早于
Android 3.0 版本的系统提供相同标头的首选项文件 (<code>res/xml/preference_headers_legacy.xml</code>)：</p>

<pre>
&lt;PreferenceScreen xmlns:android="http://schemas.android.com/apk/res/android">
    &lt;Preference
        android:title="@string/prefs_category_one"
        android:summary="@string/prefs_summ_category_one"  >
        &lt;intent
            android:targetPackage="com.example.prefs"
            android:targetClass="com.example.prefs.SettingsActivity"
            android:action="com.example.prefs.PREFS_ONE" />
    &lt;/Preference>
    &lt;Preference
        android:title="@string/prefs_category_two"
        android:summary="@string/prefs_summ_category_two" >
        &lt;intent
            android:targetPackage="com.example.prefs"
            android:targetClass="com.example.prefs.SettingsActivity"
            android:action="com.example.prefs.PREFS_TWO" />
    &lt;/Preference>
&lt;/PreferenceScreen>
</pre>

<p>由于是从 Android 3.0 开始方添加对 <code>&lt;preference-headers&gt;</code> 的支持，因此只有在 Androd 3.0 或更高版本中运行时，系统才会在您的 <code><a href="https://developer.android.com/reference/android/preference/PreferenceActivity.html?hl=zh-cn">PreferenceActivity</a></code> 中调用 <code><a href="https://developer.android.com/reference/android/preference/PreferenceActivity.html?hl=zh-cn#onBuildHeaders(java.util.List<android.preference.PreferenceActivity.Header>)">onBuildHeaders()</a></code>。
要加载“旧版”标头文件 (<code>preference_headers_legacy.xml</code>)，您必须检查 Android
版本，如果版本低于 Android 3.0 (<code><a href="https://developer.android.com/reference/android/os/Build.VERSION_CODES.html?hl=zh-cn#HONEYCOMB">HONEYCOMB</a></code>)，请调用 <code><a href="https://developer.android.com/reference/android/preference/PreferenceActivity.html?hl=zh-cn#addPreferencesFromResource(int)">addPreferencesFromResource()</a></code> 来加载旧版标头文件。

例如：</p>

<pre>
&#64;Override
public void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    ...

    if (Build.VERSION.SDK_INT &lt; Build.VERSION_CODES.HONEYCOMB) {
        // Load the legacy preferences headers
        addPreferencesFromResource(R.xml.preference_headers_legacy);
    }
}

// Called only on Honeycomb and later
&#64;Override
public void onBuildHeaders(List&lt;Header> target) {
   loadHeadersFromResource(R.xml.preference_headers, target);
}
</pre>

<p>最后要做的就是处理传入 Activity 的
<code><a href="https://developer.android.com/reference/android/content/Intent.html?hl=zh-cn">Intent</a></code>，以确定要加载的首选项文件。因此，请检索 Intent 的操作，并将其与在首选项 XML 的 <code>&lt;intent&gt;</code> 标记中使用的已知操作字符串进行比较。
</p>

<pre>
final static String ACTION_PREFS_ONE = "com.example.prefs.PREFS_ONE";
...

&#64;Override
public void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);

    String action = getIntent().getAction();
    if (action != null &amp;&amp; action.equals(ACTION_PREFS_ONE)) {
        addPreferencesFromResource(R.xml.preferences);
    }
    ...

    else if (Build.VERSION.SDK_INT &lt; Build.VERSION_CODES.HONEYCOMB) {
        // Load the legacy preferences headers
        addPreferencesFromResource(R.xml.preference_headers_legacy);
    }
}
</pre>

<p>值得注意的是，连续调用 <code><a href="https://developer.android.com/reference/android/preference/PreferenceActivity.html?hl=zh-cn#addPreferencesFromResource(int)">addPreferencesFromResource()</a></code> 会将所有首选项堆叠在一个列表中，因此请将条件与 else-if 语句链接在一起，确保它只调用一次。

</p>





<h2 id="ReadingPrefs">读取首选项</h2>

<p>默认情况下，应用的所有首选项均保存到一个可通过调用静态方法 <code><a href="https://developer.android.com/reference/android/preference/PreferenceManager.html?hl=zh-cn#getDefaultSharedPreferences(android.content.Context)">PreferenceManager.getDefaultSharedPreferences()</a></code> 从应用内的任何位置访问的文件中。
这将返回 <code><a href="https://developer.android.com/reference/android/content/SharedPreferences.html?hl=zh-cn">SharedPreferences</a></code> 对象，其中包含与 <code><a href="https://developer.android.com/reference/android/preference/PreferenceActivity.html?hl=zh-cn">PreferenceActivity</a></code> 中所用 <code><a href="https://developer.android.com/reference/android/preference/Preference.html?hl=zh-cn">Preference</a></code> 对象相关的所有键值对。
</p>

<p>例如，从应用中的任何其他 Activity 读取某个首选项值的方法如下：
</p>

<pre>
SharedPreferences sharedPref = PreferenceManager.getDefaultSharedPreferences(this);
String syncConnPref = sharedPref.getString(SettingsActivity.KEY_PREF_SYNC_CONN, "");
</pre>



<h3 id="Listening">侦听首选项变更</h3>

<p>出于某些原因，您可能希望在用户更改任一首选项时立即收到通知。
要在任一首选项发生更改时收到回调，请实现 <code><a href="https://developer.android.com/reference/android/content/SharedPreferences.OnSharedPreferenceChangeListener.html?hl=zh-cn">SharedPreference.OnSharedPreferenceChangeListener</a></code> 接口，并通过调用 <code><a href="https://developer.android.com/reference/android/content/SharedPreferences.html?hl=zh-cn#registerOnSharedPreferenceChangeListener(android.content.SharedPreferences.OnSharedPreferenceChangeListener)">registerOnSharedPreferenceChangeListener()</a></code> 为 <code><a href="https://developer.android.com/reference/android/content/SharedPreferences.html?hl=zh-cn">SharedPreferences</a></code> 对象注册侦听器。

</p>

<p>该接口只有 <code><a href="https://developer.android.com/reference/android/content/SharedPreferences.OnSharedPreferenceChangeListener.html?hl=zh-cn#onSharedPreferenceChanged(android.content.SharedPreferences, java.lang.String)">onSharedPreferenceChanged()</a></code> 一种回调方法，而且您可能会发现在 Activity 过程中实现该接口最为简单。
例如：</p>

<pre>
public class SettingsActivity extends PreferenceActivity
                              implements OnSharedPreferenceChangeListener {
    public static final String KEY_PREF_SYNC_CONN = "pref_syncConnectionType";
    ...

    public void onSharedPreferenceChanged(SharedPreferences sharedPreferences,
        String key) {
        if (key.equals(KEY_PREF_SYNC_CONN)) {
            Preference connectionPref = findPreference(key);
            // Set summary to be the user-description for the selected value
            connectionPref.setSummary(sharedPreferences.getString(key, ""));
        }
    }
}
</pre>

<p>在此示例中，该方法检查更改的设置是否是针对已知的首选项键。它调用
<code><a href="https://developer.android.com/reference/android/preference/PreferenceActivity.html?hl=zh-cn#findPreference(java.lang.CharSequence)">findPreference()</a></code> 来获取已更改的
<code><a href="https://developer.android.com/reference/android/preference/Preference.html?hl=zh-cn">Preference</a></code>
对象，以便能够将项目摘要修改为对用户选择的说明。即，如果设置为 <code><a href="https://developer.android.com/reference/android/preference/ListPreference.html?hl=zh-cn">ListPreference</a></code> 或其他多选设置时，则当设置更改为显示当前状态（例如，图 5 所示的“Sleep”设置）时，您应调用 <code><a href="https://developer.android.com/reference/android/preference/Preference.html?hl=zh-cn#setSummary(int)">setSummary()</a></code>。
</p>

<p class="note"><strong>注：</strong>正如 Android 设计有关<a href="https://developer.android.com/design/patterns/settings.html?hl=zh-cn">设置</a>的文档中所述，我们建议您在用户每次更改首选项时更新
<code><a href="https://developer.android.com/reference/android/preference/ListPreference.html?hl=zh-cn">ListPreference</a></code>
的摘要，以描述当前设置。</p>

<p>若要妥善管理 Activity 生命周期，我们建议您在 <code><a href="https://developer.android.com/reference/android/app/Activity.html?hl=zh-cn#onResume()">onResume()</a></code> 和 <code><a href="https://developer.android.com/reference/android/app/Activity.html?hl=zh-cn#onPause()">onPause()</a></code> 回调期间分别注册和注销 <code><a href="https://developer.android.com/reference/android/content/SharedPreferences.OnSharedPreferenceChangeListener.html?hl=zh-cn">SharedPreferences.OnSharedPreferenceChangeListener</a></code>。
</p>

<pre>
&#64;Override
protected void onResume() {
    super.onResume();
    getPreferenceScreen().getSharedPreferences()
            .registerOnSharedPreferenceChangeListener(this);
}

&#64;Override
protected void onPause() {
    super.onPause();
    getPreferenceScreen().getSharedPreferences()
            .unregisterOnSharedPreferenceChangeListener(this);
}
</pre>

<p class="caution"><strong>注意：</strong>目前，首选项管理器不会在您调用 <code><a href="https://developer.android.com/reference/android/content/SharedPreferences.html?hl=zh-cn#registerOnSharedPreferenceChangeListener(android.content.SharedPreferences.OnSharedPreferenceChangeListener)">registerOnSharedPreferenceChangeListener()</a></code> 时存储对侦听器的强引用。
但是，您必须存储对侦听器的强引用，否则它将很容易被当作垃圾回收。
我们建议您将对侦听器的引用保存在只要您需要侦听器就会存在的对象的实例数据中。

</p>

<p>例如，在以下代码中，调用方未保留对侦听器的引用。
因此，侦听器将容易被当作垃圾回收，并在将来某个不确定的时间失败：
</p>

<pre>
prefs.registerOnSharedPreferenceChangeListener(
  // Bad! The listener is subject to garbage collection!
  new SharedPreferences.OnSharedPreferenceChangeListener() {
  public void onSharedPreferenceChanged(SharedPreferences prefs, String key) {
    // listener implementation
  }
});
</pre>

<p>有鉴于此，请将对侦听器的引用存储在只要需要侦听器就会存在的对象的实例数据字段中：
</p>

<pre>
SharedPreferences.OnSharedPreferenceChangeListener listener =
    new SharedPreferences.OnSharedPreferenceChangeListener() {
  public void onSharedPreferenceChanged(SharedPreferences prefs, String key) {
    // listener implementation
  }
};
prefs.registerOnSharedPreferenceChangeListener(listener);
</pre>

<h2 id="NetworkUsage">管理网络使用情况</h2>


<p>从 Android 4.0
开始，通过系统的“设置”应用，用户可以了解自己的应用在前台和后台使用的网络数据量。然后，用户可以据此禁止具体的应用使用后台数据。
为了避免用户禁止您的应用从后台访问数据，您应该有效地使用数据连接，并允许用户通过应用设置优化应用的数据使用。

<p>

<p>例如，您可以允许用户控制应用同步数据的频率，控制应用是否仅在有
Wi-Fi 时才执行上传/下载操作，以及控制应用能否在漫游时使用数据，等等。为用户提供这些控件后，即使数据使用量接近他们在系统“设置”中设置的限制，他们也不大可能禁止您的应用访问数据，因为他们可以精确地控制应用使用的数据量。


</p>

<p>在 <code><a href="https://developer.android.com/reference/android/preference/PreferenceActivity.html?hl=zh-cn">PreferenceActivity</a></code>
中添加必要的首选项来控制应用的数据使用习惯后，您应立即在清单文件中为 <code><a href="https://developer.android.com/reference/android/content/Intent.html?hl=zh-cn#ACTION_MANAGE_NETWORK_USAGE">ACTION_MANAGE_NETWORK_USAGE</a></code> 添加 Intent 过滤器。例如：</p>

<pre>
&lt;activity android:name="SettingsActivity" ... >
    &lt;intent-filter>
       &lt;action android:name="android.intent.action.MANAGE_NETWORK_USAGE" />
       &lt;category android:name="android.intent.category.DEFAULT" />
    &lt;/intent-filter>
&lt;/activity>
</pre>

<p>此 Intent 
过滤器指示系统此 Activity 控制应用的数据使用情况。因此，当用户从系统的“设置”应用检查应用所使用的数据量时，可以使用<em>“查看应用设置”</em>按钮启动
<code><a href="https://developer.android.com/reference/android/preference/PreferenceActivity.html?hl=zh-cn">PreferenceActivity</a></code>，这样，用户就能够优化应用使用的数据量。

</p>







<h2 id="Custom">构建自定义首选项</h2>

<p>Android 框架包括各种
<code><a href="https://developer.android.com/reference/android/preference/Preference.html?hl=zh-cn">Preference</a></code>
子类，您可以使用它们为各种不同类型的设置构建 UI。不过，您可能会发现自己需要的设置没有内置解决方案，例如，数字选取器或日期选取器。
在这种情况下，您将需要通过扩展
<code><a href="https://developer.android.com/reference/android/preference/Preference.html?hl=zh-cn">Preference</a></code> 类或其他子类之一来创建自定义首选项。</p>

<p>扩展 <code><a href="https://developer.android.com/reference/android/preference/Preference.html?hl=zh-cn">Preference</a></code>
类时，您需要执行以下几项重要操作：</p>

<ul>
  <li>指定在用户选择设置时显示的用户界面。</li>
  <li>适时保存设置的值。</li>
  <li>使用显示的当前（默认）值初始化
<code><a href="https://developer.android.com/reference/android/preference/Preference.html?hl=zh-cn">Preference</a></code>。</li>
  <li>在系统请求时提供默认值。</li>
  <li>如果 <code><a href="https://developer.android.com/reference/android/preference/Preference.html?hl=zh-cn">Preference</a></code>
提供自己的 UI（例如对话框），请保存并恢复状态以处理生命周期变更（例如，用户旋转屏幕）。</li>
</ul>

<p>下文介绍如何完成所有这些任务。</p>



<h3 id="CustomSelected">指定用户界面</h3>

  <p>如果您要直接扩展 <code><a href="https://developer.android.com/reference/android/preference/Preference.html?hl=zh-cn">Preference</a></code> 类，则需要实现
<code><a href="https://developer.android.com/reference/android/preference/Preference.html?hl=zh-cn#onClick()">onClick()</a></code>
来定义在用户选择该项时发生的操作。不过，大多数自定义设置都会扩展 <code><a href="https://developer.android.com/reference/android/preference/DialogPreference.html?hl=zh-cn">DialogPreference</a></code>
以显示对话框，从而简化这一过程。扩展 <code><a href="https://developer.android.com/reference/android/preference/DialogPreference.html?hl=zh-cn">DialogPreference</a></code> 时，必须在类构造函数中调用 <code><a href="https://developer.android.com/reference/android/preference/DialogPreference.html?hl=zh-cn#setDialogLayoutResource(int)">setDialogLayoutResourcs()</a></code> 来指定对话框的布局。
</p>

  <p>例如，自定义 <code><a href="https://developer.android.com/reference/android/preference/DialogPreference.html?hl=zh-cn">DialogPreference</a></code> 可以使用下面的构造函数来声明布局并为默认的肯定和否定对话框按钮指定文本：
</p>

<pre>
public class NumberPickerPreference extends DialogPreference {
    public NumberPickerPreference(Context context, AttributeSet attrs) {
        super(context, attrs);

        setDialogLayoutResource(R.layout.numberpicker_dialog);
        setPositiveButtonText(android.R.string.ok);
        setNegativeButtonText(android.R.string.cancel);

        setDialogIcon(null);
    }
    ...
}
</pre>



<h3 id="CustomSave">保存设置的值</h3>

<p>如果设置的值为整型数或是用于保存布尔值的 <code><a href="https://developer.android.com/reference/android/preference/Preference.html?hl=zh-cn#persistBoolean(boolean)">persistBoolean()</a></code>，则可通过调用 <code><a href="https://developer.android.com/reference/android/preference/Preference.html?hl=zh-cn">Preference</a></code> 类的一个 <code>persist*()</code> 方法（如 <code><a href="https://developer.android.com/reference/android/preference/Preference.html?hl=zh-cn#persistInt(int)">persistInt()</a></code>）随时保存该值。
</p>

<p class="note"><strong>注：</strong>每个 <code><a href="https://developer.android.com/reference/android/preference/Preference.html?hl=zh-cn">Preference</a></code> 均只能保存一种数据类型，因此您必须使用适合自定义 <code><a href="https://developer.android.com/reference/android/preference/Preference.html?hl=zh-cn">Preference</a></code> 所用数据类型的 <code>persist*()</code> 方法。

</p>

<p>至于何时选择保留设置，则可能取决于要扩展的 <code><a href="https://developer.android.com/reference/android/preference/Preference.html?hl=zh-cn">Preference</a></code> 类。如果扩展 <code><a href="https://developer.android.com/reference/android/preference/DialogPreference.html?hl=zh-cn">DialogPreference</a></code>，则只能在对话框因肯定结果（用户选择“确定”按钮）而关闭时保留该值。
</p>

<p>当 <code><a href="https://developer.android.com/reference/android/preference/DialogPreference.html?hl=zh-cn">DialogPreference</a></code> 关闭时，系统会调用 <code><a href="https://developer.android.com/reference/android/preference/DialogPreference.html?hl=zh-cn#onDialogClosed(boolean)">onDialogClosed()</a></code> 方法。该方法包括一个布尔参数，用于指定用户结果是否为“肯定”；如果值为
<code>true</code>，则表示用户选择的是肯定按钮且您应该保存新值。
例如：
</p>

<pre>
&#64;Override
protected void onDialogClosed(boolean positiveResult) {
    // When the user selects "OK", persist the new value
    if (positiveResult) {
        persistInt(mNewValue);
    }
}
</pre>

<p>在此示例中，<code>mNewValue</code>
是一个类成员，可存放设置的当前值。调用 <code><a href="https://developer.android.com/reference/android/preference/Preference.html?hl=zh-cn#persistInt(int)">persistInt()</a></code> 会将该值保存到
<code><a href="https://developer.android.com/reference/android/content/SharedPreferences.html?hl=zh-cn">SharedPreferences</a></code> 文件（自动使用在此
<code><a href="https://developer.android.com/reference/android/preference/Preference.html?hl=zh-cn">Preference</a></code> 的 XML 文件中指定的键）。</p>


<h3 id="CustomInitialize">初始化当前值</h3>

<p>系统将 <code><a href="https://developer.android.com/reference/android/preference/Preference.html?hl=zh-cn">Preference</a></code> 添加到屏幕时，会调用
<code><a href="https://developer.android.com/reference/android/preference/Preference.html?hl=zh-cn#onSetInitialValue(boolean, java.lang.Object)">onSetInitialValue()</a></code>
来通知您设置是否具有保留值。如果没有保留值，则此调用将为您提供默认值。
</p>

<p><code><a href="https://developer.android.com/reference/android/preference/Preference.html?hl=zh-cn#onSetInitialValue(boolean, java.lang.Object)">onSetInitialValue()</a></code>
方法传递一个布尔值 (<code>restorePersistedValue</code>)，以指示是否已为该设置保留值。
如果值为 <code>true</code>，则应通过调用 <code><a href="https://developer.android.com/reference/android/preference/Preference.html?hl=zh-cn">Preference</a></code> 类的一个 <code>getPersisted*()</code> 方法（如整型值对应的 <code><a href="https://developer.android.com/reference/android/preference/Preference.html?hl=zh-cn#getPersistedInt(int)">getPersistedInt()</a></code>）来检索保留值。
通常，您会需要检索保留值，以便能够正确更新 UI 来反映之前保存的值。

</p>

<p>如果 <code>restorePersistedValue</code> 为
<code>false</code>，则应使用在第二个参数中传递的默认值。</p>

<pre>
&#64;Override
protected void onSetInitialValue(boolean restorePersistedValue, Object defaultValue) {
    if (restorePersistedValue) {
        // Restore existing state
        mCurrentValue = this.getPersistedInt(DEFAULT_VALUE);
    } else {
        // Set default state from the XML attribute
        mCurrentValue = (Integer) defaultValue;
        persistInt(mCurrentValue);
    }
}
</pre>

<p>每种 <code>getPersisted*()</code> 方法均采用一个参数，用于指定在实际上没有保留值或该键不存在时所要使用的默认值。
在上述示例中，当 <code><a href="https://developer.android.com/reference/android/preference/Preference.html?hl=zh-cn#getPersistedInt(int)">getPersistedInt()</a></code> 不能返回保留值时，局部常量用于指定默认值。
</p>

<p class="caution"><strong>注意：</strong>您<strong>不能</strong>使用
<code>defaultValue</code> 作为 <code>getPersisted*()</code> 方法中的默认值，因为当
<code>restorePersistedValue</code> 为 <code>true</code> 时，其值始终为 null。</p>


<h3 id="CustomDefault">提供默认值</h3>

<p>如果 <code><a href="https://developer.android.com/reference/android/preference/Preference.html?hl=zh-cn">Preference</a></code>
类的实例指定一个默认值（使用 <code>android:defaultValue</code>
属性），则在实例化对象以检索该值时，系统会调用 <code><a href="https://developer.android.com/reference/android/preference/Preference.html?hl=zh-cn#onGetDefaultValue(android.content.res.TypedArray, int)">onGetDefaultValue()</a></code>。您必须实现此方法，系统才能将默认值保存在 <code><a href="https://developer.android.com/reference/android/content/SharedPreferences.html?hl=zh-cn">SharedPreferences</a></code> 中。
例如：</p>

<pre>
&#64;Override
protected Object onGetDefaultValue(TypedArray a, int index) {
    return a.getInteger(index, DEFAULT_VALUE);
}
</pre>

<p>方法参数可提供您所需的一切：属性的数组和 <code>android:defaultValue</code>（必须检索的值）的索引位置。
之所以必须实现此方法以从该属性中提取默认值，是因为您必须为此属性指定在未定义属性值时所要使用的局部默认值。

</p>



<h3 id="CustomSaveState">保存和恢复首选项的状态</h3>

<p>正如布局中的 <code><a href="https://developer.android.com/reference/android/view/View.html?hl=zh-cn">View</a></code>
一样，在重启 Activity 或片段时（例如，用户旋转屏幕），<code><a href="https://developer.android.com/reference/android/preference/Preference.html?hl=zh-cn">Preference</a></code>
子类也负责保存并恢复其状态。要正确保存并恢复 <code><a href="https://developer.android.com/reference/android/preference/Preference.html?hl=zh-cn">Preference</a></code> 类的状态，您必须实现生命周期回调方法 <code><a href="https://developer.android.com/reference/android/preference/Preference.html?hl=zh-cn#onSaveInstanceState()">onSaveInstanceState()</a></code> 和 <code><a href="https://developer.android.com/reference/android/preference/Preference.html?hl=zh-cn#onRestoreInstanceState(android.os.Parcelable)">onRestoreInstanceState()</a></code>。

</p>

<p><code><a href="https://developer.android.com/reference/android/preference/Preference.html?hl=zh-cn">Preference</a></code> 的状态由实现
<code><a href="https://developer.android.com/reference/android/os/Parcelable.html?hl=zh-cn">Parcelable</a></code> 接口的对象定义。Android 框架为您提供此类对象，作为定义状态对象（<code><a href="https://developer.android.com/reference/android/preference/Preference.BaseSavedState.html?hl=zh-cn">Preference.BaseSavedState</a></code> 类）的起点。
</p>

<p>要定义 <code><a href="https://developer.android.com/reference/android/preference/Preference.html?hl=zh-cn">Preference</a></code> 类保存其状态的方式，您应该扩展
<code><a href="https://developer.android.com/reference/android/preference/Preference.BaseSavedState.html?hl=zh-cn">Preference.BaseSavedState</a></code> 类。您只需重写几种方法并定义
<code><a href="https://developer.android.com/reference/android/preference/Preference.BaseSavedState.html?hl=zh-cn#CREATOR">CREATOR</a></code>
对象。</p>

<p>对于大多数应用，如果 <code><a href="https://developer.android.com/reference/android/preference/Preference.html?hl=zh-cn">Preference</a></code> 子类保存除整型数以外的其他数据类型，则可复制下列实现并直接更改处理 <code>value</code> 的行。

</p>

<pre>
private static class SavedState extends BaseSavedState {
    // Member that holds the setting's value
    // Change this data type to match the type saved by your Preference
    int value;

    public SavedState(Parcelable superState) {
        super(superState);
    }

    public SavedState(Parcel source) {
        super(source);
        // Get the current preference's value
        value = source.readInt();  // Change this to read the appropriate data type
    }

    &#64;Override
    public void writeToParcel(Parcel dest, int flags) {
        super.writeToParcel(dest, flags);
        // Write the preference's value
        dest.writeInt(value);  // Change this to write the appropriate data type
    }

    // Standard creator object using an instance of this class
    public static final Parcelable.Creator&lt;SavedState> CREATOR =
            new Parcelable.Creator&lt;SavedState>() {

        public SavedState createFromParcel(Parcel in) {
            return new SavedState(in);
        }

        public SavedState[] newArray(int size) {
            return new SavedState[size];
        }
    };
}
</pre>

<p>如果将上述 <code><a href="https://developer.android.com/reference/android/preference/Preference.BaseSavedState.html?hl=zh-cn">Preference.BaseSavedState</a></code>
实现添加到您的应用（通常，作为 <code><a href="https://developer.android.com/reference/android/preference/Preference.html?hl=zh-cn">Preference</a></code>
子类的子类），则需要为
<code><a href="https://developer.android.com/reference/android/preference/Preference.html?hl=zh-cn">Preference</a></code> 子类实现 <code><a href="https://developer.android.com/reference/android/preference/Preference.html?hl=zh-cn#onSaveInstanceState()">onSaveInstanceState()</a></code> 和 <code><a href="https://developer.android.com/reference/android/preference/Preference.html?hl=zh-cn#onRestoreInstanceState(android.os.Parcelable)">onRestoreInstanceState()</a></code> 方法。</p>

<p>例如：</p>

<pre>
&#64;Override
protected Parcelable onSaveInstanceState() {
    final Parcelable superState = super.onSaveInstanceState();
    // Check whether this Preference is persistent (continually saved)
    if (isPersistent()) {
        // No need to save instance state since it's persistent,
        // use superclass state
        return superState;
    }

    // Create instance of custom BaseSavedState
    final SavedState myState = new SavedState(superState);
    // Set the state's value with the class member that holds current
    // setting value
    myState.value = mNewValue;
    return myState;
}

&#64;Override
protected void onRestoreInstanceState(Parcelable state) {
    // Check whether we saved the state in onSaveInstanceState
    if (state == null || !state.getClass().equals(SavedState.class)) {
        // Didn't save the state, so call superclass
        super.onRestoreInstanceState(state);
        return;
    }

    // Cast state to custom BaseSavedState and pass to superclass
    SavedState myState = (SavedState) state;
    super.onRestoreInstanceState(myState.getSuperState());

    // Set this Preference's widget to reflect the restored state
    mNumberPicker.setValue(myState.value);
}
</pre>




    </div>

    

  
    
  
    



<div class="wrap">
  <footer class="dac-footer ">
    <div class="cols dac-footer-main">
      <div class="col-1of2">
        <div class="dac-footer-contact">
          <a class="dac-footer-contact-link" href="https://developer.android.com/newsletter/index.html?hl=zh-cn" title="Newsletter">Newsletter</a>
          <a class="dac-footer-contact-link" href="https://android-developers.blogspot.com/" title="博客" target="_blank">博客</a>
          <a class="dac-footer-contact-link" href="https://developer.android.com/support.html?hl=zh-cn" title="支持">支持</a>
        </div>
      </div>
      <div class="col-1of2 dac-footer-reachout">
        <div class="dac-footer-social">
          <a class="dac-button-social dac-youtube dac-footer-social-link" href="https://www.youtube.com/user/androiddevelopers" title="Android Developers on YouTube" target="_blank"><i class="dac-sprite dac-youtube"></i><span class="hide-text">Android Developers on YouTube</span></a>
          <a class="dac-button-social dac-gplus dac-footer-social-link" href="https://plus.google.com/+AndroidDevelopers" title="Android Developers on Google+" target="_blank"><i class="dac-sprite dac-gplus"></i><span class="hide-text">Android Developers on Google+</span></a>
          <a class="dac-button-social dac-twitter dac-footer-social-link" href="https://twitter.com/AndroidDev" title="Android Developers on Twitter" target="_blank"><i class="dac-sprite dac-twitter"></i><span class="hide-text">Android Developers on Twitter</span></a>
        </div>
      </div>
    </div>

    <hr class="dac-footer-separator"/>
      
      <p class="dac-footer-copyright">
        
        Except as noted, this content is licensed under <a href="http://creativecommons.org/licenses/by/2.5/" target="_blank">Creative Commons Attribution 2.5</a>. For details and restrictions, see the <a href="https://developer.android.com/license.html">Content License</a>.
      </p>
    

    <p class="dac-footer-links">
      <a href="https://www.android.com/" title="Android.com" target="_blank">Android.com</a>
      <a href="https://developer.android.com/?hl=zh-cn" title="Android Developers">Android Developers</a>
      <a href="https://developer.android.com/studio/index.html?hl=zh-cn" title="Android Studio">Android Studio</a>
      <a href="https://developer.android.com/distribute/console/index.html?hl=zh-cn" title="Google Play Console">Google Play Console</a>
      <a href="https://developer.android.com/legal.html?hl=zh-cn" title="Legal Notice">Legal Notice</a>
    </p>

    <!-- TODO(akassay) Update all DAC js to use the class instead of the id b/30368561 -->
    <form class="devsite-utility-footer-language" id="setlang" action="https://developer.android.com/i18n/setlang/" method="post">
      <input type="hidden" name="xsrf_token" value="Oi48BqMwBJSlX47UxS85gPKgz1lKxXcWiG6R06v-JbQ6MTQ5NzUxNzAzNDIwNzMwMA" />
      <input type="hidden" name="next" value="settings.html">
      <span id="language" class="locales">
        <select class="devsite-utility-footer-language-select" name="language">
          
          <option value="id"
            >
            Bahasa Indonesia
          </option>
          
          <option value="de"
            >
            Deutsch
          </option>
          
          <option value="en"
            >
            English
          </option>
          
          <option value="es"
            >
            español
          </option>
          
          <option value="es-419"
            >
            Español (América Latina)
          </option>
          
          <option value="fr"
            >
            français
          </option>
          
          <option value="pt-br"
            >
            Português Brasileiro
          </option>
          
          <option value="vi"
            >
            Tiếng Việt
          </option>
          
          <option value="tr"
            >
            Türkçe
          </option>
          
          <option value="ru"
            >
            Русский
          </option>
          
          <option value="th"
            >
            ภาษาไทย
          </option>
          
          <option value="ja"
            >
            日本語
          </option>
          
          <option value="zh-cn"
             selected="selected" >
            简体中文
          </option>
          
          <option value="zh-tw"
            >
            繁體中文
          </option>
          
          <option value="ko"
            >
            한국어
          </option>
          
        </select>
      </span>
    </form>
  </footer>
</div><!--/.wrap -->

<div class="dac-toast-group">
  <div class="dac-toast" data-toast>
    <div class="dac-toast-wrap">
      This site uses cookies to store your preferences for site-specific language and display options.
    </div>
  </div>
</div>

<div data-modal="newsletter" data-newsletter-fb data-swap class="dac-modal newsletter">
  <div class="dac-modal-container">
    <div class="dac-modal-window">
      <header class="dac-modal-header">
        <div class="dac-modal-header-actions">
          <button class="dac-modal-header-close" data-modal-toggle></button>
        </div>
        <div class="dac-swap" data-swap-container>
          <section class="dac-swap-section dac-active dac-down">
            <h2 class="norule dac-modal-header-title" data-t="newsletter.title">Get the latest Android developer news and tips that will help you find success on Google Play.</h2>
            <p class="dac-modal-header-subtitle" data-t="newsletter.requiredHint">* Required Fields</p>
          </section>
          <section class="dac-swap-section dac-up">
            
            <h2 class="norule dac-modal-header-title" data-t="newsletter.successTitle">Hooray!</h2>
          </section>
        </div>
      </header>
      <div class="dac-swap" data-swap-container>
        <section class="dac-swap-section dac-active dac-left">
          <form action="https://services.google.com/fb/submissions/android-developer-mailing-list/" class="dac-form" method="post">
            <section class="dac-modal-content">
              <fieldset class="dac-form-fieldset">
                <div class="cols">
                  <div class="col-1of2 newsletter-leftCol">
                    <div class="dac-form-input-group">
                      <label for="newsletter-full-name" class="dac-form-floatlabel" data-t="newsletter.name">Full name</label>
                      <input type="text" class="dac-form-input" name="fullname" id="newsletter-full-name" required>
                      <span class="dac-form-required">*</span>
                    </div>
                    <div class="dac-form-input-group">
                      <label for="newsletter-email" class="dac-form-floatlabel" data-t="newsletter.email">Email 地址</label>
                      <input type="email" class="dac-form-input" name="emailaddress" id="newsletter-email" required>
                      <span class="dac-form-required">*</span>
                    </div>
                  </div>
                  <div class="col-1of2 newsletter-rightCol">
                    <div class="dac-form-input-group">
                      <label for="newsletter-company" class="dac-form-floatlabel" data-t="newsletter.company">Company / developer name</label>
                      <input type="text" class="dac-form-input" name="companydevelopername" id="newsletter-company">
                    </div>
                    <div class="dac-form-input-group">
                      <label for="newsletter-play-store" class="dac-form-floatlabel" data-t="newsletter.appUrl">One of your Play Store app URLs</label>
                      <input type="url" class="dac-form-input" name="playstoreappurls" id="newsletter-play-store">
                    </div>
                  </div>
                </div>
              </fieldset>
              <fieldset class="dac-form-fieldset">
                <div class="cols">
                  <div class="col-1of2 newsletter-leftCol newsletter-interested" data-validation-message="Please check at least one item.">
                    <legend class="dac-form-legend">What are you interested in?<span class="dac-form-required">*</span></legend>
                    <div class="dac-form-radio-group">
                      <input type="checkbox" class="dac-form-checkbox" name="interested" id="interested-whats-new" value="whats-new">
                      <label for="interested-whats-new" class="dac-form-checkbox-button"></label>
                      <label for="interested-whats-new" class="dac-form-label">What's new</label>
                    </div>
                    <div class="dac-form-radio-group">
                      <input type="checkbox" class="dac-form-checkbox" name="interested" id="interested-games-updates" value="games-updates">
                      <label for="interested-games-updates" class="dac-form-checkbox-button"></label>
                      <label for="interested-games-updates" class="dac-form-label">Games updates</label>
                    </div>
                    <div class="dac-form-radio-group">
                      <input type="checkbox" class="dac-form-checkbox" name="interested" id="interested-android-development" value="android-development">
                      <label for="interested-android-development" class="dac-form-checkbox-button"></label>
                      <label for="interested-android-development" class="dac-form-label">Android development</label>
                    </div>
                  </div>
                  <div class="col-1of2 newsletter-rightCol newsletter-checkboxes">
                    <div class="dac-form-input-group">
                      <label for="newsletter-receive-in">Receive newsletter in</label>
                      <select name="language" class="dac-form-select" id="newsletter-receive-in">
                        <option value="en-US" selected>English</option>
                        <option value="ar">Arabic</option>
                        <option value="zh">Chinese (Simplified)</option>
                        <option value="zh-TW">Chinese (Traditional)</option>
                        <option value="fr">French</option>
                        <option value="de">German</option>
                        <option value="id">Indonesian (Bahasa)</option>
                        <option value="ja">Japanese</option>
                        <option value="ko">Korean</option>
                        <option value="pt-BR">Portuguese (Brazilian)</option>
                        <option value="ru">Russian</option>
                        <option value="es-419">Spanish (Latin American)</option>
                        <option value="th">Thai</option>
                        <option value="tr">Turkish</option>
                        <option value="vi">Vietnamese</option>
                      </select>
                    </div>
                    <div class="dac-form-radio-group">
                      <div class="dac-media">
                        <div class="dac-media-figure">
                          <input type="checkbox" class="dac-form-checkbox" name="marketingoptin" id="newsletter-add" required value="Add me to the mailing list.">
                          <label for="newsletter-add" class="dac-form-checkbox-button"></label>
                        </div>
                        <div class="dac-media-body">
                          <label for="newsletter-add" class="dac-form-label dac-form-aside">
                            Add me to the mailing list.
                            <span class="dac-form-required">*</span>
                          </label>
                        </div>
                      </div>
                    </div>
                    <div class="dac-form-radio-group">
                      <div class="dac-media">
                        <div class="dac-media-figure">
                          <input type="checkbox" class="dac-form-checkbox" name="privacystatement" id="newsletter-terms" required value="I acknowledge that the information provided in this form will be subject to Google's privacy policy (https://www.google.com/policies/privacy/).">
                          <label for="newsletter-terms" class="dac-form-checkbox-button"></label>
                        </div>
                        <div class="dac-media-body">
                          <label for="newsletter-terms" class="dac-form-label dac-form-aside"><span data-t="newsletter.privacyPolicy" data-t-html>
                            
                            I acknowledge that the information provided in this form will be subject to <a href="https://www.google.com/policies/privacy/">Google's privacy policy</a>.
                          </span>
                          <span class="dac-form-required">*</span></label>
                        </div>
                      </div>
                    </div>
                  </div>
                </div>
              </fieldset>
            </section>
            <input type="hidden" name="referrer" value="dac">
            <footer class="dac-modal-footer">
              <div class="cols">
                <div class="col-2of5">
                </div>
              </div>
              <button type="submit" value="Submit" class="dac-fab dac-primary dac-large dac-modal-action"><i class="dac-sprite dac-arrow-right"></i></button>
            </footer>
          </form>
        </section>
        <section class="dac-swap-section dac-right">
          <div class="dac-modal-content">
            <p class="newsletter-success-message" data-t="newsletter.successDetails">
              You have successfully signed up for the latest Android developer news and tips.
            </p>
          </div>
        </section>
      </div>
    </div>
  </div>
</div><!--/.dac-modal.newsletter-->


<div data-modal="langform" class="dac-modal" id="langform">
  <div class="dac-modal-container">
    <div class="dac-modal-window">
      <header class="dac-modal-header">
        <div class="dac-modal-header-actions">
          <button class="dac-modal-header-close" data-modal-toggle></button>
        </div>
        <section class="dac-swap-section dac-active dac-down">
          <h2 class="norule dac-modal-header-title">
            Browse this site in <span class="span-target-lang"></span>?
          </h2>
        </section>
      </header>
      <section class="dac-swap-section dac-active dac-left">
          <section class="dac-modal-content">
            <fieldset class="dac-form-fieldset">
              <div class="cols">
                <div class="col-2of2 langform-leftCol">
                  <p id="resetLangText">
                    You requested a page in <span class="span-target-lang"></span>, but your language preference for this site is <span class="span-current-lang"></span>.
                  </p>
                  <p id="resetLangCta">
                    Would you like to change your language preference and browse this site in <span class="span-target-lang"></span>? If you want to change your language preference later, use the language menu at the bottom of each page.
                  </p>
                </div>
              </div>
            </fieldset>
          </section>
          <footer class="dac-modal-footer" id="langfooter">
            <div class="cols">
              <div class="col-2of5">
              </div>
            </div>
            <a href="#" class="yes" onclick="return false;">
              <button class="button dac-primary dac-modal-action lang yes" data-t="newsletter.resetLangButtonYes" data-modal-toggle>
                Change Language
              </button>
            </a>
            <a href="#" class="" onclick="return false;">
              <button class="button dac-primary dac-modal-action lang no" data-t="newsletter.resetLangButtonNo" data-modal-toggle>
                Not Now
              </button>
            </a>
          </footer>
        </form>
      </section>
    </div>
  </div>
</div><!--/.dac-modal-->


<div data-modal="api-unavailable" class="dac-modal" id="api-unavailable">
  <div class="dac-modal-container">
    <div class="dac-modal-window">
      <header class="dac-modal-header">
        <div class="dac-modal-header-actions">
          <button class="dac-modal-header-close" data-modal-toggle></button>
        </div>
        <section class="dac-swap-section dac-active dac-down">
          <h2 class="norule dac-modal-header-title">
            This class requires API level <span class="api-level"></span> or higher
          </h2>
        </section>
      </header>
      <section class="dac-swap-section dac-active dac-left">
          <section class="dac-modal-content">
            <p>
              This doc is hidden because your selected API level for the documentation is <span class="api-level"></span>. You can change the documentation API level with the selector above the left navigation.
            </p>
            
            <p>For more information about specifying the API level your app requires, read <a href="https://developer.android.com/training/basics/supporting-devices/platforms.html">Supporting Different Platform Versions</a>.</p>
          </section>
          <footer class="dac-modal-footer" id="langfooter">
            <div class="cols">
              <div class="col-2of5">
              </div>
            </div>
            <a href="#" class="ok" onclick="return false;">
              <button class="button dac-primary dac-modal-action ok"
              data-modal-toggle>
                OK, make this page visible
              </button>
            </a>
          </footer>
        </form>
      </section>
    </div>
  </div>
</div><!--/.dac-modal#api-unavailable-->

    
  </div><!--/#body-content-->

  <!-- Nav Setup -->
  <script>$('[data-dac-nav]').dacNav();</script>
  <script type="text/javascript">
    $('.slideshow-container').dacSlideshow({
        btnPrev: '.slideshow-prev',
        btnNext: '.slideshow-next',
        btnPause: '#pauseButton'
    });

    $(".feed").dacTabbedList({
      nav_id: '.feed-nav',
      frame_id: '.feed-frame'
    });
  </script>
  
  <script src="../../../ytblogger_lists_unified414d.js?hl=zh-cn?v=2017061508" defer></script>
  <script src="../../../android_metadata_en414d.js?hl=zh-cn?v=2017061508" defer></script>
  
  <script src="../../../reference/lists414d.js?hl=zh-cn?v=2017061508" defer></script>
  <script src="../../../reference/gms_lists414d.js?hl=zh-cn?v=2017061508" defer></script>
  <script src="../../../reference/android/support/wearable/lists414d.js?hl=zh-cn?v=2017061508" defer></script>
  <script src="../../../reference/android/support/test/lists414d.js?hl=zh-cn?v=2017061508" defer></script>
  <script src="../../../reference/android/support/constraint/lists414d.js?hl=zh-cn?v=2017061508" defer></script>
  <script src="https://developer.android.com/_static2/f304fc21fa/jsi18n/?hl=zh-cn"></script>
  <script>
    // Load localized metadata.
    (function(lang) {
      if (lang === 'en') { return; }
      document.write('<script src="https://developer.android.com/android_metadata_zh-cn.js?hl=zh-cn?v=2017061508" defer></' + 'script>');
    })(getLangPref())

    // Add skip to content for accessibility.
    $('#skip-to-main').click(function() {
      $('a[name=top]').focus();
    });

    $('.devsite-utility-footer-language-select').each(function() {
      $(this).change(function() {
        changeLangPref(this.value, true)
        $('.devsite-utility-footer-language').submit();
      });
    });
  </script>

  <script>
    (function($) {
      devsite.analytics.InitAnalytics();
    })(jQuery);
  </script>

  


<div id="survey-box-wrapper">
  <div class="material-dialog" style="width:270px">
    <div class="material-dialog-title">
      Take a one-minute survey?
    </div>
    <div class="material-dialog-description">
      Help us improve Android tools and documentation.
    </div>
    <div class="material-button-bar">
      <a class="dac-button dac-primary dac-raised" target="_blank"
          href="https://goo.gl/forms/kV7MoyD2dvcWkd5N2">Sure</a>
      <a class="dac-button" href="#">No thanks</a>
    </div>
  </div>
</div>

</body>

<!-- Mirrored from developer.android.com/guide/topics/ui/settings.html?hl=zh-cn by HTTrack Website Copier/3.x [XR&CO'2014], Thu, 15 Jun 2017 09:15:01 GMT -->
</html>
